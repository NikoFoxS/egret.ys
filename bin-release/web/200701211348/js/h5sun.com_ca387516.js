var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r};if("undefined"==typeof global)var global=window;if("undefined"==typeof __global)var __global=global;var __define=this&&this.__define||function(t,e,r,i){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:r,set:i})},egret;!function(t){t.$hashCount=1;var e=function(){function e(){this.$hashCode=t.$hashCount++}return Object.defineProperty(e.prototype,"hashCode",{get:function(){return this.$hashCode},enumerable:!0,configurable:!0}),e}();t.HashObject=e,__reflect(e.prototype,"egret.HashObject",["egret.IHashObject"])}(egret||(egret={}));var egret;!function(t){var e=[],r=function(r){function i(t){void 0===t&&(t=null);var e=r.call(this)||this;return e.$EventDispatcher={0:t?t:e,1:{},2:{},3:0},e}return __extends(i,r),i.prototype.$getEventMap=function(t){var e=this.$EventDispatcher,r=t?e[2]:e[1];return r},i.prototype.addEventListener=function(t,e,r,i,n){this.$addListener(t,e,r,i,n)},i.prototype.once=function(t,e,r,i,n){this.$addListener(t,e,r,i,n,!0)},i.prototype.$addListener=function(t,e,r,i,n,o){var a=this.$EventDispatcher,s=i?a[2]:a[1],c=s[t];c?0!==a[3]&&(s[t]=c=c.concat()):c=s[t]=[],this.$insertEventBin(c,t,e,r,i,n,o)},i.prototype.$insertEventBin=function(t,e,r,i,n,o,a){o=0|+o;for(var s=-1,c=t.length,h=0;c>h;h++){var u=t[h];if(u.listener==r&&u.thisObject==i&&u.target==this)return!1;-1==s&&u.priority<o&&(s=h)}var l={type:e,listener:r,thisObject:i,priority:o,target:this,useCapture:n,dispatchOnce:!!a};return-1!==s?t.splice(s,0,l):t.push(l),!0},i.prototype.removeEventListener=function(t,e,r,i){var n=this.$EventDispatcher,o=i?n[2]:n[1],a=o[t];a&&(0!==n[3]&&(o[t]=a=a.concat()),this.$removeEventBin(a,e,r),0==a.length&&(o[t]=null))},i.prototype.$removeEventBin=function(t,e,r){for(var i=t.length,n=0;i>n;n++){var o=t[n];if(o.listener==e&&o.thisObject==r&&o.target==this)return t.splice(n,1),!0}return!1},i.prototype.hasEventListener=function(t){var e=this.$EventDispatcher;return!(!e[1][t]&&!e[2][t])},i.prototype.willTrigger=function(t){return this.hasEventListener(t)},i.prototype.dispatchEvent=function(t){return t.$currentTarget=this.$EventDispatcher[0],t.$setTarget(t.$currentTarget),this.$notifyListener(t,!1)},i.prototype.$notifyListener=function(t,r){var i=this.$EventDispatcher,n=r?i[2]:i[1],o=n[t.$type];if(!o)return!0;var a=o.length;if(0==a)return!0;var s=e;i[3]++;for(var c=0;a>c;c++){var h=o[c];if(h.listener.call(h.thisObject,t),h.dispatchOnce&&s.push(h),t.$isPropagationImmediateStopped)break}for(i[3]--;s.length;){var h=s.pop();h.target.removeEventListener(h.type,h.listener,h.thisObject,h.useCapture)}return!t.$isDefaultPrevented},i.prototype.dispatchEventWith=function(e,r,i,n){if(r||this.hasEventListener(e)){var o=t.Event.create(t.Event,e,r,n);o.data=i;var a=this.dispatchEvent(o);return t.Event.release(o),a}return!0},i}(t.HashObject);t.EventDispatcher=r,__reflect(r.prototype,"egret.EventDispatcher",["egret.IEventDispatcher"])}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.type=null,r.$id=null,r.paddingTop=0,r.paddingBottom=0,r.paddingLeft=0,r.paddingRight=0,r.$uniforms={},t.nativeRender&&egret_native.NativeDisplayObject.createFilter(r),r}return __extends(r,e),r.prototype.$toJson=function(){return""},r.prototype.updatePadding=function(){},r.prototype.onPropertyChange=function(){var e=this;e.updatePadding(),t.nativeRender&&(egret_native.NativeDisplayObject.setFilterPadding(e.$id,e.paddingTop,e.paddingBottom,e.paddingLeft,e.paddingRight),egret_native.NativeDisplayObject.setDataToFilter(e))},r}(t.HashObject);t.Filter=e,__reflect(e.prototype,"egret.Filter")}(egret||(egret={}));var egret;!function(t){function e(t){return t%=360,t>180?t-=360:-180>t&&(t+=360),t}var r=function(r){function i(){var e=r.call(this)||this;return e.$children=null,e.$name="",e.$parent=null,e.$stage=null,e.$nestLevel=0,e.$useTranslate=!1,e.$matrix=new t.Matrix,e.$matrixDirty=!1,e.$x=0,e.$y=0,e.$scaleX=1,e.$scaleY=1,e.$rotation=0,e.$skewX=0,e.$skewXdeg=0,e.$skewY=0,e.$skewYdeg=0,e.$explicitWidth=0/0,e.$explicitHeight=0/0,e.$anchorOffsetX=0,e.$anchorOffsetY=0,e.$visible=!0,e.$displayList=null,e.$cacheAsBitmap=!1,e.$cacheDirty=!1,e.$alpha=1,e.$touchEnabled=i.defaultTouchEnabled,e.$scrollRect=null,e.$blendMode=0,e.$maskedObject=null,e.$mask=null,e.$maskRect=null,e.$parentDisplayList=null,e.$renderNode=null,e.$renderDirty=!1,e.$renderMode=null,e._tint=0,e.$tintRGB=0,e.$sortDirty=!1,e._zIndex=0,e.$lastSortedIndex=0,e.sortableChildren=!1,t.nativeRender&&e.createNativeDisplayObject(),e.tint=16777215,e}return __extends(i,r),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(0)},Object.defineProperty(i.prototype,"name",{get:function(){return this.$name},set:function(t){this.$name=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this.$parent},enumerable:!0,configurable:!0}),i.prototype.$setParent=function(t){this.$parent=t},i.prototype.$onAddToStage=function(e,r){var i=this;i.$stage=e,i.$nestLevel=r,i.$hasAddToStage=!0,t.Sprite.$EVENT_ADD_TO_STAGE_LIST.push(i)},i.prototype.$onRemoveFromStage=function(){var e=this;e.$nestLevel=0,t.Sprite.$EVENT_REMOVE_FROM_STAGE_LIST.push(e)},i.prototype.$updateUseTransform=function(){var t=this;1==t.$scaleX&&1==t.$scaleY&&0==t.$skewX&&0==t.$skewY?t.$useTranslate=!1:t.$useTranslate=!0},Object.defineProperty(i.prototype,"stage",{get:function(){return this.$stage},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"matrix",{get:function(){return this.$getMatrix().clone()},set:function(t){this.$setMatrix(t)},enumerable:!0,configurable:!0}),i.prototype.$getMatrix=function(){var t=this;return t.$matrixDirty&&(t.$matrixDirty=!1,t.$matrix.$updateScaleAndRotation(t.$scaleX,t.$scaleY,t.$skewX,t.$skewY)),t.$matrix.tx=t.$x,t.$matrix.ty=t.$y,t.$matrix},i.prototype.$setMatrix=function(r,i){void 0===i&&(i=!0);var n=this,o=n.$matrix;o.a=r.a,o.b=r.b,o.c=r.c,o.d=r.d,n.$x=r.tx,n.$y=r.ty,n.$matrixDirty=!1,1==o.a&&0==o.b&&0==o.c&&1==o.d?n.$useTranslate=!1:n.$useTranslate=!0,i&&(n.$scaleX=o.$getScaleX(),n.$scaleY=o.$getScaleY(),n.$skewX=r.$getSkewX(),n.$skewY=r.$getSkewY(),n.$skewXdeg=e(180*n.$skewX/Math.PI),n.$skewYdeg=e(180*n.$skewY/Math.PI),n.$rotation=e(180*n.$skewY/Math.PI)),t.nativeRender&&n.$nativeDisplayObject.setMatrix(r.a,r.b,r.c,r.d,r.tx,r.ty)},i.prototype.$getConcatenatedMatrix=function(){var e=this,r=e.$concatenatedMatrix;r||(r=e.$concatenatedMatrix=new t.Matrix),e.$parent?e.$parent.$getConcatenatedMatrix().$preMultiplyInto(e.$getMatrix(),r):r.copyFrom(e.$getMatrix());var i=e.$anchorOffsetX,n=e.$anchorOffsetY,o=e.$scrollRect;return o?r.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-o.x-i,-o.y-n),r):(0!=i||0!=n)&&r.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-i,-n),r),e.$concatenatedMatrix},i.prototype.$getInvertedConcatenatedMatrix=function(){var e=this;return e.$invertedConcatenatedMatrix||(e.$invertedConcatenatedMatrix=new t.Matrix),e.$getConcatenatedMatrix().$invertInto(e.$invertedConcatenatedMatrix),e.$invertedConcatenatedMatrix},Object.defineProperty(i.prototype,"x",{get:function(){return this.$getX()},set:function(t){this.$setX(t)},enumerable:!0,configurable:!0}),i.prototype.$getX=function(){return this.$x},i.prototype.$setX=function(e){var r=this;if(r.$x==e)return!1;if(r.$x=e,t.nativeRender)r.$nativeDisplayObject.setX(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},Object.defineProperty(i.prototype,"y",{get:function(){return this.$getY()},set:function(t){this.$setY(t)},enumerable:!0,configurable:!0}),i.prototype.$getY=function(){return this.$y},i.prototype.$setY=function(e){var r=this;if(r.$y==e)return!1;if(r.$y=e,t.nativeRender)r.$nativeDisplayObject.setY(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},Object.defineProperty(i.prototype,"scaleX",{get:function(){return this.$getScaleX()},set:function(t){this.$setScaleX(t)},enumerable:!0,configurable:!0}),i.prototype.$getScaleX=function(){return this.$scaleX},i.prototype.$setScaleX=function(e){var r=this;if(r.$scaleX!=e)if(r.$scaleX=e,r.$matrixDirty=!0,r.$updateUseTransform(),t.nativeRender)r.$nativeDisplayObject.setScaleX(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"scaleY",{get:function(){return this.$getScaleY()},set:function(t){this.$setScaleY(t)},enumerable:!0,configurable:!0}),i.prototype.$getScaleY=function(){return this.$scaleY},i.prototype.$setScaleY=function(e){var r=this;if(r.$scaleY!=e)if(r.$scaleY=e,r.$matrixDirty=!0,r.$updateUseTransform(),t.nativeRender)r.$nativeDisplayObject.setScaleY(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"rotation",{get:function(){return this.$getRotation()},set:function(t){this.$setRotation(t)},enumerable:!0,configurable:!0}),i.prototype.$getRotation=function(){return this.$rotation},i.prototype.$setRotation=function(r){r=e(r);var i=this;if(r!=i.$rotation){var n=r-i.$rotation,o=n/180*Math.PI;if(i.$skewX+=o,i.$skewY+=o,i.$rotation=r,i.$matrixDirty=!0,i.$updateUseTransform(),t.nativeRender)i.$nativeDisplayObject.setRotation(r);else{var a=i.$parent;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp());var s=i.$maskedObject;s&&!s.$cacheDirty&&(s.$cacheDirty=!0,s.$cacheDirtyUp())}}},Object.defineProperty(i.prototype,"skewX",{get:function(){return this.$skewXdeg},set:function(t){this.$setSkewX(t)},enumerable:!0,configurable:!0}),i.prototype.$setSkewX=function(r){var i=this;if(r!=i.$skewXdeg)if(i.$skewXdeg=r,r=e(r),r=r/180*Math.PI,i.$skewX=r,i.$matrixDirty=!0,i.$updateUseTransform(),t.nativeRender)i.$nativeDisplayObject.setSkewX(i.$skewXdeg);else{var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var o=i.$maskedObject;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"skewY",{get:function(){return this.$skewYdeg},set:function(t){this.$setSkewY(t)},enumerable:!0,configurable:!0}),i.prototype.$setSkewY=function(r){var i=this;if(r!=i.$skewYdeg)if(i.$skewYdeg=r,r=e(r),r=(r+i.$rotation)/180*Math.PI,i.$skewY=r,i.$matrixDirty=!0,i.$updateUseTransform(),t.nativeRender)i.$nativeDisplayObject.setSkewY(i.$skewYdeg);else{var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var o=i.$maskedObject;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){this.$setWidth(t)},enumerable:!0,configurable:!0}),i.prototype.$getWidth=function(){var t=this;return isNaN(t.$explicitWidth)?t.$getOriginalBounds().width:t.$explicitWidth},i.prototype.$setWidth=function(t){t=isNaN(t)?0/0:t,this.$explicitWidth!=t&&(this.$explicitWidth=t)},Object.defineProperty(i.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){this.$setHeight(t)},enumerable:!0,configurable:!0}),i.prototype.$getHeight=function(){var t=this;return isNaN(t.$explicitHeight)?t.$getOriginalBounds().height:t.$explicitHeight},i.prototype.$setHeight=function(t){t=isNaN(t)?0/0:t,this.$explicitHeight!=t&&(this.$explicitHeight=t)},Object.defineProperty(i.prototype,"measuredWidth",{get:function(){return this.$getOriginalBounds().width},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"measuredHeight",{get:function(){return this.$getOriginalBounds().height},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"anchorOffsetX",{get:function(){return this.$anchorOffsetX},set:function(t){this.$setAnchorOffsetX(t)},enumerable:!0,configurable:!0}),i.prototype.$setAnchorOffsetX=function(e){var r=this;if(r.$anchorOffsetX!=e)if(r.$anchorOffsetX=e,t.nativeRender)r.$nativeDisplayObject.setAnchorOffsetX(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"anchorOffsetY",{get:function(){return this.$anchorOffsetY},set:function(t){this.$setAnchorOffsetY(t)},enumerable:!0,configurable:!0}),i.prototype.$setAnchorOffsetY=function(e){var r=this;if(r.$anchorOffsetY!=e)if(r.$anchorOffsetY=e,t.nativeRender)r.$nativeDisplayObject.setAnchorOffsetY(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"visible",{get:function(){return this.$visible},set:function(t){this.$setVisible(t)},enumerable:!0,configurable:!0}),i.prototype.$setVisible=function(e){var r=this;if(r.$visible!=e)if(r.$visible=e,t.nativeRender)r.$nativeDisplayObject.setVisible(e);else{r.$updateRenderMode();var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"cacheAsBitmap",{get:function(){return this.$cacheAsBitmap},set:function(e){var r=this;r.$cacheAsBitmap=e,t.nativeRender?r.$nativeDisplayObject.setCacheAsBitmap(e):r.$setHasDisplayList(e)},enumerable:!0,configurable:!0}),i.prototype.$setHasDisplayList=function(e){var r=this,i=!!r.$displayList;if(i!=e)if(e){var n=t.sys.DisplayList.create(r);n&&(r.$displayList=n,r.$cacheDirty=!0)}else r.$displayList=null},i.prototype.$cacheDirtyUp=function(){var t=this.$parent;t&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp())},Object.defineProperty(i.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$setAlpha(t)},enumerable:!0,configurable:!0}),i.prototype.$setAlpha=function(e){var r=this;if(r.$alpha!=e)if(r.$alpha=e,t.nativeRender)r.$nativeDisplayObject.setAlpha(e);else{r.$updateRenderMode();var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"touchEnabled",{get:function(){return this.$getTouchEnabled()},set:function(t){this.$setTouchEnabled(t)},enumerable:!0,configurable:!0}),i.prototype.$getTouchEnabled=function(){return this.$touchEnabled},i.prototype.$setTouchEnabled=function(t){this.$touchEnabled=!!t},Object.defineProperty(i.prototype,"scrollRect",{get:function(){return this.$scrollRect},set:function(t){this.$setScrollRect(t)},enumerable:!0,configurable:!0}),i.prototype.$setScrollRect=function(e){var r=this;if(!e&&!r.$scrollRect)return void r.$updateRenderMode();if(e?(r.$scrollRect||(r.$scrollRect=new t.Rectangle),r.$scrollRect.copyFrom(e),t.nativeRender&&r.$nativeDisplayObject.setScrollRect(e.x,e.y,e.width,e.height)):(r.$scrollRect=null,t.nativeRender&&r.$nativeDisplayObject.setScrollRect(0,0,0,0)),!t.nativeRender){r.$updateRenderMode();var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"blendMode",{get:function(){return t.sys.numberToBlendMode(this.$blendMode)},set:function(e){var r=this,i=t.sys.blendModeToNumber(e);if(r.$blendMode!=i)if(r.$blendMode=i,t.nativeRender)r.$nativeDisplayObject.setBlendMode(i);else{r.$updateRenderMode();var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var o=r.$maskedObject;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mask",{get:function(){var t=this;return t.$mask?t.$mask:t.$maskRect},set:function(e){var r=this;if(e!==r){if(e)if(e instanceof i){if(e==r.$mask)return;e.$maskedObject&&(e.$maskedObject.mask=null),e.$maskedObject=r,r.$mask=e,t.nativeRender||e.$updateRenderMode(),r.$maskRect&&(t.nativeRender&&r.$nativeDisplayObject.setMaskRect(0,0,0,0),r.$maskRect=null),t.nativeRender&&r.$nativeDisplayObject.setMask(e.$nativeDisplayObject.id)}else r.$maskRect||(r.$maskRect=new t.Rectangle),r.$maskRect.copyFrom(e),t.nativeRender&&r.$nativeDisplayObject.setMaskRect(e.x,e.y,e.width,e.height),r.$mask&&(r.$mask.$maskedObject=null,t.nativeRender||r.$mask.$updateRenderMode()),r.mask&&(t.nativeRender&&r.$nativeDisplayObject.setMask(-1),r.$mask=null);else r.$mask&&(r.$mask.$maskedObject=null,t.nativeRender||r.$mask.$updateRenderMode()),r.mask&&(t.nativeRender&&r.$nativeDisplayObject.setMask(-1),r.$mask=null),r.$maskRect&&(t.nativeRender&&r.$nativeDisplayObject.setMaskRect(0,0,0,0),r.$maskRect=null);t.nativeRender||r.$updateRenderMode()}},enumerable:!0,configurable:!0}),i.prototype.$setMaskRect=function(e){var r=this;(e||r.$maskRect)&&(e?(r.$maskRect||(r.$maskRect=new t.Rectangle),r.$maskRect.copyFrom(e)):r.$maskRect=null)},Object.defineProperty(i.prototype,"filters",{get:function(){return this.$filters},set:function(e){var r=this,i=r.$filters;if(i||e){if(e&&e.length?(e=e.concat(),r.$filters=e,t.nativeRender&&r.$nativeDisplayObject.setFilters(e)):(r.$filters=e,t.nativeRender&&r.$nativeDisplayObject.setFilters(null)),!t.nativeRender){r.$updateRenderMode();var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var o=r.$maskedObject;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp())}}else if(r.$filters=e,t.nativeRender)r.$nativeDisplayObject.setFilters(null);else{r.$updateRenderMode();var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var o=r.$maskedObject;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),i.prototype.getTransformedBounds=function(t,e){return t=t||this,this.$getTransformedBounds(t,e)},i.prototype.getBounds=function(t,e){void 0===e&&(e=!0);var r=this;return t=r.$getTransformedBounds(r,t),e&&(0!=r.$anchorOffsetX&&(t.x-=r.$anchorOffsetX),0!=r.$anchorOffsetY&&(t.y-=r.$anchorOffsetY)),t},i.prototype.$getTransformedBounds=function(e,r){var i=this,n=i.$getOriginalBounds();if(r||(r=new t.Rectangle),r.copyFrom(n),e==i)return r;var o;if(e){o=t.$TempMatrix;var a=e.$getInvertedConcatenatedMatrix();a.$preMultiplyInto(i.$getConcatenatedMatrix(),o)}else o=i.$getConcatenatedMatrix();return o.$transformBounds(r),r},i.prototype.globalToLocal=function(e,r,i){if(void 0===e&&(e=0),void 0===r&&(r=0),t.nativeRender){egret_native.updateNativeRender();var n=egret_native.nrGlobalToLocal(this.$nativeDisplayObject.id,e,r),o=n.split(","),a=parseFloat(o[0]),s=parseFloat(o[1]);return i?i.setTo(a,s):i=new t.Point(a,s),i}var c=this.$getInvertedConcatenatedMatrix();return c.transformPoint(e,r,i)},i.prototype.localToGlobal=function(e,r,i){if(void 0===e&&(e=0),void 0===r&&(r=0),t.nativeRender){egret_native.updateNativeRender();var n=egret_native.nrLocalToGlobal(this.$nativeDisplayObject.id,e,r),o=n.split(","),a=parseFloat(o[0]),s=parseFloat(o[1]);return i?i.setTo(a,s):i=new t.Point(a,s),i}var c=this.$getConcatenatedMatrix();return c.transformPoint(e,r,i)},i.prototype.$getOriginalBounds=function(){var t=this,e=t.$getContentBounds();t.$measureChildBounds(e);var r=t.$measureFiltersOffset(!1);return r&&(e.x+=r.minX,e.y+=r.minY,e.width+=-r.minX+r.maxX,e.height+=-r.minY+r.maxY),e},i.prototype.$measureChildBounds=function(t){},i.prototype.$getContentBounds=function(){var e=t.$TempRectangle;return e.setEmpty(),this.$measureContentBounds(e),e},i.prototype.$measureContentBounds=function(t){},i.prototype.$getRenderNode=function(){var t=this,e=t.$renderNode;return e?(t.$renderDirty&&(e.cleanBeforeRender(),t.$updateRenderNode(),t.$renderDirty=!1,e=t.$renderNode),e):null},i.prototype.$updateRenderMode=function(){var t=this;!t.$visible||t.$alpha<=0||t.$maskedObject?t.$renderMode=1:t.filters&&t.filters.length>0?t.$renderMode=2:0!==t.$blendMode||t.$mask&&t.$mask.$stage?t.$renderMode=3:t.$scrollRect||t.$maskRect?t.$renderMode=4:t.$renderMode=null},i.prototype.$measureFiltersOffset=function(e){for(var r=this,i=0,n=0,o=0,a=0;r;){var s=r.$filters;if(s&&s.length)for(var c=s.length,h=0;c>h;h++){var u=s[h];if("blur"==u.type){var l=u.blurX,p=u.blurY;i-=l,n-=p,o+=l,a+=p}else if("glow"==u.type){var l=u.blurX,p=u.blurY;i-=l,n-=p,o+=l,a+=p;var d=u.distance||0,f=u.angle||0,g=0,v=0;0!=d&&(g=d*t.NumberUtils.cos(f),g=g>0?Math.ceil(g):Math.floor(g),v=d*t.NumberUtils.sin(f),v=v>0?Math.ceil(v):Math.floor(v),i+=g,o+=g,n+=v,a+=v)}else if("custom"==u.type){var y=u.padding;i-=y,n-=y,o+=y,a+=y}}r=e?r.$parent:null}return i=Math.min(i,0),n=Math.min(n,0),o=Math.max(o,0),a=Math.max(a,0),{minX:i,minY:n,maxX:o,maxY:a}},i.prototype.$getConcatenatedMatrixAt=function(e,r){var i=e.$getInvertedConcatenatedMatrix();if(0===i.a||0===i.d){var n=this,o=e.$nestLevel;for(r.identity();n.$nestLevel>o;){var a=n.$scrollRect;a&&r.concat(t.$TempMatrix.setTo(1,0,0,1,-a.x,-a.y)),r.concat(n.$getMatrix()),n=n.$parent}}else i.$preMultiplyInto(r,r)},i.prototype.$updateRenderNode=function(){},i.prototype.$hitTest=function(e,r){var i=this;if(!t.nativeRender&&!i.$renderNode||!i.$visible||0==i.$scaleX||0==i.$scaleY)return null;var n=i.$getInvertedConcatenatedMatrix();if(0==n.a&&0==n.b&&0==n.c&&0==n.d)return null;var o=i.$getContentBounds(),a=n.a*e+n.c*r+n.tx,s=n.b*e+n.d*r+n.ty;if(o.contains(a,s)){if(!i.$children){var c=i.$scrollRect?i.$scrollRect:i.$maskRect;if(c&&!c.contains(a,s))return null;if(i.$mask&&!i.$mask.$hitTest(e,r))return null}return i}return null},i.prototype.hitTestPoint=function(e,r,i){var n=this;if(i){var o=n.$getInvertedConcatenatedMatrix(),a=o.a*e+o.c*r+o.tx,s=o.b*e+o.d*r+o.ty,c=void 0;if(t.nativeRender){var h=t.sys.customHitTestBuffer;h.resize(3,3),egret_native.forHitTest=!0,egret_native.activateBuffer(h),egret_native.updateNativeRender(),egret_native.nrRenderDisplayObject2(n.$nativeDisplayObject.id,1-a,1-s,!0);try{c=new Uint8Array(4),egret_native.nrGetPixels(1,1,1,1,c)}catch(u){throw new Error(t.sys.tr(1039))}return egret_native.activateBuffer(null),egret_native.forHitTest=!1,0===c[3]?!1:!0}var l=n.$displayList;if(l){var h=l.renderBuffer;try{c=h.getPixels(a-l.offsetX,s-l.offsetY)}catch(u){throw new Error(t.sys.tr(1039))}}else{var h=t.sys.customHitTestBuffer;h.resize(3,3);var p=t.Matrix.create();p.identity(),p.translate(1-a,1-s),t.sys.systemRenderer.render(this,h,p,!0),t.Matrix.release(p);try{c=h.getPixels(1,1)}catch(u){throw new Error(t.sys.tr(1039))}}return 0===c[3]?!1:!0}if(0==n.$scaleX||0==n.$scaleY)return!1;var o=n.$getInvertedConcatenatedMatrix(),d=n.getBounds(null,!1),a=o.a*e+o.c*r+o.tx,s=o.b*e+o.d*r+o.ty;if(d.contains(a,s)){var f=n.$scrollRect?n.$scrollRect:n.$maskRect;return f&&!f.contains(a,s)?!1:!0}return!1},i.prototype.$addListener=function(e,n,o,a,s,c){r.prototype.$addListener.call(this,e,n,o,a,s,c);var h=e==t.Event.ENTER_FRAME;if(h||e==t.Event.RENDER){var u=h?i.$enterFrameCallBackList:i.$renderCallBackList;-1==u.indexOf(this)&&u.push(this)}},i.prototype.removeEventListener=function(e,n,o,a){r.prototype.removeEventListener.call(this,e,n,o,a);var s=e==t.Event.ENTER_FRAME;if((s||e==t.Event.RENDER)&&!this.hasEventListener(e)){var c=s?i.$enterFrameCallBackList:i.$renderCallBackList,h=c.indexOf(this);-1!==h&&c.splice(h,1)}},i.prototype.dispatchEvent=function(t){if(!t.$bubbles)return r.prototype.dispatchEvent.call(this,t);var e=this.$getPropagationList(this),i=.5*e.length;return t.$setTarget(this),this.$dispatchPropagationEvent(t,e,i),!t.$isDefaultPrevented},i.prototype.$getPropagationList=function(t){for(var e=[];t;)e.push(t),t=t.$parent;var r=e.concat();return r.reverse(),e=r.concat(e)},i.prototype.$dispatchPropagationEvent=function(t,e,r){for(var i=e.length,n=r-1,o=0;i>o;o++){var a=e[o];if(t.$currentTarget=a,n>o?t.$eventPhase=1:o==r||o==n?t.$eventPhase=2:t.$eventPhase=3,a.$notifyListener(t,r>o),t.$isPropagationStopped||t.$isPropagationImmediateStopped)return}},i.prototype.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.$parent}return!1},Object.defineProperty(i.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this.$tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!0,configurable:!0}),i.prototype.sortChildren=function(){this.$sortDirty=!1},Object.defineProperty(i.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.$sortDirty=!0)},enumerable:!0,configurable:!0}),i.defaultTouchEnabled=!1,i.$enterFrameCallBackList=[],i.$renderCallBackList=[],i}(t.EventDispatcher);t.DisplayObject=r,__reflect(r.prototype,"egret.DisplayObject")}(egret||(egret={}));var egret;!function(t){t.$TextureScaleFactor=1;var e=function(e){function r(){var t=e.call(this)||this;return t.disposeBitmapData=!0,t.$bitmapX=0,t.$bitmapY=0,t.$bitmapWidth=0,t.$bitmapHeight=0,t.$offsetX=0,t.$offsetY=0,t.$textureWidth=0,t.$textureHeight=0,t.$sourceWidth=0,t.$sourceHeight=0,t.$bitmapData=null,t.$ktxData=null,t.$rotated=!1,t}return __extends(r,e),Object.defineProperty(r.prototype,"textureWidth",{get:function(){return this.$getTextureWidth()},enumerable:!0,configurable:!0}),r.prototype.$getTextureWidth=function(){return this.$textureWidth},Object.defineProperty(r.prototype,"textureHeight",{get:function(){return this.$getTextureHeight()},enumerable:!0,configurable:!0}),r.prototype.$getTextureHeight=function(){return this.$textureHeight},r.prototype.$getScaleBitmapWidth=function(){return this.$bitmapWidth*t.$TextureScaleFactor},r.prototype.$getScaleBitmapHeight=function(){return this.$bitmapHeight*t.$TextureScaleFactor},Object.defineProperty(r.prototype,"bitmapData",{get:function(){return this.$bitmapData},set:function(t){this.$ktxData=null,this._setBitmapData(t)},enumerable:!0,configurable:!0}),r.prototype._setBitmapData=function(e){this.$bitmapData=e;var r=t.$TextureScaleFactor,i=e.width*r,n=e.height*r;this.$initData(0,0,i,n,0,0,i,n,e.width,e.height)},Object.defineProperty(r.prototype,"ktxData",{get:function(){return this.$ktxData},set:function(t){this._setKtxData(t)},enumerable:!0,configurable:!0}),r.prototype._setKtxData=function(e){if(!e)return void t.error("ktx data is null");if(e!=this.$ktxData){var r=new t.KTXContainer(e,1);if(r.isInvalid)return void t.error("ktx data is invalid");this.$ktxData=e;var i=new t.BitmapData(e);i.format="ktx",r.uploadLevels(i,!1),this._setBitmapData(i)}},r.prototype.$initData=function(e,r,i,n,o,a,s,c,h,u,l){void 0===l&&(l=!1);var p=t.$TextureScaleFactor;this.$bitmapX=e/p,this.$bitmapY=r/p,this.$bitmapWidth=i/p,this.$bitmapHeight=n/p,this.$offsetX=o,this.$offsetY=a,this.$textureWidth=s,this.$textureHeight=c,this.$sourceWidth=h,this.$sourceHeight=u,this.$rotated=l,t.BitmapData.$invalidate(this.$bitmapData)},r.prototype.getPixel32=function(t,e){throw new Error},r.prototype.getPixels=function(t,e,r,i){throw void 0===r&&(r=1),void 0===i&&(i=1),new Error},r.prototype.toDataURL=function(t,e,r){throw new Error},r.prototype.saveToFile=function(t,e,r){throw new Error},r.prototype.dispose=function(){this.$bitmapData&&(this.disposeBitmapData&&this.$bitmapData.$dispose(),this.$bitmapData=null)},r}(t.HashObject);t.Texture=e,__reflect(e.prototype,"egret.Texture")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.$eventPhase=2,o.$currentTarget=null,o.$target=null,o.$isDefaultPrevented=!1,o.$isPropagationStopped=!1,o.$isPropagationImmediateStopped=!1,o.$type=e,o.$bubbles=!!r,o.$cancelable=!!i,o.data=n,o}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.$type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbles",{get:function(){return this.$bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this.$cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventPhase",{get:function(){return this.$eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTarget",{get:function(){return this.$currentTarget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.$target},enumerable:!0,configurable:!0}),e.prototype.$setTarget=function(t){return this.$target=t,!0},e.prototype.isDefaultPrevented=function(){return this.$isDefaultPrevented},e.prototype.preventDefault=function(){this.$cancelable&&(this.$isDefaultPrevented=!0)},e.prototype.stopPropagation=function(){this.$bubbles&&(this.$isPropagationStopped=!0)},e.prototype.stopImmediatePropagation=function(){this.$bubbles&&(this.$isPropagationImmediateStopped=!0)},e.prototype.clean=function(){this.data=this.$currentTarget=null,this.$setTarget(null)},e.dispatchEvent=function(t,r,i,n){void 0===i&&(i=!1);var o=e.create(e,r,i),a=e._getPropertyData(e);void 0!=n&&(a.data=n);var s=t.dispatchEvent(o);return e.release(o),s},e._getPropertyData=function(t){var e=t._props;return e||(e=t._props={}),e},e.create=function(t,e,r,i){var n,o=t.hasOwnProperty("eventPool");if(o&&(n=t.eventPool),n||(n=t.eventPool=[]),n.length){var a=n.pop();return a.$type=e,a.$bubbles=!!r,a.$cancelable=!!i,a.$isDefaultPrevented=!1,a.$isPropagationStopped=!1,a.$isPropagationImmediateStopped=!1,a.$eventPhase=2,a}return new t(e,r,i)},e.release=function(t){t.clean();var e=Object.getPrototypeOf(t).constructor;e.eventPool.push(t)},e.ADDED_TO_STAGE="addedToStage",e.REMOVED_FROM_STAGE="removedFromStage",e.ADDED="added",e.REMOVED="removed",e.ENTER_FRAME="enterFrame",e.RENDER="render",e.RESIZE="resize",e.CHANGE="change",e.CHANGING="changing",e.COMPLETE="complete",e.LOOP_COMPLETE="loopComplete",e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e.ENDED="ended",e.ACTIVATE="activate",e.DEACTIVATE="deactivate",e.CLOSE="close",e.CONNECT="connect",e.LEAVE_STAGE="leaveStage",e.SOUND_COMPLETE="soundComplete",e}(t.HashObject);t.Event=e,__reflect(e.prototype,"egret.Event")}(egret||(egret={}));var egret;!function(t){function e(){return""}function r(t){throw new Error("#"+t)}function i(){}function n(){}t.getString=e,t.$error=r,t.$warn=i,t.$markCannotUse=n}(egret||(egret={}));var egret;!function(t){var e=[],r=Math.PI/180,i=function(i){function n(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var r=i.call(this)||this;return r.x=t,r.y=e,r}return __extends(n,i),n.release=function(t){t&&e.push(t)},n.create=function(t,r){var i=e.pop();return i||(i=new n),i.setTo(t,r)},Object.defineProperty(n.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),n.prototype.setTo=function(t,e){return this.x=t,this.y=e,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},n.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},n.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.interpolate=function(t,e,r){var i=1-r;return new n(t.x*r+e.x*i,t.y*r+e.y*i)},n.prototype.normalize=function(t){if(0!=this.x||0!=this.y){var e=t/this.length;this.x*=e,this.y*=e}},n.prototype.offset=function(t,e){this.x+=t,this.y+=e},n.polar=function(e,i){return new n(e*t.NumberUtils.cos(i/r),e*t.NumberUtils.sin(i/r))},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},n}(t.HashObject);t.Point=i,__reflect(i.prototype,"egret.Point"),t.$TempPoint=new i}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t.$touchChildren=!0,t.$children=[],t}return __extends(r,e),Object.defineProperty(r.prototype,"numChildren",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),r.prototype.setChildrenSortMode=function(e){t.nativeRender&&this.$nativeDisplayObject.setChildrenSortMode&&this.$nativeDisplayObject.setChildrenSortMode(e)
},r.prototype.addChild=function(t){var e=this.$children.length;return t.$parent==this&&e--,this.$doAddChild(t,e)},r.prototype.addChildAt=function(t,e){return e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length,t.$parent==this&&e--),this.$doAddChild(t,e)},r.prototype.$doAddChild=function(e,i,n){void 0===n&&(n=!0);var o=this,a=e.$parent;if(a==o)return o.doSetChildIndex(e,i),e;a&&a.removeChild(e),o.$children.splice(i,0,e),e.$setParent(o),t.nativeRender&&o.$nativeDisplayObject.addChildAt(e.$nativeDisplayObject.id,i);var s=o.$stage;if(s&&e.$onAddToStage(s,o.$nestLevel+1),n&&e.dispatchEventWith(t.Event.ADDED,!0),s)for(var c=r.$EVENT_ADD_TO_STAGE_LIST;c.length;){var h=c.shift();h.$stage&&n&&h.dispatchEventWith(t.Event.ADDED_TO_STAGE)}if(!t.nativeRender&&(e.$maskedObject&&e.$maskedObject.$updateRenderMode(),!o.$cacheDirty)){o.$cacheDirty=!0;var u=o.$parent;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp());var l=o.$maskedObject;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp())}return this.$childAdded(e,i),e},r.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.$parent}return!1},r.prototype.getChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$children[t]:null},r.prototype.getChildIndex=function(t){return this.$children.indexOf(t)},r.prototype.getChildByName=function(t){for(var e,r=this.$children,i=r.length,n=0;i>n;n++)if(e=r[n],e.name==t)return e;return null},r.prototype.removeChild=function(t){var e=this.$children.indexOf(t);return e>=0?this.$doRemoveChild(e):null},r.prototype.removeChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$doRemoveChild(t):null},r.prototype.$doRemoveChild=function(e,i){void 0===i&&(i=!0),e=0|+e;var n=this,o=this.$children,a=o[e];if(this.$childRemoved(a,e),i&&a.dispatchEventWith(t.Event.REMOVED,!0),this.$stage){a.$onRemoveFromStage();for(var s=r.$EVENT_REMOVE_FROM_STAGE_LIST;s.length>0;){var c=s.shift();i&&c.$hasAddToStage&&(c.$hasAddToStage=!1,c.dispatchEventWith(t.Event.REMOVED_FROM_STAGE)),c.$hasAddToStage=!1,c.$stage=null}}this.$displayList||this.$parentDisplayList,a.$setParent(null);var h=o.indexOf(a);if(-1!=h&&o.splice(h,1),t.nativeRender)n.$nativeDisplayObject.removeChild(a.$nativeDisplayObject.id);else if(a.$maskedObject&&a.$maskedObject.$updateRenderMode(),!n.$cacheDirty){n.$cacheDirty=!0;var u=n.$parent;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp());var l=n.$maskedObject;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp())}return a},r.prototype.setChildIndex=function(t,e){e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length-1),this.doSetChildIndex(t,e)},r.prototype.doSetChildIndex=function(e,r){var i=this,n=this.$children.indexOf(e);if(n!=r)if(this.$childRemoved(e,n),this.$children.splice(n,1),this.$children.splice(r,0,e),this.$childAdded(e,r),t.nativeRender)this.$nativeDisplayObject.removeChild(e.$nativeDisplayObject.id),this.$nativeDisplayObject.addChildAt(e.$nativeDisplayObject.id,r);else if(!i.$cacheDirty){i.$cacheDirty=!0;var o=i.$parent;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp());var a=i.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},r.prototype.swapChildrenAt=function(t,e){t=0|+t,e=0|+e,t>=0&&t<this.$children.length&&e>=0&&e<this.$children.length&&this.doSwapChildrenAt(t,e)},r.prototype.swapChildren=function(t,e){var r=this.$children.indexOf(t),i=this.$children.indexOf(e);-1==r||-1==i||this.doSwapChildrenAt(r,i)},r.prototype.doSwapChildrenAt=function(e,r){var i=this;if(e>r){var n=r;r=e,e=n}else if(e==r)return;var o=this.$children,a=o[e],s=o[r];if(this.$childRemoved(a,e),this.$childRemoved(s,r),o[e]=s,o[r]=a,this.$childAdded(s,e),this.$childAdded(a,r),t.nativeRender)this.$nativeDisplayObject.swapChild(e,r);else if(!i.$cacheDirty){i.$cacheDirty=!0;var c=i.$parent;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp());var h=i.$maskedObject;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp())}},r.prototype.removeChildren=function(){for(var t=this.$children,e=t.length-1;e>=0;e--)this.$doRemoveChild(e)},r.prototype.$childAdded=function(t,e){},r.prototype.$childRemoved=function(t,e){},r.prototype.$onAddToStage=function(t,r){e.prototype.$onAddToStage.call(this,t,r);var i=this.$children,n=i.length;r++;for(var o=0;n>o;o++){var a=this.$children[o];a.$onAddToStage(t,r),a.$maskedObject&&a.$maskedObject.$updateRenderMode()}},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);for(var t=this.$children,r=t.length,i=0;r>i;i++){var n=t[i];n.$onRemoveFromStage()}},r.prototype.$measureChildBounds=function(e){var r=this.$children,i=r.length;if(0!=i){for(var n=0,o=0,a=0,s=0,c=!1,h=-1;i>h;h++){var u=void 0;-1==h?u=e:(r[h].getBounds(t.$TempRectangle),r[h].$getMatrix().$transformBounds(t.$TempRectangle),u=t.$TempRectangle),u.isEmpty()||(c?(n=Math.min(n,u.x),o=Math.max(o,u.x+u.width),a=Math.min(a,u.y),s=Math.max(s,u.y+u.height)):(c=!0,n=u.x,o=n+u.width,a=u.y,s=a+u.height))}e.setTo(n,a,o-n,s-a)}},Object.defineProperty(r.prototype,"touchChildren",{get:function(){return this.$getTouchChildren()},set:function(t){this.$setTouchChildren(!!t)},enumerable:!0,configurable:!0}),r.prototype.$getTouchChildren=function(){return this.$touchChildren},r.prototype.$setTouchChildren=function(t){return this.$touchChildren==t?!1:(this.$touchChildren=t,!0)},r.prototype.$hitTest=function(t,r){if(!this.$visible)return null;var i=this.$getInvertedConcatenatedMatrix(),n=i.a*t+i.c*r+i.tx,o=i.b*t+i.d*r+i.ty,a=this.$scrollRect?this.$scrollRect:this.$maskRect;if(a&&!a.contains(n,o))return null;if(this.$mask&&!this.$mask.$hitTest(t,r))return null;for(var s=this.$children,c=!1,h=null,u=s.length-1;u>=0;u--){var l=s[u];if(!l.$maskedObject&&(h=l.$hitTest(t,r))){if(c=!0,h.$touchEnabled)break;h=null}}return h?this.$touchChildren?h:this:c?this:e.prototype.$hitTest.call(this,t,r)},r.prototype._sortChildrenFunc=function(t,e){return t.zIndex===e.zIndex?t.$lastSortedIndex-e.$lastSortedIndex:t.zIndex-e.zIndex},r.prototype.sortChildren=function(){e.prototype.sortChildren.call(this),this.$sortDirty=!1;for(var t=!1,r=this.$children,i=null,n=0,o=r.length;o>n;++n)i=r[n],i.$lastSortedIndex=n,t||0===i.zIndex||(t=!0);t&&r.length>1&&r.sort(this._sortChildrenFunc)},r.$EVENT_ADD_TO_STAGE_LIST=[],r.$EVENT_REMOVE_FROM_STAGE_LIST=[],r}(t.DisplayObject);t.DisplayObjectContainer=e,__reflect(e.prototype,"egret.DisplayObjectContainer")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){var i=e.call(this)||this;return i._bitmapX=0,i._bitmapY=0,i._textureMap=t.createMap(),i.$texture=r,i._bitmapX=r.$bitmapX-r.$offsetX,i._bitmapY=r.$bitmapY-r.$offsetY,i}return __extends(r,e),r.prototype.getTexture=function(t){return this._textureMap[t]},r.prototype.createTexture=function(e,r,i,n,o,a,s,c,h){void 0===a&&(a=0),void 0===s&&(s=0),void 0===c&&(c=a+n),void 0===h&&(h=s+o);var u=new t.Texture;return u.disposeBitmapData=!1,u.$bitmapData=this.$texture.$bitmapData,u.$initData(this._bitmapX+r,this._bitmapY+i,n,o,a,s,c,h,this.$texture.$sourceWidth,this.$texture.$sourceHeight),this._textureMap[e]=u,u},r.prototype.dispose=function(){this.$texture&&this.$texture.dispose()},r}(t.HashObject);t.SpriteSheet=e,__reflect(e.prototype,"egret.SpriteSheet")}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$language="en_US"}(egret||(egret={})),function(t){var e;!function(e){function r(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var n=t.$locale_strings[t.$language][e];if(!n)return"{"+e+"}";for(var o=r.length,a=0;o>a;a++)n=n.replace("{"+a+"}",r[a]);return n}e.tr=r}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(i){var n=e.call(this)||this;return n.$texture=null,n.$bitmapData=null,n.$bitmapX=0,n.$bitmapY=0,n.$bitmapWidth=0,n.$bitmapHeight=0,n.$offsetX=0,n.$offsetY=0,n.$textureWidth=0,n.$textureHeight=0,n.$sourceWidth=0,n.$sourceHeight=0,n.$smoothing=r.defaultSmoothing,n.$explicitBitmapWidth=0/0,n.$explicitBitmapHeight=0/0,n.$scale9Grid=null,n.$fillMode="scale",n._pixelHitTest=!1,n.$renderNode=new t.sys.NormalBitmapNode,n.$setTexture(i),i&&(n.$renderNode.rotated=i.$rotated),n}return __extends(r,e),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(1)},r.prototype.$onAddToStage=function(r,i){e.prototype.$onAddToStage.call(this,r,i);var n=this.$texture;n&&n.$bitmapData&&t.BitmapData.$addDisplayObject(this,n.$bitmapData)},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);var r=this.$texture;r&&t.BitmapData.$removeDisplayObject(this,r.$bitmapData)},Object.defineProperty(r.prototype,"texture",{get:function(){return this.$texture},set:function(t){var e=this;e.$setTexture(t),t&&e.$renderNode&&(e.$renderNode.rotated=t.$rotated)},enumerable:!0,configurable:!0}),r.prototype.$setTexture=function(e){var r=this,i=r.$texture;if(e==i)return!1;if(r.$texture=e,!e){i&&t.BitmapData.$removeDisplayObject(r,i.$bitmapData),r.setImageData(null,0,0,0,0,0,0,0,0,0,0),r.$renderDirty=!0;var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var o=r.$maskedObject;return o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp()),t.nativeRender&&this.setBitmapDataToWasm(null),!0}if(r.$refreshImageData(),r.$stage){if(i&&i.$bitmapData){var a=i.$bitmapData.hashCode,s=e.$bitmapData?e.$bitmapData.hashCode:-1;if(a==s){r.$renderDirty=!0;var c=r.$parent;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp());var h=r.$maskedObject;return h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp()),!0}t.BitmapData.$removeDisplayObject(r,i.$bitmapData)}t.BitmapData.$addDisplayObject(r,e.$bitmapData)}r.$renderDirty=!0;var u=r.$parent;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp());var l=r.$maskedObject;return l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp()),!0},r.prototype.$setBitmapData=function(t){this.$setTexture(t)},r.prototype.setBitmapDataToWasm=function(t){this.$nativeDisplayObject.setTexture(t)},r.prototype.$refreshImageData=function(){var e=this.$texture;e?(t.nativeRender&&this.setBitmapDataToWasm(e),this.setImageData(e.$bitmapData,e.$bitmapX,e.$bitmapY,e.$bitmapWidth,e.$bitmapHeight,e.$offsetX,e.$offsetY,e.$getTextureWidth(),e.$getTextureHeight(),e.$sourceWidth,e.$sourceHeight)):t.nativeRender&&this.setBitmapDataToWasm(null)},r.prototype.setImageData=function(t,e,r,i,n,o,a,s,c,h,u){this.$bitmapData=t,this.$bitmapX=e,this.$bitmapY=r,this.$bitmapWidth=i,this.$bitmapHeight=n,this.$offsetX=o,this.$offsetY=a,this.$textureWidth=s,this.$textureHeight=c,this.$sourceWidth=h,this.$sourceHeight=u},Object.defineProperty(r.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$setScale9Grid(t)},enumerable:!0,configurable:!0}),r.prototype.$setScale9Grid=function(e){var r=this;if(r.$scale9Grid=e,r.$renderDirty=!0,t.nativeRender)e?r.$nativeDisplayObject.setScale9Grid(e.x,e.y,e.width,e.height):r.$nativeDisplayObject.setScale9Grid(0,0,-1,-1);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){this.$setFillMode(t)},enumerable:!0,configurable:!0}),r.prototype.$setFillMode=function(e){var r=this;if(e==r.$fillMode)return!1;if(r.$fillMode=e,t.nativeRender)r.$nativeDisplayObject.setBitmapFillMode(r.$fillMode);else{r.$renderDirty=!0;var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},Object.defineProperty(r.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(e){var r=this;if(e!=this.$smoothing&&(this.$smoothing=e,this.$renderNode.smoothing=e,!t.nativeRender)){var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),r.prototype.$setWidth=function(e){var r=this;if(0>e||e==r.$explicitBitmapWidth)return!1;if(r.$explicitBitmapWidth=e,r.$renderDirty=!0,t.nativeRender)r.$nativeDisplayObject.setWidth(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},r.prototype.$setHeight=function(e){var r=this;if(0>e||e==r.$explicitBitmapHeight)return!1;if(r.$explicitBitmapHeight=e,r.$renderDirty=!0,t.nativeRender)r.$nativeDisplayObject.setHeight(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},r.prototype.$getWidth=function(){return isNaN(this.$explicitBitmapWidth)?this.$getContentBounds().width:this.$explicitBitmapWidth},r.prototype.$getHeight=function(){return isNaN(this.$explicitBitmapHeight)?this.$getContentBounds().height:this.$explicitBitmapHeight},r.prototype.$measureContentBounds=function(t){if(this.$bitmapData){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,r=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight;t.setTo(0,0,e,r)}else{var e=isNaN(this.$explicitBitmapWidth)?0:this.$explicitBitmapWidth,r=isNaN(this.$explicitBitmapHeight)?0:this.$explicitBitmapHeight;t.setTo(0,0,e,r)}},r.prototype.$updateRenderNode=function(){if(this.$texture){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,r=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,i=this.scale9Grid||this.$texture.scale9Grid;i?(this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureDataWithScale9Grid(this.$renderNode,this.$bitmapData,i,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,r,this.$sourceWidth,this.$sourceHeight,this.$smoothing)):(this.fillMode==t.BitmapFillMode.REPEAT&&this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureData(this.$renderNode,this.$bitmapData,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,r,this.$sourceWidth,this.$sourceHeight,this.$fillMode,this.$smoothing))}},Object.defineProperty(r.prototype,"pixelHitTest",{get:function(){return this._pixelHitTest},set:function(t){this._pixelHitTest=!!t},enumerable:!0,configurable:!0}),r.prototype.$hitTest=function(t,r){var i=e.prototype.$hitTest.call(this,t,r);if(i&&this._pixelHitTest){var n=this.hitTestPoint(t,r,!0);n||(i=null)}return i},r.defaultSmoothing=!0,r}(t.DisplayObject);t.Bitmap=e,__reflect(e.prototype,"egret.Bitmap")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.drawData=[],this.renderCount=0}return t.prototype.cleanBeforeRender=function(){this.drawData.length=0,this.renderCount=0},t.prototype.$getRenderCount=function(){return this.renderCount},t}();t.RenderNode=e,__reflect(e.prototype,"egret.sys.RenderNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.$commands=[],this.$data=[],this.commandPosition=0,this.dataPosition=0,this.$lastX=0,this.$lastY=0}return t.prototype.moveTo=function(t,e){this.$commands[this.commandPosition++]=1;var r=this.dataPosition;this.$data[r++]=t,this.$data[r++]=e,this.dataPosition=r},t.prototype.lineTo=function(t,e){this.$commands[this.commandPosition++]=2;var r=this.dataPosition;this.$data[r++]=t,this.$data[r++]=e,this.dataPosition=r},t.prototype.curveTo=function(t,e,r,i){this.$commands[this.commandPosition++]=3;var n=this.dataPosition;this.$data[n++]=t,this.$data[n++]=e,this.$data[n++]=r,this.$data[n++]=i,this.dataPosition=n},t.prototype.cubicCurveTo=function(t,e,r,i,n,o){this.$commands[this.commandPosition++]=4;var a=this.dataPosition;this.$data[a++]=t,this.$data[a++]=e,this.$data[a++]=r,this.$data[a++]=i,this.$data[a++]=n,this.$data[a++]=o,this.dataPosition=a},t.prototype.drawRect=function(t,e,r,i){var n=t+r,o=e+i;this.moveTo(t,e),this.lineTo(n,e),this.lineTo(n,o),this.lineTo(t,o),this.lineTo(t,e)},t.prototype.drawRoundRect=function(t,e,r,i,n,o){var a=.5*n|0,s=o?.5*o|0:a;if(!a||!s)return void this.drawRect(t,e,r,i);var c=.5*r,h=.5*i;if(a>c&&(a=c),s>h&&(s=h),c===a&&h===s)return void(a===s?this.drawCircle(t+a,e+s,a):this.drawEllipse(t,e,2*a,2*s));var u=t+r,l=e+i,p=t+a,d=u-a,f=e+s,g=l-s;this.moveTo(u,g),this.curveTo(u,l,d,l),this.lineTo(p,l),this.curveTo(t,l,t,g),this.lineTo(t,f),this.curveTo(t,e,p,e),this.lineTo(d,e),this.curveTo(u,e,u,f),this.lineTo(u,g)},t.prototype.drawCircle=function(t,e,r){this.arcToBezier(t,e,r,r,0,2*Math.PI)},t.prototype.drawEllipse=function(t,e,r,i){var n=.5*r,o=.5*i;t+=n,e+=o,this.arcToBezier(t,e,n,o,0,2*Math.PI)},t.prototype.drawArc=function(t,e,r,i,n,o){o?n>=i&&(n-=2*Math.PI):i>=n&&(n+=2*Math.PI),this.arcToBezier(t,e,r,r,i,n,o)},t.prototype.arcToBezier=function(t,e,r,i,n,o,a){var s=.5*Math.PI,c=n,h=c;a?(h+=-s-c%s,o>h&&(h=o)):(h+=s-c%s,h>o&&(h=o));var u=t+Math.cos(c)*r,l=e+Math.sin(c)*i;(this.$lastX!=u||this.$lastY!=l)&&this.moveTo(u,l);for(var p=Math.cos(c),d=Math.sin(c),f=0;4>f;f++){var g=h-c,v=4*Math.tan(g/4)/3,y=u-d*v*r,m=l+p*v*i;p=Math.cos(h),d=Math.sin(h),u=t+p*r,l=e+d*i;var $=u+d*v*r,b=l-p*v*i;if(this.cubicCurveTo(y,m,$,b,u,l),h===o)break;c=h,a?(h=c-s,o>h&&(h=o)):(h=c+s,h>o&&(h=o))}},t}();t.Path2D=e,__reflect(e.prototype,"egret.sys.Path2D")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.fontMapping={}}(egret||(egret={}));var egret;!function(t){function e(){var t=Object.create(null);return t.__v8__=void 0,delete t.__v8__,t}t.createMap=e}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i,n,o,a,s,c){void 0===e&&(e=16711680),void 0===r&&(r=1),void 0===i&&(i=6),void 0===n&&(n=6),void 0===o&&(o=2),void 0===a&&(a=1),void 0===s&&(s=!1),void 0===c&&(c=!1);var h=t.call(this)||this,u=h;return u.type="glow",u.$color=e,u.$blue=255&e,u.$green=(65280&e)>>8,u.$red=e>>16,u.$alpha=r,u.$blurX=i,u.$blurY=n,u.$strength=o,u.$quality=a,u.$inner=s,u.$knockout=c,u.$uniforms.color={x:h.$red/255,y:h.$green/255,z:h.$blue/255,w:1},u.$uniforms.alpha=r,u.$uniforms.blurX=i,u.$uniforms.blurY=n,u.$uniforms.strength=o,u.$uniforms.inner=s?1:0,u.$uniforms.knockout=c?0:1,u.$uniforms.dist=0,u.$uniforms.angle=0,u.$uniforms.hideObject=0,u.onPropertyChange(),h}return __extends(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this.$color},set:function(t){this.$color!=t&&(this.$color=t,this.$blue=255&t,this.$green=(65280&t)>>8,this.$red=t>>16,this.$uniforms.color.x=this.$red/255,this.$uniforms.color.y=this.$green/255,this.$uniforms.color.z=this.$blue/255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$alpha!=t&&(this.$alpha=t,this.$uniforms.alpha=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){var e=this;e.$blurX!=t&&(e.$blurX=t,e.$uniforms.blurX=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){var e=this;e.$blurY!=t&&(e.$blurY=t,e.$uniforms.blurY=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.$strength},set:function(t){this.$strength!=t&&(this.$strength=t,this.$uniforms.strength=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.$quality},set:function(t){this.$quality!=t&&(this.$quality=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inner",{get:function(){return this.$inner},set:function(t){this.$inner!=t&&(this.$inner=t,this.$uniforms.inner=t?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this.$knockout},set:function(t){this.$knockout!=t&&(this.$knockout=t,this.$uniforms.knockout=t?0:1)},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+"}"},e.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},e}(t.Filter);t.GlowFilter=e,__reflect(e.prototype,"egret.GlowFilter")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$stageWidth=0,r.$stageHeight=0,r.$scaleMode=t.StageScaleMode.SHOW_ALL,r.$orientation=t.OrientationMode.AUTO,r.$maxTouches=99,r.$stage=r,r.$nestLevel=1,r}return __extends(r,e),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(13)},Object.defineProperty(r.prototype,"frameRate",{get:function(){return t.ticker.$frameRate},set:function(e){t.ticker.$setFrameRate(e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageWidth",{get:function(){return this.$stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageHeight",{get:function(){return this.$stageHeight},enumerable:!0,configurable:!0}),r.prototype.invalidate=function(){t.sys.$invalidateRenderFlag=!0},r.prototype.registerImplementation=function(e,r){t.registerImplementation(e,r)},r.prototype.getImplementation=function(e){return t.getImplementation(e)},Object.defineProperty(r.prototype,"scaleMode",{get:function(){return this.$scaleMode},set:function(t){this.$scaleMode!=t&&(this.$scaleMode=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"orientation",{get:function(){return this.$orientation},set:function(t){this.$orientation!=t&&(this.$orientation=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textureScaleFactor",{get:function(){return t.$TextureScaleFactor},set:function(e){t.$TextureScaleFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxTouches",{get:function(){return this.$maxTouches},set:function(t){this.$maxTouches!=t&&(this.$maxTouches=t,this.$screen.updateMaxTouches())},enumerable:!0,configurable:!0}),r.prototype.setContentSize=function(t,e){this.$screen.setContentSize(t,e)},r}(t.DisplayObjectContainer);t.Stage=e,__reflect(e.prototype,"egret.Stage")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NORMAL="normal",t.ADD="add",t.ERASE="erase",t}();t.BlendMode=e,__reflect(e.prototype,"egret.BlendMode")}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=n[t];return void 0===e?0:e}function r(t){var e=i[t];return void 0===e?"normal":e}for(var i=["normal","add","erase"],n={},o=i.length,a=0;o>a;a++){var s=i[a];n[s]=a}t.blendModeToNumber=e,t.numberToBlendMode=r}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.ChildrenSortMode={DEFAULT:"default",INCREASE_Y:"increaseY",DECREASE_Y:"decreaseY"}}(egret||(egret={}));var egret;!function(t){t.CapsStyle={NONE:"none",ROUND:"round",SQUARE:"square"}}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.compileProgram=function(r,i,n){var o=e.compileFragmentShader(r,n),a=e.compileVertexShader(r,i),s=r.createProgram();return r.attachShader(s,a),r.attachShader(s,o),r.linkProgram(s),r.getProgramParameter(s,r.LINK_STATUS)||t.$warn(1020),s},e.compileFragmentShader=function(t,r){return e._compileShader(t,r,t.FRAGMENT_SHADER)},e.compileVertexShader=function(t,r){return e._compileShader(t,r,t.VERTEX_SHADER)},e._compileShader=function(t,e,r){var i=t.createShader(r);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:null},e.checkCanUseWebGL=function(){if(void 0==e.canUseWebGL)try{var t=document.createElement("canvas");e.canUseWebGL=!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(r){e.canUseWebGL=!1}return e.canUseWebGL},e.deleteWebGLTexture=function(e){if(e&&!e[t.engine_default_empty_texture]){var r=e[t.glContext];r&&r.deleteTexture(e)}},e.premultiplyTint=function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return r=r*e+.5|0,i=i*e+.5|0,n=n*e+.5|0,(255*e<<24)+(r<<16)+(i<<8)+n},e}();t.WebGLUtils=e,__reflect(e.prototype,"egret.WebGLUtils")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),t.call(this,e,r,i)||this}return __extends(e,t),e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e}(t.Event);t.FocusEvent=e,__reflect(e.prototype,"egret.FocusEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.PERMISSION_DENIED="permissionDenied",e.UNAVAILABLE="unavailable",e}(t.Event);t.GeolocationEvent=e,__reflect(e.prototype,"egret.GeolocationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){void 0===r&&(r=!1),void 0===i&&(i=!1);var n=e.call(this,t,r,i)||this;return n._status=0,n}return __extends(r,e),Object.defineProperty(r.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),r.dispatchHTTPStatusEvent=function(e,i){var n=t.Event.create(r,r.HTTP_STATUS);n._status=i;var o=e.dispatchEvent(n);return t.Event.release(n),o},r.HTTP_STATUS="httpStatus",r}(t.Event);t.HTTPStatusEvent=e,__reflect(e.prototype,"egret.HTTPStatusEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),e.call(this,t,r,i)||this}return __extends(r,e),r.dispatchIOErrorEvent=function(e){var i=t.Event.create(r,r.IO_ERROR),n=e.dispatchEvent(i);return t.Event.release(i),n},r.IO_ERROR="ioError",r}(t.Event);t.IOErrorEvent=e,__reflect(e.prototype,"egret.IOErrorEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.MotionEvent=e,__reflect(e.prototype,"egret.MotionEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.OrientationEvent=e,__reflect(e.prototype,"egret.OrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,n,o){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===n&&(n=0),void 0===o&&(o=0);var a=e.call(this,t,r,i)||this;return a.bytesLoaded=0,a.bytesTotal=0,a.bytesLoaded=n,a.bytesTotal=o,a}return __extends(r,e),r.dispatchProgressEvent=function(e,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var a=t.Event.create(r,i);a.bytesLoaded=n,a.bytesTotal=o;var s=e.dispatchEvent(a);return t.Event.release(a),s},r.PROGRESS="progress",r.SOCKET_DATA="socketData",r}(t.Event);t.ProgressEvent=e,__reflect(e.prototype,"egret.ProgressEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),e.call(this,t,r,i)||this}return __extends(r,e),r.dispatchStageOrientationEvent=function(e,i){var n=t.Event.create(r,i),o=e.dispatchEvent(n);return t.Event.release(n),o},r.ORIENTATION_CHANGE="orientationChange",r}(t.Event);t.StageOrientationEvent=e,__reflect(e.prototype,"egret.StageOrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,n){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===n&&(n="");var o=e.call(this,t,r,i)||this;return o.text=n,o}return __extends(r,e),r.dispatchTextEvent=function(e,i,n){var o=t.Event.create(r,i);o.text=n;var a=e.dispatchEvent(o);return t.Event.release(o),a},r.LINK="link",r}(t.Event);t.TextEvent=e,__reflect(e.prototype,"egret.TextEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){return e.call(this,t,r,i)||this}return __extends(r,e),r.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},r.dispatchTimerEvent=function(e,i,n,o){var a=t.Event.create(r,i,n,o),s=e.dispatchEvent(a);return t.Event.release(a),s},r.TIMER="timer",r.TIMER_COMPLETE="timerComplete",r}(t.Event);t.TimerEvent=e,__reflect(e.prototype,"egret.TimerEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();t.CompressedTextureData=e,__reflect(e.prototype,"egret.CompressedTextureData"),t.etc_alpha_mask="etc_alpha_mask",t.engine_default_empty_texture="engine_default_empty_texture",t.is_compressed_texture="is_compressed_texture",t.glContext="glContext",t.UNPACK_PREMULTIPLY_ALPHA_WEBGL="UNPACK_PREMULTIPLY_ALPHA_WEBGL";var r=function(e){function r(r){var i=e.call(this)||this;if(i.format="image",i.$deleteSource=!0,i.compressedTextureData=[],i.debugCompressedTextureURL="",i.etcAlphaMask=null,t.nativeRender){var n=new egret_native.NativeBitmapData;n.$init(),i.$nativeBitmapData=n}return i.source=r,i.source=r,i.source&&(i.width=+r.width,i.height=+r.height),i}return __extends(r,e),Object.defineProperty(r.prototype,"source",{get:function(){return this.$source},set:function(e){this.$source=e,t.nativeRender&&egret_native.NativeDisplayObject.setSourceToNativeBitmapData(this.$nativeBitmapData,e)},enumerable:!0,configurable:!0}),r.create=function(e,i,n){var o="";o="arraybuffer"===e?t.Base64Util.encode(i):i;var a="image/png";"/"===o.charAt(0)?a="image/jpeg":"R"===o.charAt(0)?a="image/gif":"i"===o.charAt(0)&&(a="image/png");var s=new Image;s.src="data:"+a+";base64,"+o,s.crossOrigin="*";var c=new r(s);return s.onload=function(){s.onload=void 0,c.source=s,c.height=s.height,c.width=s.width,n&&n(c)},c},r.prototype.$dispose=function(){"webgl"==t.Capabilities.renderMode&&this.webGLTexture&&(t.WebGLUtils.deleteWebGLTexture(this.webGLTexture),this.webGLTexture=null),this.source&&this.source.dispose&&this.source.dispose(),this.source&&this.source.src&&(this.source.src=""),this.source=null,this.clearCompressedTextureData(),this.debugCompressedTextureURL="",this.etcAlphaMask=null,t.nativeRender&&egret_native.NativeDisplayObject.disposeNativeBitmapData(this.$nativeBitmapData),r.$dispose(this)},r.$addDisplayObject=function(t,e){if(e){var i=e.hashCode;if(i){if(!r._displayList[i])return void(r._displayList[i]=[t]);var n=r._displayList[i];n.indexOf(t)<0&&n.push(t)}}},r.$removeDisplayObject=function(t,e){if(e){var i=e.hashCode;if(i&&r._displayList[i]){var n=r._displayList[i],o=n.indexOf(t);o>=0&&n.splice(o,1)}}},r.$invalidate=function(e){if(e){var i=e.hashCode;if(i&&r._displayList[i])for(var n=r._displayList[i],o=0;o<n.length;o++){n[o]instanceof t.Bitmap&&n[o].$refreshImageData();var a=n[o];a.$renderDirty=!0;var s=a.$parent;s&&!s.$cacheDirty&&(s.$cacheDirty=!0,s.$cacheDirtyUp());var c=a.$maskedObject;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp())}}},r.$dispose=function(e){if(e){var i=e.hashCode;if(i&&r._displayList[i]){for(var n=r._displayList[i],o=0,a=n;o<a.length;o++){var s=a[o];s instanceof t.Bitmap&&(s.$bitmapData=null),s.$renderDirty=!0;var c=s.$parent;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp());var h=s.$maskedObject;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp())}delete r._displayList[i]}}},r.prototype._getCompressedTextureData=function(t,e){var r=this.compressedTextureData[t];return r?r[e]:null},r.prototype.getCompressed2dTextureData=function(){return this._getCompressedTextureData(0,0)},r.prototype.hasCompressed2d=function(){return!!this.getCompressed2dTextureData()},r.prototype.clearCompressedTextureData=function(){this.compressedTextureData.length=0},r._displayList=t.createMap(),r}(t.HashObject);t.BitmapData=r,__reflect(r.prototype,"egret.BitmapData")}(egret||(egret={}));
var egret;!function(t){var e=new t.Point,r=function(r){function i(t,e,i,n,o,a){var s=r.call(this,t,e,i)||this;return s.targetChanged=!0,s.touchDown=!1,s.$initTo(n,o,a),s}return __extends(i,r),i.prototype.$initTo=function(t,e,r){this.touchPointID=+r||0,this.$stageX=+t||0,this.$stageY=+e||0},Object.defineProperty(i.prototype,"stageX",{get:function(){return this.$stageX},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageY",{get:function(){return this.$stageY},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"localX",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localX},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"localY",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localY},enumerable:!0,configurable:!0}),i.prototype.getLocalXY=function(){this.targetChanged=!1;var t=this.$target.$getInvertedConcatenatedMatrix();t.transformPoint(this.$stageX,this.$stageY,e),this._localX=e.x,this._localY=e.y},i.prototype.$setTarget=function(t){return this.$target=t,this.targetChanged=!!t,!0},i.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},i.dispatchTouchEvent=function(e,r,n,o,a,s,c,h){if(void 0===h&&(h=!1),!n&&!e.hasEventListener(r))return!0;var u=t.Event.create(i,r,n,o);u.$initTo(a,s,c),u.touchDown=h;var l=e.dispatchEvent(u);return t.Event.release(u),l},i.TOUCH_MOVE="touchMove",i.TOUCH_BEGIN="touchBegin",i.TOUCH_END="touchEnd",i.TOUCH_CANCEL="touchCancel",i.TOUCH_TAP="touchTap",i.TOUCH_RELEASE_OUTSIDE="touchReleaseOutside",i}(t.Event);t.TouchEvent=r,__reflect(r.prototype,"egret.TouchEvent")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function n(t,n,o){void 0===t&&(t=4),void 0===n&&(n=4),void 0===o&&(o=1);var a=e.call(this)||this,s=a;return s.type="blur",s.$blurX=t,s.$blurY=n,s.$quality=o,s.blurXFilter=new r(t),s.blurYFilter=new i(n),s.onPropertyChange(),a}return __extends(n,e),Object.defineProperty(n.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){var e=this;e.$blurX!=t&&(e.$blurX=t,e.blurXFilter.blurX=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){var e=this;e.$blurY!=t&&(e.$blurY=t,e.blurYFilter.blurY=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),n.prototype.$toJson=function(){return'{"blurX": '+this.$blurX+', "blurY": '+this.$blurY+', "quality": 1}'},n.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},n.prototype.onPropertyChange=function(){var e=this;e.updatePadding(),t.nativeRender&&(egret_native.NativeDisplayObject.setFilterPadding(e.blurXFilter.$id,0,0,e.paddingLeft,e.paddingRight),egret_native.NativeDisplayObject.setFilterPadding(e.blurYFilter.$id,e.paddingTop,e.paddingBottom,0,0),egret_native.NativeDisplayObject.setDataToFilter(e))},n}(t.Filter);t.BlurFilter=e,__reflect(e.prototype,"egret.BlurFilter");var r=function(e){function r(r){void 0===r&&(r=4);var i=e.call(this)||this;return t.nativeRender?i.type="blur":i.type="blurX",i.$uniforms.blur={x:r,y:0},i.onPropertyChange(),i}return __extends(r,e),Object.defineProperty(r.prototype,"blurX",{get:function(){return this.$uniforms.blur.x},set:function(t){this.$uniforms.blur.x=t},enumerable:!0,configurable:!0}),r}(t.Filter);__reflect(r.prototype,"BlurXFilter",["egret.IBlurXFilter"]);var i=function(e){function r(r){void 0===r&&(r=4);var i=e.call(this)||this;return t.nativeRender?i.type="blur":i.type="blurY",i.$uniforms.blur={x:0,y:r},i.onPropertyChange(),i}return __extends(r,e),Object.defineProperty(r.prototype,"blurY",{get:function(){return this.$uniforms.blur.y},set:function(t){this.$uniforms.blur.y=t},enumerable:!0,configurable:!0}),r}(t.Filter);__reflect(i.prototype,"BlurYFilter",["egret.IBlurYFilter"])}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.$matrix=[],r.matrix2=[],r.type="colorTransform",r.$uniforms.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.$uniforms.colorAdd={x:0,y:0,z:0,w:0},r.setMatrix(e),r.onPropertyChange(),r}return __extends(e,t),Object.defineProperty(e.prototype,"matrix",{get:function(){for(var t=0;20>t;t++)this.matrix2[t]=this.$matrix[t];return this.matrix2},set:function(t){this.setMatrix(t)},enumerable:!0,configurable:!0}),e.prototype.setMatrix=function(t){if(t)for(var e=0;20>e;e++)this.$matrix[e]=t[e];else for(var e=0;20>e;e++)this.$matrix[e]=0==e||6==e||12==e||18==e?1:0;for(var r=this.$matrix,i=this.$uniforms.matrix,n=this.$uniforms.colorAdd,e=0,o=0;e<r.length;e++)4===e?n.x=r[e]/255:9===e?n.y=r[e]/255:14===e?n.z=r[e]/255:19===e?n.w=r[e]/255:(i[o]=r[e],o++);this.onPropertyChange()},e.prototype.$toJson=function(){return'{"matrix": ['+this.$matrix.toString()+"]}"},e}(t.Filter);t.ColorMatrixFilter=e,__reflect(e.prototype,"egret.ColorMatrixFilter")}(egret||(egret={}));var egret;!function(t){var e,r={},i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),o=0,a=function(){for(var t=0;36>t;t++)8===t||13===t||18===t||23===t?n[t]="-":14===t?n[t]="4":(2>=o&&(o=33554432+16777216*Math.random()|0),e=15&o,o>>=4,n[t]=i[19===t?3&e|8:e]);return n.join("")},s=function(e){function i(t,i,n){void 0===n&&(n={});var o=e.call(this)||this;o.$padding=0,o.$vertexSrc=t,o.$fragmentSrc=i;var s=t+i;return r[s]||(r[s]=a()),o.$shaderKey=r[s],o.$uniforms=n,o.type="custom",o}return __extends(i,e),Object.defineProperty(i.prototype,"padding",{get:function(){return this.$padding},set:function(t){var e=this;e.$padding!=t&&(e.$padding=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"uniforms",{get:function(){return this.$uniforms},enumerable:!0,configurable:!0}),i.prototype.onPropertyChange=function(){if(t.nativeRender){var e=this;egret_native.NativeDisplayObject.setFilterPadding(e.$id,e.$padding,e.$padding,e.$padding,e.$padding),egret_native.NativeDisplayObject.setDataToFilter(e)}},i}(t.Filter);t.CustomFilter=s,__reflect(s.prototype,"egret.CustomFilter")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,n,o,a,s,c,h,u,l){void 0===t&&(t=4),void 0===r&&(r=45),void 0===i&&(i=0),void 0===n&&(n=1),void 0===o&&(o=4),void 0===a&&(a=4),void 0===s&&(s=1),void 0===c&&(c=1),void 0===h&&(h=!1),void 0===u&&(u=!1),void 0===l&&(l=!1);var p=e.call(this,i,n,o,a,s,c,h,u)||this,d=p;return d.$distance=t,d.$angle=r,d.$hideObject=l,d.$uniforms.dist=t,d.$uniforms.angle=r/180*Math.PI,d.$uniforms.hideObject=l?1:0,d.onPropertyChange(),p}return __extends(r,e),Object.defineProperty(r.prototype,"distance",{get:function(){return this.$distance},set:function(t){var e=this;e.$distance!=t&&(e.$distance=t,e.$uniforms.dist=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"angle",{get:function(){return this.$angle},set:function(t){var e=this;e.$angle!=t&&(e.$angle=t,e.$uniforms.angle=t/180*Math.PI,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hideObject",{get:function(){return this.$hideObject},set:function(t){this.$hideObject!=t&&(this.$hideObject=t,this.$uniforms.hideObject=t?1:0)},enumerable:!0,configurable:!0}),r.prototype.$toJson=function(){return'{"distance": '+this.$distance+', "angle": '+this.$angle+', "color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+', "hideObject": '+this.$hideObject+"}"},r.prototype.updatePadding=function(){var e=this;e.paddingLeft=e.blurX,e.paddingRight=e.blurX,e.paddingTop=e.blurY,e.paddingBottom=e.blurY;var r=e.distance||0,i=e.angle||0,n=0,o=0;0!=r&&(n=r*t.NumberUtils.cos(i),n=n>0?Math.ceil(n):Math.floor(n),o=r*t.NumberUtils.sin(i),o=o>0?Math.ceil(o):Math.floor(o),e.paddingLeft+=n,e.paddingRight+=n,e.paddingTop+=o,e.paddingBottom+=o)},r}(t.GlowFilter);t.DropShadowFilter=e,__reflect(e.prototype,"egret.DropShadowFilter")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LINEAR="linear",t.RADIAL="radial",t}();t.GradientType=e,__reflect(e.prototype,"egret.GradientType")}(egret||(egret={}));var egret;!function(t){function e(t){return t%=2*Math.PI,0>t&&(t+=2*Math.PI),t}function r(t,e){for(var r=[],n=0;e>n;n++){var o=i(t,n/e);o&&r.push(o)}return r}function i(e,r){var i=0,a=0,s=0,c=e.length;if(c/2==3){var h=e[i++],u=e[i++],l=e[i++],p=e[i++],d=e[i++],f=e[i++];a=n(h,l,d,r),s=n(u,p,f,r)}else if(c/2==4){var h=e[i++],u=e[i++],l=e[i++],p=e[i++],d=e[i++],f=e[i++],g=e[i++],v=e[i++];a=o(h,l,d,g,r),s=o(u,p,f,v,r)}return t.Point.create(a,s)}function n(t,e,r,i){var n=Math.pow(1-i,2)*t+2*i*(1-i)*e+Math.pow(i,2)*r;return n}function o(t,e,r,i,n){var o=Math.pow(1-n,3)*t+3*n*Math.pow(1-n,2)*e+3*(1-n)*Math.pow(n,2)*r+Math.pow(n,3)*i;return o}var a=function(i){function n(){var e=i.call(this)||this;return e.lastX=0,e.lastY=0,e.fillPath=null,e.strokePath=null,e.topLeftStrokeWidth=0,e.bottomRightStrokeWidth=0,e.minX=1/0,e.minY=1/0,e.maxX=-(1/0),e.maxY=-(1/0),e.includeLastPosition=!0,e.$renderNode=new t.sys.GraphicsNode,e}return __extends(n,i),n.prototype.$setTarget=function(e){this.$targetDisplay&&(this.$targetDisplay.$renderNode=null),e.$renderNode=this.$renderNode,this.$targetDisplay=e,this.$targetIsSprite=e instanceof t.Sprite},n.prototype.setStrokeWidth=function(t){switch(t){case 1:this.topLeftStrokeWidth=0,this.bottomRightStrokeWidth=1;break;case 3:this.topLeftStrokeWidth=1,this.bottomRightStrokeWidth=2;break;default:var e=0|Math.ceil(.5*t);this.topLeftStrokeWidth=e,this.bottomRightStrokeWidth=e}},n.prototype.beginFill=function(e,r){void 0===r&&(r=1),e=+e||0,r=+r||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setBeginFill(e,r),this.fillPath=this.$renderNode.beginFill(e,r,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},n.prototype.beginGradientFill=function(e,r,i,n,o){void 0===o&&(o=null),t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setBeginGradientFill(e,r,i,n,o),this.fillPath=this.$renderNode.beginGradientFill(e,r,i,n,o,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},n.prototype.endFill=function(){t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setEndFill(),this.fillPath=null},n.prototype.lineStyle=function(e,r,i,n,o,a,s,c,h){void 0===e&&(e=0/0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===o&&(o="normal"),void 0===a&&(a=null),void 0===s&&(s=null),void 0===c&&(c=3),e=+e||0,r=+r||0,i=+i||0,c=+c||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setLineStyle(e,r,i,n,o,a,s,c),0>=e?(this.strokePath=null,this.setStrokeWidth(0)):(this.setStrokeWidth(e),this.strokePath=this.$renderNode.lineStyle(e,r,i,a,s,c,h),this.$renderNode.drawData.length>1&&this.strokePath.moveTo(this.lastX,this.lastY))},n.prototype.drawRect=function(e,r,i,n){e=+e||0,r=+r||0,i=+i||0,n=+n||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawRect(e,r,i,n);var o=this.fillPath,a=this.strokePath;o&&o.drawRect(e,r,i,n),a&&a.drawRect(e,r,i,n),this.extendBoundsByPoint(e+i,r+n),this.updatePosition(e,r),this.dirty()},n.prototype.drawRoundRect=function(e,r,i,n,o,a){e=+e||0,r=+r||0,i=+i||0,n=+n||0,o=+o||0,a=+a||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawRoundRect(e,r,i,n,o,a);var s=this.fillPath,c=this.strokePath;s&&s.drawRoundRect(e,r,i,n,o,a),c&&c.drawRoundRect(e,r,i,n,o,a);var h=.5*o|0,u=a?.5*a|0:h,l=e+i,p=r+n,d=p-u;this.extendBoundsByPoint(e,r),this.extendBoundsByPoint(l,p),this.updatePosition(l,d),this.dirty()},n.prototype.drawCircle=function(e,r,i){e=+e||0,r=+r||0,i=+i||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawCircle(e,r,i);var n=this.fillPath,o=this.strokePath;n&&n.drawCircle(e,r,i),o&&o.drawCircle(e,r,i),this.extendBoundsByPoint(e-i-1,r-i-1),this.extendBoundsByPoint(e+i+2,r+i+2),this.updatePosition(e+i,r),this.dirty()},n.prototype.drawEllipse=function(e,r,i,n){e=+e||0,r=+r||0,i=+i||0,n=+n||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawEllipse(e,r,i,n);var o=this.fillPath,a=this.strokePath;o&&o.drawEllipse(e,r,i,n),a&&a.drawEllipse(e,r,i,n),this.extendBoundsByPoint(e-1,r-1),this.extendBoundsByPoint(e+i+2,r+n+2),this.updatePosition(e+i,r+.5*n),this.dirty()},n.prototype.moveTo=function(e,r){e=+e||0,r=+r||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setMoveTo(e,r);var i=this.fillPath,n=this.strokePath;i&&i.moveTo(e,r),n&&n.moveTo(e,r),this.includeLastPosition=!1,this.lastX=e,this.lastY=r,this.dirty()},n.prototype.lineTo=function(e,r){e=+e||0,r=+r||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setLineTo(e,r);var i=this.fillPath,n=this.strokePath;i&&i.lineTo(e,r),n&&n.lineTo(e,r),this.updatePosition(e,r),this.dirty()},n.prototype.curveTo=function(e,i,n,o){e=+e||0,i=+i||0,n=+n||0,o=+o||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setCurveTo(e,i,n,o);var a=this.fillPath,s=this.strokePath;a&&a.curveTo(e,i,n,o),s&&s.curveTo(e,i,n,o);for(var c=this.lastX||0,h=this.lastY||0,u=r([c,h,e,i,n,o],50),l=0;l<u.length;l++){var p=u[l];this.extendBoundsByPoint(p.x,p.y),t.Point.release(p)}this.extendBoundsByPoint(n,o),this.updatePosition(n,o),this.dirty()},n.prototype.cubicCurveTo=function(e,i,n,o,a,s){e=+e||0,i=+i||0,n=+n||0,o=+o||0,a=+a||0,s=+s||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setCubicCurveTo(e,i,n,o,a,s);var c=this.fillPath,h=this.strokePath;c&&c.cubicCurveTo(e,i,n,o,a,s),h&&h.cubicCurveTo(e,i,n,o,a,s);for(var u=this.lastX||0,l=this.lastY||0,p=r([u,l,e,i,n,o,a,s],50),d=0;d<p.length;d++){var f=p[d];this.extendBoundsByPoint(f.x,f.y),t.Point.release(f)}this.extendBoundsByPoint(a,s),this.updatePosition(a,s),this.dirty()},n.prototype.drawArc=function(r,i,n,o,a,s){if(!(0>n||o===a)){r=+r||0,i=+i||0,n=+n||0,o=+o||0,a=+a||0,s=!!s,o=e(o),a=e(a),t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawArc(r,i,n,o,a,s);var c=this.fillPath,h=this.strokePath;c&&(c.$lastX=this.lastX,c.$lastY=this.lastY,c.drawArc(r,i,n,o,a,s)),h&&(h.$lastX=this.lastX,h.$lastY=this.lastY,h.drawArc(r,i,n,o,a,s)),s?this.arcBounds(r,i,n,a,o):this.arcBounds(r,i,n,o,a);var u=r+Math.cos(a)*n,l=i+Math.sin(a)*n;this.updatePosition(u,l),this.dirty()}},n.prototype.dirty=function(){var e=this;if(e.$renderNode.dirtyRender=!0,!t.nativeRender){var r=e.$targetDisplay;r.$cacheDirty=!0;var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},n.prototype.arcBounds=function(t,e,r,i,n){var o=Math.PI;if(Math.abs(i-n)<.01)return this.extendBoundsByPoint(t-r,e-r),void this.extendBoundsByPoint(t+r,e+r);i>n&&(n+=2*o);for(var a=Math.cos(i)*r,s=Math.cos(n)*r,c=Math.min(a,s),h=Math.max(a,s),u=Math.sin(i)*r,l=Math.sin(n)*r,p=Math.min(u,l),d=Math.max(u,l),f=i/(.5*o),g=n/(.5*o),v=Math.ceil(f);g>=v;v++)switch(v%4){case 0:h=r;break;case 1:d=r;break;case 2:c=-r;break;case 3:p=-r}c=Math.floor(c),p=Math.floor(p),h=Math.ceil(h),d=Math.ceil(d),this.extendBoundsByPoint(c+t,p+e),this.extendBoundsByPoint(h+t,d+e)},n.prototype.clear=function(){t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setGraphicsClear(),this.$renderNode.clear(),this.updatePosition(0,0),this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0),this.dirty()},n.prototype.extendBoundsByPoint=function(t,e){this.extendBoundsByX(t),this.extendBoundsByY(e)},n.prototype.extendBoundsByX=function(t){this.minX=Math.min(this.minX,t-this.topLeftStrokeWidth),this.maxX=Math.max(this.maxX,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},n.prototype.extendBoundsByY=function(t){this.minY=Math.min(this.minY,t-this.topLeftStrokeWidth),this.maxY=Math.max(this.maxY,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},n.prototype.updateNodeBounds=function(){var t=this.$renderNode;t.x=this.minX,t.y=this.minY,t.width=Math.ceil(this.maxX-this.minX),t.height=Math.ceil(this.maxY-this.minY)},n.prototype.updatePosition=function(t,e){this.includeLastPosition||(this.extendBoundsByPoint(this.lastX,this.lastY),this.includeLastPosition=!0),this.lastX=t,this.lastY=e,this.extendBoundsByPoint(t,e)},n.prototype.$measureContentBounds=function(t){this.minX===1/0?t.setEmpty():t.setTo(this.minX,this.minY,this.maxX-this.minX,this.maxY-this.minY)},n.prototype.$hitTest=function(e,r){var i=this.$targetDisplay,n=i.$getInvertedConcatenatedMatrix(),o=n.a*e+n.c*r+n.tx,a=n.b*e+n.d*r+n.ty,s=t.sys.canvasHitTestBuffer;s.resize(3,3);var c=this.$renderNode,h=t.Matrix.create();h.identity(),h.translate(1-o,1-a),t.sys.canvasRenderer.drawNodeToBuffer(c,s,h,!0),t.Matrix.release(h);try{var u=s.getPixels(1,1);if(0===u[3])return null}catch(l){throw new Error(t.sys.tr(1039))}return i},n.prototype.$onRemoveFromStage=function(){this.$renderNode&&this.$renderNode.clean(),t.nativeRender&&egret_native.NativeDisplayObject.disposeGraphicData(this)},n}(t.HashObject);t.Graphics=a,__reflect(a.prototype,"egret.Graphics")}(egret||(egret={}));var egret;!function(t){var e=Math.PI,r=2*e,i=e/180,n=[],o=function(o){function a(t,e,r,i,n,a){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===a&&(a=0);var s=o.call(this)||this;return s.a=t,s.b=e,s.c=r,s.d=i,s.tx=n,s.ty=a,s}return __extends(a,o),a.release=function(t){t&&n.push(t)},a.create=function(){var t=n.pop();return t||(t=new a),t},a.prototype.clone=function(){return new a(this.a,this.b,this.c,this.d,this.tx,this.ty)},a.prototype.concat=function(t){var e=this.a*t.a,r=0,i=0,n=this.d*t.d,o=this.tx*t.a+t.tx,a=this.ty*t.d+t.ty;(0!==this.b||0!==this.c||0!==t.b||0!==t.c)&&(e+=this.b*t.c,n+=this.c*t.b,r+=this.a*t.b+this.b*t.d,i+=this.c*t.a+this.d*t.c,o+=this.ty*t.c,a+=this.tx*t.b),this.a=e,this.b=r,this.c=i,this.d=n,this.tx=o,this.ty=a},a.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},a.prototype.identity=function(){this.a=this.d=1,this.b=this.c=this.tx=this.ty=0},a.prototype.invert=function(){this.$invertInto(this)},a.prototype.$invertInto=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,o=this.tx,a=this.ty;if(0==r&&0==i)return t.b=t.c=0,void(0==e||0==n?t.a=t.d=t.tx=t.ty=0:(e=t.a=1/e,n=t.d=1/n,t.tx=-e*o,t.ty=-n*a));var s=e*n-r*i;if(0==s)return void t.identity();s=1/s;var c=t.a=n*s;r=t.b=-r*s,i=t.c=-i*s,n=t.d=e*s,t.tx=-(c*o+i*a),t.ty=-(r*o+n*a)},a.prototype.rotate=function(e){if(e=+e,0!==e){e/=i;var r=t.NumberUtils.cos(e),n=t.NumberUtils.sin(e),o=this.a,a=this.b,s=this.c,c=this.d,h=this.tx,u=this.ty;this.a=o*r-a*n,this.b=o*n+a*r,this.c=s*r-c*n,this.d=s*n+c*r,this.tx=h*r-u*n,this.ty=h*n+u*r}},a.prototype.scale=function(t,e){1!==t&&(this.a*=t,this.c*=t,this.tx*=t),1!==e&&(this.b*=e,this.d*=e,this.ty*=e)},a.prototype.setTo=function(t,e,r,i,n,o){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=o,this},a.prototype.transformPoint=function(e,r,i){var n=this.a*e+this.c*r+this.tx,o=this.b*e+this.d*r+this.ty;return i?(i.setTo(n,o),i):new t.Point(n,o)},a.prototype.translate=function(t,e){this.tx+=t,this.ty+=e},a.prototype.equals=function(t){return this.a==t.a&&this.b==t.b&&this.c==t.c&&this.d==t.d&&this.tx==t.tx&&this.ty==t.ty},a.prototype.prepend=function(t,e,r,i,n,o){var a=this.tx;if(1!=t||0!=e||0!=r||1!=i){var s=this.a,c=this.c;this.a=s*t+this.b*r,this.b=s*e+this.b*i,this.c=c*t+this.d*r,this.d=c*e+this.d*i}return this.tx=a*t+this.ty*r+n,this.ty=a*e+this.ty*i+o,this},a.prototype.append=function(t,e,r,i,n,o){var a=this.a,s=this.b,c=this.c,h=this.d;return(1!=t||0!=e||0!=r||1!=i)&&(this.a=t*a+e*c,this.b=t*s+e*h,this.c=r*a+i*c,this.d=r*s+i*h),this.tx=n*a+o*c+this.tx,this.ty=n*s+o*h+this.ty,this},a.prototype.deltaTransformPoint=function(e){var r=this,i=r.a*e.x+r.c*e.y,n=r.b*e.x+r.d*e.y;return new t.Point(i,n)},a.prototype.toString=function(){return"(a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"},a.prototype.createBox=function(e,r,n,o,a){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0);var s=this;if(0!==n){n/=i;var c=t.NumberUtils.cos(n),h=t.NumberUtils.sin(n);s.a=c*e,s.b=h*r,s.c=-h*e,s.d=c*r}else s.a=e,s.b=0,s.c=0,s.d=r;s.tx=o,s.ty=a},a.prototype.createGradientBox=function(t,e,r,i,n){void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=0),this.createBox(t/1638.4,e/1638.4,r,i+t/2,n+e/2)},a.prototype.$transformBounds=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,o=this.tx,a=this.ty,s=t.x,c=t.y,h=s+t.width,u=c+t.height,l=e*s+i*c+o,p=r*s+n*c+a,d=e*h+i*c+o,f=r*h+n*c+a,g=e*h+i*u+o,v=r*h+n*u+a,y=e*s+i*u+o,m=r*s+n*u+a,$=0;l>d&&($=l,l=d,d=$),g>y&&($=g,g=y,y=$),t.x=Math.floor(g>l?l:g),t.width=Math.ceil((d>y?d:y)-t.x),p>f&&($=p,p=f,f=$),v>m&&($=v,v=m,m=$),t.y=Math.floor(v>p?p:v),t.height=Math.ceil((f>m?f:m)-t.y)},a.prototype.getDeterminant=function(){return this.a*this.d-this.b*this.c},a.prototype.$getScaleX=function(){var t=this;if(0==t.b)return t.a;var e=Math.sqrt(t.a*t.a+t.b*t.b);return this.getDeterminant()<0?-e:e},a.prototype.$getScaleY=function(){var t=this;if(0==t.c)return t.d;var e=Math.sqrt(t.c*t.c+t.d*t.d);return this.getDeterminant()<0?-e:e},a.prototype.$getSkewX=function(){return this.d<0?Math.atan2(this.d,this.c)+e/2:Math.atan2(this.d,this.c)-e/2},a.prototype.$getSkewY=function(){return this.a<0?Math.atan2(this.b,this.a)-e:Math.atan2(this.b,this.a)},a.prototype.$updateScaleAndRotation=function(e,n,o,a){if(!(0!=o&&o!=r||0!=a&&a!=r))return this.a=e,this.b=this.c=0,void(this.d=n);o/=i,a/=i;var s=t.NumberUtils.cos(o),c=t.NumberUtils.sin(o);o==a?(this.a=s*e,this.b=c*e):(this.a=t.NumberUtils.cos(a)*e,this.b=t.NumberUtils.sin(a)*e),this.c=-c*n,this.d=s*n},a.prototype.$preMultiplyInto=function(t,e){var r=t.a*this.a,i=0,n=0,o=t.d*this.d,a=t.tx*this.a+this.tx,s=t.ty*this.d+this.ty;(0!==t.b||0!==t.c||0!==this.b||0!==this.c)&&(r+=t.b*this.c,o+=t.c*this.b,i+=t.a*this.b+t.b*this.d,n+=t.c*this.a+t.d*this.c,a+=t.ty*this.c,s+=t.tx*this.b),e.a=r,e.b=i,e.c=n,e.d=o,e.tx=a,e.ty=s},a}(t.HashObject);t.Matrix=o,__reflect(o.prototype,"egret.Matrix"),t.$TempMatrix=new o}(egret||(egret={}));var egret;!function(t){var e=[],r=function(r){function i(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var o=r.call(this)||this;return o.x=t,o.y=e,o.width=i,o.height=n,o}return __extends(i,r),i.release=function(t){t&&e.push(t)},i.create=function(){var t=e.pop();return t||(t=new i),t},Object.defineProperty(i.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"topLeft",{get:function(){return new t.Point(this.left,this.top)},set:function(t){this.top=t.y,this.left=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottomRight",{get:function(){return new t.Point(this.right,this.bottom)},set:function(t){this.bottom=t.y,this.right=t.x},enumerable:!0,configurable:!0}),i.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},i.prototype.setTo=function(t,e,r,i){return this.x=t,this.y=e,this.width=r,this.height=i,this},i.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e},i.prototype.intersection=function(t){return this.clone().$intersectInPlace(t)},i.prototype.inflate=function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},i.prototype.$intersectInPlace=function(t){var e=this.x,r=this.y,i=t.x,n=t.y,o=Math.max(e,i),a=Math.min(e+this.width,i+t.width);if(a>=o){var s=Math.max(r,n),c=Math.min(r+this.height,n+t.height);if(c>=s)return this.setTo(o,s,a-o,c-s),this}return this.setEmpty(),this},i.prototype.intersects=function(t){return Math.max(this.x,t.x)<=Math.min(this.right,t.right)&&Math.max(this.y,t.y)<=Math.min(this.bottom,t.bottom)},i.prototype.isEmpty=function(){return this.width<=0||this.height<=0},i.prototype.setEmpty=function(){this.x=0,this.y=0,this.width=0,this.height=0},i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height)},i.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>t.x&&this.y<=t.y&&this.y+this.height>t.y?!0:!1},i.prototype.containsRect=function(t){var e=t.x+t.width,r=t.y+t.height,i=this.x+this.width,n=this.y+this.height;return t.x>=this.x&&t.x<i&&t.y>=this.y&&t.y<n&&e>this.x&&i>=e&&r>this.y&&n>=r},i.prototype.equals=function(t){return this===t?!0:this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},i.prototype.inflatePoint=function(t){this.inflate(t.x,t.y)},i.prototype.offset=function(t,e){this.x+=t,this.y+=e},i.prototype.offsetPoint=function(t){this.offset(t.x,t.y)},i.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},i.prototype.union=function(t){var e=this.clone();if(t.isEmpty())return e;if(e.isEmpty())return e.copyFrom(t),e;var r=Math.min(e.x,t.x),i=Math.min(e.y,t.y);return e.setTo(r,i,Math.max(e.right,t.right)-r,Math.max(e.bottom,t.bottom)-i),e},i.prototype.$getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t));return e*this.width+r*this.height},i.prototype.$getBaseHeight=function(t){var e=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t));return r*this.width+e*this.height},i}(t.HashObject);t.Rectangle=r,__reflect(r.prototype,"egret.Rectangle"),t.$TempRectangle=new r}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.en_US=t.$locale_strings.en_US||{};var e=t.$locale_strings.en_US;e[1001]="Could not find Egret entry class: {0}",e[1002]="Egret entry class '{0}' must inherit from egret.DisplayObject.",e[1003]="Parameter {0} must be non-null.",e[1004]="An object cannot be added as a child to one of it's children (or children's children, etc.).",e[1005]="An object cannot be added as a child of itself.",e[1006]="The supplied DisplayObject must be a child of the caller.",e[1007]="An index specified for a parameter was out of range.",e[1008]="Instantiate singleton errorsingleton class {0} can not create multiple instances.",e[1009]='the Class {0} cannot use the property "{1}"',e[1010]='the property "{1}" of the Class "{0}" is readonly',e[1011]="Stream Error. URL: {0}",e[1012]="The type of parameter {0} must be Class.",e[1013]="Variable assignment is NaN, please see the code!",e[1014]='the constant "{1}" of the Class "{0}" is read-only',e[1015]="xml not found!",e[1016]="{0}has been obsoleted",e[1017]="The format of JSON file is incorrect: {0}\ndata: {1}",e[1018]="the scale9Grid is not correct",e[1019]="Network ab:{0}",e[1020]="Cannot initialize Shader",e[1021]="Current browser does not support webgl",e[1022]="{0} ArgumentError",e[1023]="This method is not available in the ScrollView!",e[1025]="end of the file",e[1026]="! EncodingError The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]=". called injection is not configured rule: {0}, please specify configuration during its initial years of injection rule, and then call the corresponding single case.",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="Photos can not be used across domains toDataURL to convert base64",e[1034]='Music file decoding failed: "{0}", please use the standard conversion tool reconversion under mp3.',e[1035]="Native does not support this feature!",e[1036]="Sound has stopped, please recall Sound.play () to play the sound!",e[1037]="Non-load the correct blob!",e[1038]="XML format error!",e[1039]="Cross domains pictures can not get pixel information!",e[1040]="hitTestPoint can not detect crossOrigin images! Please check if the display object has crossOrigin elements.",e[1041]="{0} is deprecated, please use {1} replace",e[1042]="The parameters passed in the region needs is an integer in drawToTexture method. Otherwise, some browsers will draw abnormal.",e[1043]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",e[1044]="The current version of the Runtime does not support video playback, please use the latest version",e[1045]="The resource url is not found",e[1046]="BitmapText no corresponding characters: {0}, please check the configuration file",e[1047]="egret.localStorage.setItem save failed,key={0}&value={1}",e[1048]="Video loading failed",e[1049]="In the absence of sound is not allowed to play after loading",e[1050]="ExternalInterface calls the method without js registration: {0}",e[1051]="runtime only support webgl render mode",e[1052]="network request timeout{0}",e[3e3]="Theme configuration file failed to load: {0}",e[3001]="Cannot find the skin name which is configured in Theme: {0}",e[3002]='Index:"{0}" is out of the collection element index range',e[3003]="Cannot be available in this component. If this component is container, please continue to use",e[3004]="addChild(){0}addElement() replace",e[3005]="addChildAt(){0}addElementAt() replace",e[3006]="removeChild(){0}removeElement() replace",e[3007]="removeChildAt(){0}removeElementAt() replace",e[3008]="setChildIndex(){0}setElementIndex() replace",e[3009]="swapChildren(){0}swapElements() replace",e[3010]="swapChildrenAt(){0}swapElementsAt() replace",e[3011]='Index:"{0}" is out of the visual element index range',e[3012]="This method is not available in Scroller component!",e[3013]="UIStage is GUI root container, and only one such instant is in the display list",e[3014]="set fullscreen error",e[3100]="Current browser does not support WebSocket",e[3101]="Please connect Socket firstly",e[3102]="Please set the type of binary type",e[3200]="getResByUrl must be called after loadConfig",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!",e[4500]="The platform does not support {0} adapter mode and has been automatically replaced with {1} mode, please modify your code adapter logic"}(egret||(egret={}));var egret;!function(t){t.JointStyle={BEVEL:"bevel",MITER:"miter",ROUND:"round"}}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.zh_CN=t.$locale_strings.zh_CN||{};var e=t.$locale_strings.zh_CN;e[1001]="Egret: {0}",e[1002]="Egret {0} egret.DisplayObject",e[1003]=" {0}  null",e[1004]="",e[1005]="",e[1006]=" DisplayObject ",e[1007]="",e[1008]=" {0} ",e[1009]=" {0}  {1}",e[1010]=" {0}  {1} ",e[1011]="URL: {0}",e[1012]=" {0}  Class",e[1013]="NaN",e[1014]=" {0}  {1} ",e[1015]="xml not found!",e[1016]="{0}",e[1017]="JSON: {0}\ndata: {1}",e[1018]="9",e[1019]=":{0}",e[1020]="",e[1021]="webgl",e[1022]="{0} ArgumentError",e[1023]="ScrollView!",e[1025]="",e[1026]="EncodingError! The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]=":{0} ",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="toDataURLbase64",e[1034]='"{0}"mp3',e[1035]="Native ",e[1036]=" Sound.play() ",e[1037]="blob",e[1038]="XML !",e[1039]="!",e[1040]="hitTestPoint ! ",e[1041]="{0} , {1} ",e[1042]="drawToTexture,",e[1043]="{0}  : {1} : {2}",e[1044]=" runtime ,",e[1045]="",e[1046]="BitmapText :{0}",e[1047]="egret.localStorage.setItem,key={0}&value={1}",e[1048]="",e[1049]="",e[1050]="ExternalInterfacejs: {0}",e[1051]="runtime  webgl ",e[1052]=":{0}",e[3e3]=": {0}",e[3001]=": {0}",e[3002]=':"{0}"',e[3003]="",e[3004]="addChild(){0}addElement()",e[3005]="addChildAt(){0}addElementAt()",e[3006]="removeChild(){0}removeElement()",e[3007]="removeChildAt(){0}removeElementAt()",e[3008]="setChildIndex(){0}setElementIndex()",e[3009]="swapChildren(){0}swapElements()",e[3010]="swapChildrenAt(){0}swapElementsAt()",e[3011]=':"{0}"',e[3012]="Scroller!",e[3013]="UIStageGUI",e[3014]="",e[3100]="WebSocket",e[3101]="WebSocket",e[3102]="type",e[3200]="getResByUrl  loadConfig ",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!",e[4500]=" {0}  {1} "
}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t){i.indexOf(t)<0&&i.push(t)}function r(t){var e=i.indexOf(t);return e>=0?(i.splice(e,1),!0):!1}var i=[];t.$pushSoundChannel=e,t.$popSoundChannel=r}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(t){t.GET="GET",t.POST="POST"}(e=t.HttpMethod||(t.HttpMethod={}))}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.ARRAY_BUFFER="arraybuffer",t}();t.HttpResponseType=e,__reflect(e.prototype,"egret.HttpResponseType")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(i){var n=r.call(this)||this;return n.isStage=!1,n.$renderNode=new e.BitmapNode,n.renderBuffer=null,n.offsetX=0,n.offsetY=0,n.offsetMatrix=new t.Matrix,n.$canvasScaleX=1,n.$canvasScaleY=1,n.root=i,n.isStage=i instanceof t.Stage,n}return __extends(i,r),i.create=function(r){var i=new t.sys.DisplayList(r);try{var n=new e.RenderBuffer;i.renderBuffer=n}catch(o){return null}return i.root=r,i},i.prototype.$getRenderNode=function(){return this.$renderNode},i.prototype.setClipRect=function(t,e){t*=i.$canvasScaleX,e*=i.$canvasScaleY,this.renderBuffer.resize(t,e)},i.prototype.drawToSurface=function(){var r=0;this.$canvasScaleX=this.offsetMatrix.a=i.$canvasScaleX,this.$canvasScaleY=this.offsetMatrix.d=i.$canvasScaleY,this.isStage||this.changeSurfaceSize();var n=this.renderBuffer;if(n.clear(),r=e.systemRenderer.render(this.root,n,this.offsetMatrix),!this.isStage){var o=n.surface,a=this.$renderNode;a.drawData.length=0;var s=o.width,c=o.height;this.bitmapData?(this.bitmapData.source=o,this.bitmapData.width=s,this.bitmapData.height=c):this.bitmapData=new t.BitmapData(o),a.image=this.bitmapData,a.imageWidth=s,a.imageHeight=c,a.drawImage(0,0,s,c,-this.offsetX,-this.offsetY,s/this.$canvasScaleX,c/this.$canvasScaleY)}return r},i.prototype.changeSurfaceSize=function(){var t=(this.root,this.offsetX),e=this.offsetY,r=this.root.$getOriginalBounds(),i=this.$canvasScaleX,n=this.$canvasScaleY;this.offsetX=-r.x,this.offsetY=-r.y,this.offsetMatrix.setTo(this.offsetMatrix.a,0,0,this.offsetMatrix.d,this.offsetX,this.offsetY);var o=this.renderBuffer,a=Math.max(257,r.width*i),s=Math.max(257,r.height*n);(this.offsetX!=t||this.offsetY!=e||o.surface.width!=a||o.surface.height!=s)&&o.resize(a,s)},i.$setCanvasScale=function(e,r){i.$canvasScaleX=e,i.$canvasScaleY=r,t.nativeRender&&egret_native.nrSetCanvasScaleFactor(i.$canvasScaleFactor,e,r)},i.$canvasScaleFactor=1,i.$canvasScaleX=1,i.$canvasScaleY=1,i}(t.HashObject);e.DisplayList=r,__reflect(r.prototype,"egret.sys.DisplayList")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}var i=function(i){function c(e,r,n){var o=i.call(this)||this;return o.isPlaying=!1,o.entryClassName=n,o.stage=r,o.screenDisplayList=o.createDisplayList(r,e),o.showFPS=!1,o.showLog=!1,o.stageDisplayList=null,t.nativeRender&&(egret_native.rootWebGLBuffer=e),o}return __extends(c,i),c.prototype.createDisplayList=function(t,r){var i=new e.DisplayList(t);return i.renderBuffer=r,t.$displayList=i,i},c.prototype.start=function(){!this.isPlaying&&this.stage&&(e.$TempStage=e.$TempStage||this.stage,this.isPlaying=!0,this.root||this.initialize(),t.ticker.$addPlayer(this))},c.prototype.initialize=function(){var e;if(this.entryClassName&&(e=t.getDefinitionByName(this.entryClassName)),e){var r=new e;this.root=r,r instanceof t.DisplayObject&&this.stage.addChild(r)}},c.prototype.stop=function(){this.pause(),this.stage=null},c.prototype.pause=function(){this.isPlaying&&(this.isPlaying=!1,t.ticker.$removePlayer(this))},c.prototype.$render=function(e,r){if(t.nativeRender)return egret_native.updateNativeRender(),void egret_native.nrRender();var i=this.stage,o=t.getTimer(),a=i.$displayList.drawToSurface(),s=t.getTimer();e&&this.showFPS&&n.update(a,s-o,r)},c.prototype.updateStageSize=function(e,r){var i=this.stage;i.$stageWidth=e,i.$stageHeight=r,t.nativeRender?egret_native.nrResize(e,r):(this.screenDisplayList.setClipRect(e,r),this.stageDisplayList&&this.stageDisplayList.setClipRect(e,r)),i.dispatchEventWith(t.Event.RESIZE)},c.prototype.displayFPS=function(i,c,h,u){if(c=!!c,c&&(t.log=function(){for(var t=arguments.length,i="",n=0;t>n;n++)i+=arguments[n]+" ";e.$logToFPS(i),console.log.apply(console,r(arguments))},t.warn=function(){for(var t=arguments.length,i="",n=0;t>n;n++)i+=arguments[n]+" ";e.$warnToFPS(i),console.warn.apply(console,r(arguments))},t.error=function(){for(var t=arguments.length,i="",n=0;t>n;n++)i+=arguments[n]+" ";e.$errorToFPS(i),console.error.apply(console,r(arguments))}),this.showFPS=!!i,this.showLog=c,!n){n=new FPS(this.stage,i,c,h,u);for(var l=o.length,p=0;l>p;p++)n.updateInfo(o[p]);o=null;for(var d=a.length,p=0;d>p;p++)n.updateWarn(a[p]);a=null;for(var f=s.length,p=0;f>p;p++)n.updateError(s[p]);s=null}},c}(t.HashObject);e.Player=i,__reflect(i.prototype,"egret.sys.Player");var n,o=[],a=[],s=[];e.$logToFPS=function(t){return n?void n.updateInfo(t):void o.push(t)},e.$warnToFPS=function(t){return n?void n.updateWarn(t):void a.push(t)},e.$errorToFPS=function(t){return n?void n.updateError(t):void s.push(t)};var c=function(){function e(e,r,i,n,o){this.showFPS=r,this.showLog=i,this.logFilter=n,this.styles=o,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.costRender=0,this.costTicker=0,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.costRender=0,this.costTicker=0,this._stage=e,this.showFPS=r,this.showLog=i,this.logFilter=n,this.styles=o,this.fpsDisplay=new t.FPSDisplay(e,r,i,n,o);var a;try{a=n?new RegExp(n):null}catch(s){t.log(s)}this.filter=function(t){return a?a.test(t):!n||0==t.indexOf(n)}}return e.prototype.update=function(e,r,i){var n=t.getTimer();if(this.totalTime+=n-this.lastTime,this.lastTime=n,this.totalTick++,this.drawCalls+=e,this.costRender+=r,this.costTicker+=i,this.totalTime>=1e3){var o=Math.min(Math.ceil(1e3*this.totalTick/this.totalTime),t.ticker.$frameRate),a=Math.round(this.drawCalls/this.totalTick),s=Math.round(this.costRender/this.totalTick),c=Math.round(this.costTicker/this.totalTick);this.fpsDisplay.update({fps:o,draw:a,costTicker:c,costRender:s}),this.totalTick=0,this.totalTime=this.totalTime%1e3,this.drawCalls=0,this.costRender=0,this.costTicker=0}},e.prototype.updateInfo=function(t){t&&this.showLog&&this.filter(t)&&this.fpsDisplay.updateInfo(t)},e.prototype.updateWarn=function(t){t&&this.showLog&&this.filter(t)&&(this.fpsDisplay.updateWarn?this.fpsDisplay.updateWarn(t):this.fpsDisplay.updateInfo("[Warning]"+t))},e.prototype.updateError=function(t){t&&this.showLog&&this.filter(t)&&(this.fpsDisplay.updateError?this.fpsDisplay.updateError(t):this.fpsDisplay.updateInfo("[Error]"+t))},e}();__reflect(c.prototype,"FPSImpl"),__global.FPS=c,t.warn=function(){console.warn.apply(console,r(arguments))},t.error=function(){console.error.apply(console,r(arguments))},t.assert=function(){console.assert.apply(console,r(arguments))},t.log=function(){console.log.apply(console,r(arguments))}}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){if(t.nativeRender=__global.nativeRender,t.nativeRender){var e=egret_native.nrABIVersion,r=egret_native.nrMinEgretVersion,i=5;if(i>e){t.nativeRender=!1;var n=" 0.1.14 ";t.sys.$warnToFPS(n),t.warn(n)}else if(e>i){t.nativeRender=!1;var n=" "+r+" ";t.sys.$warnToFPS(n),t.warn(n)}}}(egret||(egret={}));var egret;!function(t){var e=function(){function e(t,r,i,n){this.arrayBuffer=t,this.isInvalid=!1;var o=new Uint8Array(this.arrayBuffer,0,12);if(171!==o[0]||75!==o[1]||84!==o[2]||88!==o[3]||32!==o[4]||49!==o[5]||49!==o[6]||187!==o[7]||13!==o[8]||10!==o[9]||26!==o[10]||10!==o[11])return this.isInvalid=!0,void console.error("texture missing KTX identifier");var a=Uint32Array.BYTES_PER_ELEMENT,s=new DataView(this.arrayBuffer,12,13*a),c=s.getUint32(0,!0),h=67305985===c;return this.glType=s.getUint32(1*a,h),this.glTypeSize=s.getUint32(2*a,h),this.glFormat=s.getUint32(3*a,h),this.glInternalFormat=s.getUint32(4*a,h),this.glBaseInternalFormat=s.getUint32(5*a,h),this.pixelWidth=s.getUint32(6*a,h),this.pixelHeight=s.getUint32(7*a,h),this.pixelDepth=s.getUint32(8*a,h),this.numberOfArrayElements=s.getUint32(9*a,h),this.numberOfFaces=s.getUint32(10*a,h),this.numberOfMipmapLevels=s.getUint32(11*a,h),this.bytesOfKeyValueData=s.getUint32(12*a,h),0!==this.glType?void console.error("only compressed formats currently supported"):(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0===this.pixelHeight||0!==this.pixelDepth?void console.error("only 2D textures currently supported"):0!==this.numberOfArrayElements?void console.error("texture arrays not currently supported"):this.numberOfFaces!==r?void console.error("number of faces expected"+r+", but found "+this.numberOfFaces):void(this.loadType=e.COMPRESSED_2D))}return e.prototype.uploadLevels=function(t,r){this.loadType===e.COMPRESSED_2D&&this._upload2DCompressedLevels(t,r)},e.prototype._upload2DCompressedLevels=function(r,i){r.clearCompressedTextureData();for(var n=r.compressedTextureData,o=e.HEADER_LEN+this.bytesOfKeyValueData,a=this.pixelWidth,s=this.pixelHeight,c=i?this.numberOfMipmapLevels:1,h=0;c>h;h++){var u=new Int32Array(this.arrayBuffer,o,1)[0];o+=4;for(var l=[],p=0;p<this.numberOfFaces;p++){var d=new Uint8Array(this.arrayBuffer,o,u),f=new t.CompressedTextureData;f.glInternalFormat=this.glInternalFormat,f.width=a,f.height=s,f.byteArray=d,f.face=p,f.level=h,l.push(f),o+=u,o+=3-(u+3)%4}n.push(l),a=Math.max(1,.5*a),s=Math.max(1,.5*s)}var g=r.getCompressed2dTextureData();g&&(r.width=g.width,r.height=g.height)},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}();t.KTXContainer=e,__reflect(e.prototype,"egret.KTXContainer")}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){return e.call(this)||this}return __extends(r,e),r.prototype.calculateStageSize=function(e,r,i,n,o){var a=r,s=i,c=n,h=o,u=r/c||0,l=i/h||0;switch(e){case t.StageScaleMode.EXACT_FIT:break;case t.StageScaleMode.FIXED_HEIGHT:c=Math.round(r/l);break;case t.StageScaleMode.FIXED_WIDTH:h=Math.round(i/u);break;case t.StageScaleMode.NO_BORDER:u>l?s=Math.round(h*u):a=Math.round(c*l);break;case t.StageScaleMode.SHOW_ALL:u>l?a=Math.round(c*l):s=Math.round(h*u);break;case t.StageScaleMode.FIXED_NARROW:u>l?c=Math.round(r/l):h=Math.round(i/u);break;case t.StageScaleMode.FIXED_WIDE:u>l?h=Math.round(i/u):c=Math.round(r/l);break;default:c=r,h=i}return t.Capabilities.runtimeType!=t.RuntimeType.WXGAME&&(c%2!=0&&(c+=1),h%2!=0&&(h+=1),a%2!=0&&(a+=1),s%2!=0&&(s+=1)),{stageWidth:c,stageHeight:h,displayWidth:a,displayHeight:s}},r}(t.HashObject);e.DefaultScreenAdapter=r,__reflect(r.prototype,"egret.sys.DefaultScreenAdapter",["egret.sys.IScreenAdapter"])}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NO_SCALE="noScale",t.SHOW_ALL="showAll",t.NO_BORDER="noBorder",t.EXACT_FIT="exactFit",t.FIXED_WIDTH="fixedWidth",t.FIXED_HEIGHT="fixedHeight",t.FIXED_NARROW="fixedNarrow",t.FIXED_WIDE="fixedWide",t}();t.StageScaleMode=e,__reflect(e.prototype,"egret.StageScaleMode")}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e){return console.error("empty sys.mainCanvas = "+t+", "+e),null}function r(t,e){return console.error("empty sys.createCanvas = "+t+", "+e),null}function i(t,e,r,i){console.error("empty sys.resizeContext = "+t+", "+e+", "+r+", "+i)}function n(t){return console.error("empty sys.getContextWebGL = "+t),null}function o(t){return console.error("empty sys.getContext2d = "+t),null}function a(t,e){return console.error("empty sys.createTexture = "+e),null}function s(t,e,r,i){return console.error("empty sys._createTexture = "+e+", "+r+", "+i),null}function c(t,e,r){return console.error("empty sys.drawTextureElements = "+t+", "+e+", "+r),0}function h(t,e){return console.error("empty sys.measureTextWith = "+t+", "+e),0}function u(t,e,r,i){return console.error("empty sys.createCanvasRenderBufferSurface = "+e+", "+r),null}function l(t,e,r,i){console.error("empty sys.resizeContext = "+t+", "+e+", "+r+", "+i)}t.mainCanvas=e,t.createCanvas=r,t.resizeContext=i,t.getContextWebGL=n,t.getContext2d=o,t.createTexture=a,t._createTexture=s,t.drawTextureElements=c,t.measureTextWith=h,t.createCanvasRenderBufferSurface=u,t.resizeCanvasRenderBuffer=l}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){e.$START_TIME=0,e.$invalidateRenderFlag=!1,e.$requestRenderingFlag=!1;var r=function(){function r(){this.playerList=[],this.callBackList=[],this.thisObjectList=[],this.$frameRate=30,this.lastTimeStamp=0,this.costEnterFrame=0,this.isPaused=!1,e.$START_TIME=Date.now(),this.frameDeltaTime=1e3/this.$frameRate,this.lastCount=this.frameInterval=Math.round(6e4/this.$frameRate)}return r.prototype.$addPlayer=function(t){-1==this.playerList.indexOf(t)&&(this.playerList=this.playerList.concat(),this.playerList.push(t))},r.prototype.$removePlayer=function(t){var e=this.playerList.indexOf(t);-1!==e&&(this.playerList=this.playerList.concat(),this.playerList.splice(e,1))},r.prototype.$startTick=function(t,e){var r=this.getTickIndex(t,e);-1==r&&(this.concatTick(),this.callBackList.push(t),this.thisObjectList.push(e))},r.prototype.$stopTick=function(t,e){var r=this.getTickIndex(t,e);-1!=r&&(this.concatTick(),this.callBackList.splice(r,1),this.thisObjectList.splice(r,1))},r.prototype.getTickIndex=function(t,e){for(var r=this.callBackList,i=this.thisObjectList,n=r.length-1;n>=0;n--)if(r[n]==t&&i[n]==e)return n;return-1},r.prototype.concatTick=function(){this.callBackList=this.callBackList.concat(),this.thisObjectList=this.thisObjectList.concat()},r.prototype.$setFrameRate=function(t){return 0>=t?!1:this.$frameRate==t?!1:(this.$frameRate=t,t>60&&(t=60),this.frameDeltaTime=1e3/t,this.lastCount=this.frameInterval=Math.round(6e4/t),!0)},r.prototype.pause=function(){this.isPaused=!0},r.prototype.resume=function(){this.isPaused=!1},r.prototype.update=function(r){for(var i=t.getTimer(),n=this.callBackList,o=this.thisObjectList,a=n.length,s=e.$requestRenderingFlag,c=t.getTimer(),h=t.lifecycle.contexts,u=0,l=h;u<l.length;u++){var p=l[u];p.onUpdate&&p.onUpdate()}if(this.isPaused)return void(this.lastTimeStamp=c);this.callLaterAsyncs();for(var d=0;a>d;d++)n[d].call(o[d],c)&&(s=!0);var f=t.getTimer(),g=c-this.lastTimeStamp;if(this.lastTimeStamp=c,g>=this.frameDeltaTime||r)this.lastCount=this.frameInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return void(s&&this.render(!1,this.costEnterFrame+f-i));this.lastCount+=this.frameInterval}this.render(!0,this.costEnterFrame+f-i);var v=t.getTimer();this.broadcastEnterFrame();var y=t.getTimer();this.costEnterFrame=y-v},r.prototype.render=function(t,r){var i=this.playerList,n=i.length;if(0!=n){this.callLaters(),e.$invalidateRenderFlag&&(this.broadcastRender(),e.$invalidateRenderFlag=!1);for(var o=0;n>o;o++)i[o].$render(t,r);e.$requestRenderingFlag=!1}},r.prototype.broadcastEnterFrame=function(){var e=t.DisplayObject.$enterFrameCallBackList,r=e.length;if(0!=r){e=e.concat();for(var i=0;r>i;i++)e[i].dispatchEventWith(t.Event.ENTER_FRAME)}},r.prototype.broadcastRender=function(){var e=t.DisplayObject.$renderCallBackList,r=e.length;if(0!=r){e=e.concat();for(var i=0;r>i;i++)e[i].dispatchEventWith(t.Event.RENDER)}},r.prototype.callLaters=function(){var e,r,i;if(t.$callLaterFunctionList.length>0&&(e=t.$callLaterFunctionList,t.$callLaterFunctionList=[],r=t.$callLaterThisList,t.$callLaterThisList=[],i=t.$callLaterArgsList,t.$callLaterArgsList=[]),e)for(var n=e.length,o=0;n>o;o++){var a=e[o];null!=a&&a.apply(r[o],i[o])}},r.prototype.callLaterAsyncs=function(){if(t.$callAsyncFunctionList.length>0){var e=t.$callAsyncFunctionList,r=t.$callAsyncThisList,i=t.$callAsyncArgsList;t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[];for(var n=0;n<e.length;n++){var o=e[n];null!=o&&o.apply(r[n],i[n])}}},r}();e.SystemTicker=r,__reflect(r.prototype,"egret.sys.SystemTicker")}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){var e;!function(e){function r(t){var r=new n;e.contexts.push(r),t(r)}e.contexts=[];var i=!0,n=function(){function r(){}return r.prototype.pause=function(){i&&(i=!1,e.stage.dispatchEvent(new t.Event(t.Event.DEACTIVATE)),e.onPause&&e.onPause())},r.prototype.resume=function(){i||(i=!0,e.stage.dispatchEvent(new t.Event(t.Event.ACTIVATE)),e.onResume&&e.onResume())},r}();e.LifecycleContext=n,__reflect(n.prototype,"egret.lifecycle.LifecycleContext"),e.addLifecycleListener=r}(e=t.lifecycle||(t.lifecycle={})),t.ticker=new t.sys.SystemTicker}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(t){var r=e.call(this)||this;return r.maxTouches=0,r.useTouchesCount=0,r.touchDownTarget={},r.lastTouchX=-1,r.lastTouchY=-1,r.stage=t,r}return __extends(r,e),r.prototype.$initMaxTouches=function(){this.maxTouches=this.stage.$maxTouches},r.prototype.onTouchBegin=function(e,r,i){if(!(this.useTouchesCount>=this.maxTouches)){this.lastTouchX=e,this.lastTouchY=r;var n=this.findTarget(e,r);null==this.touchDownTarget[i]&&(this.touchDownTarget[i]=n,this.useTouchesCount++),t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_BEGIN,!0,!0,e,r,i,!0)}},r.prototype.onTouchMove=function(e,r,i){if(null!=this.touchDownTarget[i]&&(this.lastTouchX!=e||this.lastTouchY!=r)){this.lastTouchX=e,this.lastTouchY=r;var n=this.findTarget(e,r);t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_MOVE,!0,!0,e,r,i,!0)}},r.prototype.onTouchEnd=function(e,r,i){if(null!=this.touchDownTarget[i]){var n=this.findTarget(e,r),o=this.touchDownTarget[i];delete this.touchDownTarget[i],this.useTouchesCount--,t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_END,!0,!0,e,r,i,!1),o==n?t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_TAP,!0,!0,e,r,i,!1):t.TouchEvent.dispatchTouchEvent(o,t.TouchEvent.TOUCH_RELEASE_OUTSIDE,!0,!0,e,r,i,!1)}},r.prototype.findTarget=function(t,e){var r=this.stage.$hitTest(t,e);return r||(r=this.stage),r},r}(t.HashObject);e.TouchHandler=r,__reflect(r.prototype,"egret.sys.TouchHandler")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t.image=null,t.smoothing=!0,t.blendMode=null,t.alpha=0/0,t.filter=null,t.rotated=!1,t.type=1,t}return __extends(r,e),r.prototype.drawImage=function(t,e,r,i,n,o,a,s){this.drawData.push(t,e,r,i,n,o,a,s),this.renderCount++},r.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null,this.blendMode=null,this.alpha=0/0,this.filter=null},r.$updateTextureData=function(e,i,n,o,a,s,c,h,u,l,p,d,f,g,v,y){if(i){var m=t.$TextureScaleFactor;if(e.smoothing=y,e.image=i,e.imageWidth=f,e.imageHeight=g,v==t.BitmapFillMode.SCALE){var $=p/u*m,b=d/l*m;e.drawImage(n,o,a,s,$*c,b*h,$*a,b*s)}else if(v==t.BitmapFillMode.CLIP){var _=Math.min(u,p),x=Math.min(l,d),T=a*m,E=s*m;r.drawClipImage(e,m,n,o,T,E,c,h,_,x)}else for(var T=a*m,E=s*m,w=0;p>w;w+=u)for(var S=0;d>S;S+=l){var _=Math.min(p-w,u),x=Math.min(d-S,l);r.drawClipImage(e,m,n,o,T,E,c,h,_,x,w,S)}}},r.$updateTextureDataWithScale9Grid=function(e,r,i,n,o,a,s,c,h,u,l,p,d,f,g,v){e.smoothing=v,e.image=r,e.imageWidth=f,e.imageHeight=g;var y=a,m=s;p-=u-a*t.$TextureScaleFactor,d-=l-s*t.$TextureScaleFactor;var $=i.x-c,b=i.y-h,_=$/t.$TextureScaleFactor,x=b/t.$TextureScaleFactor,T=i.width/t.$TextureScaleFactor,E=i.height/t.$TextureScaleFactor;0==E&&(E=1,x>=m&&x--),0==T&&(T=1,_>=y&&_--);var w=n,S=w+_,D=S+T,R=y-_-T,C=o,P=C+x,O=P+E,L=m-x-E,M=R*t.$TextureScaleFactor,A=L*t.$TextureScaleFactor;if((_+R)*t.$TextureScaleFactor>p||(x+L)*t.$TextureScaleFactor>d)return void e.drawImage(n,o,a,s,c,h,p,d);var I=c,F=I+$,B=I+(p-M),k=p-$-M,N=h,j=N+b,U=N+d-A,H=d-b-A;x>0&&(_>0&&e.drawImage(w,C,_,x,I,N,$,b),T>0&&e.drawImage(S,C,T,x,F,N,k,b),R>0&&e.drawImage(D,C,R,x,B,N,M,b)),E>0&&(_>0&&e.drawImage(w,P,_,E,I,j,$,H),T>0&&e.drawImage(S,P,T,E,F,j,k,H),R>0&&e.drawImage(D,P,R,E,B,j,M,H)),L>0&&(_>0&&e.drawImage(w,O,_,L,I,U,$,A),T>0&&e.drawImage(S,O,T,L,F,U,k,A),R>0&&e.drawImage(D,O,R,L,B,U,M,A))},r.drawClipImage=function(t,e,r,i,n,o,a,s,c,h,u,l){void 0===u&&(u=0),void 0===l&&(l=0);var p=a+n-c;p>0&&(n-=p),p=s+o-h,p>0&&(o-=p),t.drawImage(r,i,n/e,o/e,u+a,l+s,n,o)},r}(e.RenderNode);e.BitmapNode=r,__reflect(r.prototype,"egret.sys.BitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=["none","round","square"],i=["bevel","miter","round"],n=function(n){function o(){var t=n.call(this)||this;return t.dirtyRender=!0,t.type=3,t}return __extends(o,n),o.prototype.beginFill=function(t,r,i){void 0===r&&(r=1);var n=new e.FillPath;if(n.fillColor=t,n.fillAlpha=r,i){var o=this.drawData.lastIndexOf(i);this.drawData.splice(o,0,n)}else this.drawData.push(n);return this.renderCount++,n},o.prototype.beginGradientFill=function(r,i,n,o,a,s){var c=new t.Matrix;a?(c.a=819.2*a.a,c.b=819.2*a.b,c.c=819.2*a.c,c.d=819.2*a.d,c.tx=a.tx,c.ty=a.ty):(c.a=100,c.d=100);var h=new e.GradientFillPath;if(h.gradientType=r,h.colors=i,h.alphas=n,h.ratios=o,h.matrix=c,s){var u=this.drawData.lastIndexOf(s);this.drawData.splice(u,0,h)}else this.drawData.push(h);return this.renderCount++,h},o.prototype.lineStyle=function(n,o,a,s,c,h,u){void 0===a&&(a=1),void 0===h&&(h=3),void 0===u&&(u=[]),-1==r.indexOf(s)&&(s="round"),-1==i.indexOf(c)&&(c="round");var l=new e.StrokePath;return l.lineWidth=n,l.lineColor=o,l.lineAlpha=a,l.caps=s||t.CapsStyle.ROUND,l.joints=c,l.miterLimit=h,l.lineDash=u,this.drawData.push(l),this.renderCount++,l},o.prototype.clear=function(){this.drawData.length=0,this.dirtyRender=!0,this.renderCount=0},o.prototype.cleanBeforeRender=function(){},o.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},o}(e.RenderNode);e.GraphicsNode=n,__reflect(n.prototype,"egret.sys.GraphicsNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=4,e}return __extends(e,t),e.prototype.addNode=function(t){this.drawData.push(t)},e.prototype.cleanBeforeRender=function(){for(var t=this.drawData,e=t.length-1;e>=0;e--)t[e].cleanBeforeRender()},e.prototype.$getRenderCount=function(){for(var t=0,e=this.drawData,r=e.length-1;r>=0;r--)t+=e[r].$getRenderCount();return t},e}(t.RenderNode);t.GroupNode=e,__reflect(e.prototype,"egret.sys.GroupNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var r=e.call(this)||this;return r.image=null,r.smoothing=!0,r.bounds=new t.Rectangle,r.blendMode=null,r.alpha=0/0,r.filter=null,r.rotated=!1,r.type=5,r.vertices=[],r.uvs=[],r.indices=[],r}return __extends(r,e),r.prototype.drawMesh=function(t,e,r,i,n,o,a,s){this.drawData.push(t,e,r,i,n,o,a,s),this.renderCount++},r.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null},r}(e.RenderNode);e.MeshNode=r,__reflect(r.prototype,"egret.sys.MeshNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.image=null,e.smoothing=!0,e.rotated=!1,e.type=6,e}return __extends(e,t),e.prototype.drawImage=function(t,e,r,i,n,o,a,s){var c=this;c.sourceX=t,c.sourceY=e,c.sourceW=r,c.sourceH=i,c.drawX=n,c.drawY=o,c.drawW=a,c.drawH=s,c.renderCount=1},e.prototype.cleanBeforeRender=function(){t.prototype.cleanBeforeRender.call(this),this.image=null},e}(t.RenderNode);t.NormalBitmapNode=e,__reflect(e.prototype,"egret.sys.NormalBitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){var i=e.call(this,r)||this;return i._verticesDirty=!0,i._bounds=new t.Rectangle,i.$renderNode=new t.sys.MeshNode,i}return __extends(r,e),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(12)},r.prototype.setBitmapDataToWasm=function(t){this.$nativeDisplayObject.setBitmapDataToMesh(t)},r.prototype.$updateRenderNode=function(){var e=this.$bitmapData;if(e){var r=(t.$TextureScaleFactor,this.$renderNode);r.smoothing=this.$smoothing,r.image=e,r.imageWidth=this.$sourceWidth,r.imageHeight=this.$sourceHeight;var i=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,n=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,o=i/this.$textureWidth,a=n/this.$textureHeight,s=this.$bitmapWidth,c=this.$bitmapHeight;r.drawMesh(this.$bitmapX,this.$bitmapY,s,c,this.$offsetX*o,this.$offsetY*a,o*s,a*c)}},r.prototype.$updateVertices=function(){var e=this;if(e._verticesDirty=!0,e.$renderDirty=!0,t.nativeRender){var r=this.$renderNode;this.$nativeDisplayObject.setDataToMesh(r.vertices,r.indices,r.uvs)}else{var i=e.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=e.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},r.prototype.$measureContentBounds=function(t){if(this._verticesDirty){this._verticesDirty=!1;var e=this.$renderNode,r=e.vertices;if(r.length){this._bounds.setTo(Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var i=0,n=r.length;n>i;i+=2){var o=r[i],a=r[i+1];this._bounds.x>o&&(this._bounds.x=o),this._bounds.width<o&&(this._bounds.width=o),this._bounds.y>a&&(this._bounds.y=a),this._bounds.height<a&&(this._bounds.height=a)}this._bounds.width-=this._bounds.x,this._bounds.height-=this._bounds.y}else this._bounds.setTo(0,0,0,0);e.bounds.copyFrom(this._bounds)}t.copyFrom(this._bounds)},r}(t.Bitmap);t.Mesh=e,__reflect(e.prototype,"egret.Mesh")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t.textColor=16777215,t.strokeColor=0,t.size=30,t.stroke=0,t.bold=!1,t.italic=!1,t.fontFamily="Arial",t.dirtyRender=!0,t.type=2,t}return __extends(r,e),r.prototype.drawText=function(t,e,r,i){this.drawData.push(t,e,r,i),this.renderCount++,this.dirtyRender=!0},r.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},r.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.dirtyRender=!0},r}(e.RenderNode);e.TextNode=r,__reflect(r.prototype,"egret.sys.TextNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=1,e}return __extends(e,t),e}(t.Path2D);t.FillPath=e,__reflect(e.prototype,"egret.sys.FillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=2,e}return __extends(e,t),e}(t.Path2D);t.GradientFillPath=e,__reflect(e.prototype,"egret.sys.GradientFillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.OrientationMode={AUTO:"auto",PORTRAIT:"portrait",LANDSCAPE:"landscape",LANDSCAPE_FLIPPED:"landscapeFlipped"}}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=3,e}return __extends(e,t),e}(t.Path2D);t.StrokePath=e,__reflect(e.prototype,"egret.sys.StrokePath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(t,e){var r=null==e.italic?t.italic:e.italic,i=null==e.bold?t.bold:e.bold,n=null==e.size?t.size:e.size,o=e.fontFamily||t.fontFamily,a=r?"italic ":"normal ";return a+=i?"bold ":"normal ",a+=n+"px "+o}function r(t,e){var r=t>>16,i=t>>8&255,n=255&t;return"rgba("+r+","+i+","+n+","+e+")"}function i(e,i,n,o,a,s){var c;c=i==t.GradientType.LINEAR?e.createLinearGradient(-1,0,1,0):e.createRadialGradient(0,0,0,0,0,1);for(var h=n.length,u=0;h>u;u++)c.addColorStop(a[u]/255,r(n[u],o[u]));return c}function n(t,e,r){void 0===r&&(r=0);for(var i=0,n=e.length;n>i;i++)t[i+r]=e[i]}function o(t,e,r,i){for(var n=i[0],o=i[1],a=i[2],s=i[3],c=i[4],h=i[5],u=i[6],l=i[7],p=i[8],d=i[9],f=i[10],g=i[11],v=i[12],y=i[13],m=i[14],$=i[15],b=i[16],_=i[17],x=i[18],T=i[19],E=0,w=e*r*4;w>E;E+=4){var S=t[E+0],D=t[E+1],R=t[E+2],C=t[E+3];t[E+0]=n*S+o*D+a*R+s*C+c,t[E+1]=h*S+u*D+l*R+p*C+d,t[E+2]=f*S+g*D+v*R+y*C+m,t[E+3]=$*S+b*D+_*R+x*C+T}}function a(t,e,r,i,n){s(t,e,r,i),c(t,e,r,n)}function s(t,e,r,i){var o;o=T?new Uint8ClampedArray(4*e):new Array(4*e);for(var a=4*e,s=2*i+1,c=0;r>c;c++){for(var h=c*a,u=0,l=0,p=0,d=0,f=0,g=0,v=4*-i,y=4*i+4;y>v;v+=4){var m=h+v;h>m||m>=h+a||(f=t[m+3],u+=t[m+0]*f,l+=t[m+1]*f,p+=t[m+2]*f,d+=f)}for(var v=h,y=h+a,$=0,b=v-4*i,_=v+4*(i+1);y>v;v+=4,$+=4,_+=4,b+=4)0===d?(o[$+0]=0,o[$+1]=0,o[$+2]=0,o[$+3]=0):(o[$+0]=u/d,o[$+1]=l/d,o[$+2]=p/d,o[$+3]=d/s),f=t[_+3],g=t[b+3],f||0==f?g||0==g?(u+=t[_+0]*f-t[b+0]*g,l+=t[_+1]*f-t[b+1]*g,p+=t[_+2]*f-t[b+2]*g,d+=f-g):(u+=t[_+0]*f,l+=t[_+1]*f,p+=t[_+2]*f,d+=f):(g||0==g)&&(u+=-t[b+0]*g,l+=-t[b+1]*g,p+=-t[b+2]*g,d+=-g);T?t.set(o,h):n(t,o,h)}}function c(t,e,r,i){var n;n=T?new Uint8ClampedArray(4*r):new Array(4*r);for(var o=4*e,a=2*i+1,s=0;e>s;s++){for(var c=4*s,h=0,u=0,l=0,p=0,d=0,f=0,g=-i*o,v=i*o+o;v>g;g+=o){var y=c+g;c>y||y>=c+r*o||(d=t[y+3],h+=t[y+0]*d,u+=t[y+1]*d,l+=t[y+2]*d,p+=d)}for(var g=c,v=c+r*o,m=0,$=c-i*o,b=c+(i+1)*o;v>g;g+=o,m+=4,b+=o,$+=o)0===p?(n[m+0]=0,n[m+1]=0,n[m+2]=0,n[m+3]=0):(n[m+0]=h/p,n[m+1]=u/p,n[m+2]=l/p,n[m+3]=p/a),d=t[b+3],f=t[$+3],d||0==d?f||0==f?(h+=t[b+0]*d-t[$+0]*f,u+=t[b+1]*d-t[$+1]*f,l+=t[b+2]*d-t[$+2]*f,p+=d-f):(h+=t[b+0]*d,u+=t[b+1]*d,l+=t[b+2]*d,p+=d):(f||0==f)&&(h+=-t[$+0]*f,u+=-t[$+1]*f,l+=-t[$+2]*f,p+=-f);for(var _=4*s,v=_+r*o,x=0;v>_;_+=o,x+=4)t[_+0]=n[x+0],t[_+1]=n[x+1],t[_+2]=n[x+2],t[_+3]=n[x+3]}}function h(t,e,r,i,o,s,c,h,f){var g=u(t,i);l(g,e,r,c,h),a(g,e,r,o,s),p(g,f),d(g,t),t.set(g),T?t.set(g):n(t,g)}function u(t,e){e||(e=[0,0,0,0]);var r;T?r=new Uint8ClampedArray(t):(r=new Array(t.length),n(r,t));for(var i=e[0],o=e[1],a=e[2],s=e[3],c=0,h=r.length;h>c;c+=4){var u=r[c+3];r[c+0]=i*u,r[c+1]=o*u,r[c+2]=a*u,r[c+3]=s*u}return r}function l(t,e,r,i,o){var a,s,c=Math.sin(i)*o|0,h=Math.cos(i)*o|0;if(T){a=new Int32Array(t.buffer),s=new Int32Array(a.length);for(var u=0;r>u;u++){var l=u+c;if(!(0>l||l>r))for(var p=0;e>p;p++){var d=p+h;0>d||d>e||(s[l*e+d]=a[u*e+p])}}a.set(s)}else{a=t,s=new Array(a.length);for(var u=0;r>u;u++){var l=u+c;if(!(0>l||l>r))for(var p=0;e>p;p++){var d=p+h;0>d||d>e||(s[4*(l*e+d)+0]=a[4*(u*e+p)+0],s[4*(l*e+d)+1]=a[4*(u*e+p)+1],s[4*(l*e+d)+2]=a[4*(u*e+p)+2],s[4*(l*e+d)+3]=a[4*(u*e+p)+3])}}n(a,s)}}function p(t,e){for(var r=0,i=t.length;i>r;r+=4)t[r+3]*=e}function d(t,e){for(var r=0,i=t.length;i>r;r+=4){var n=t[r+0],o=t[r+1],a=t[r+2],s=t[r+3]/255,c=e[r+0],h=e[r+1],u=e[r+2],l=e[r+3]/255;t[r+0]=c+n*(1-l),t[r+1]=h+o*(1-l),t[r+2]=u+a*(1-l),t[r+3]=255*(l+s*(1-l))}}function f(t,e,r){return t*(1-r)+e*r}function g(t,e,r,i,o,a,s,c,h,u,l,p){var d;d=T?new Uint8ClampedArray(t.length):new Array(t.length);for(var g,v,y=i[3],m=0,$=0,b=c*Math.cos(s),_=c*Math.sin(s),x=7,E=12,w=3.141592653589793,S=o/x,D=a/x,R=0;e>R;R++)for(var C=0;r>C;C++){for(var P=0,O=C*e*4+4*R,L=0,M=0,A=t[O+0]/255,I=t[O+1]/255,F=t[O+2]/255,B=t[O+3]/255,k=0;2*w>=k;k+=2*w/E){g=Math.cos(k+P),v=Math.sin(k+P);for(var N=0;x>N;N++){m=N*S*g,$=N*D*v;var j=Math.round(R+m-b),U=Math.round(C+$-_),H=0;if(j>=e||0>j||0>U||U>=r)H=0;else{var W=U*e*4+4*j;H=t[W+3]/255}L+=(x-N)*H,M+=x-N}}B=Math.max(B,1e-4);var G=L/M*h*y*(1-u)*Math.max(Math.min(p,l),1-B),X=(M-L)/M*h*y*u*B;B=Math.max(B*l*(1-p),1e-4);var Y=X/(X+B),V=f(A,i[0],Y),z=f(I,i[1],Y),q=f(F,i[2],Y),K=G/(X+B+G),Q=f(V,i[0],K),J=f(z,i[1],K),Z=f(q,i[2],K),te=Math.min(B+G+X,1);
d[O+0]=255*Q,d[O+1]=255*J,d[O+2]=255*Z,d[O+3]=255*te}T?t.set(d):n(t,d)}var v=["source-over","lighter","destination-out"],y="source-over",m="#000000",$={none:"butt",square:"square",round:"round"},b=[],_=[],x=function(){function n(){this.nestLevel=0,this.renderingMask=!1}return n.prototype.render=function(e,r,i,n){this.nestLevel++;var o=r.context;o.transform(i.a,i.b,i.c,i.d,0,0);var a=this.drawDisplayObject(e,o,i.tx,i.ty,!0),s=t.Matrix.create();if(i.$invertInto(s),o.transform(s.a,s.b,s.c,s.d,0,0),t.Matrix.release(s),this.nestLevel--,0===this.nestLevel){b.length>6&&(b.length=6);for(var c=b.length,h=0;c>h;h++)b[h].resize(0,0)}return a},n.prototype.drawDisplayObject=function(e,r,i,n,o){var a,s=0,c=e.$displayList;if(c&&!o?((e.$cacheDirty||e.$renderDirty||c.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||c.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(s+=c.drawToSurface()),a=c.$renderNode):a=e.$renderDirty?e.$getRenderNode():e.$renderNode,e.$cacheDirty=!1,a){switch(s++,r.$offsetX=i,r.$offsetY=n,a.type){case 1:this.renderBitmap(a,r);break;case 2:this.renderText(a,r);break;case 3:this.renderGraphics(a,r);break;case 4:this.renderGroup(a,r);break;case 5:this.renderMesh(a,r);break;case 6:this.renderNormalBitmap(a,r)}r.$offsetX=0,r.$offsetY=0}if(c&&!o)return s;var h=e.$children;if(h)for(var u=h.length,l=0;u>l;l++){var p=h[l],d=void 0,f=void 0;if(p.$useTranslate){var g=p.$getMatrix();d=i+p.$x,f=n+p.$y,r.save(),r.transform(g.a,g.b,g.c,g.d,d,f),d=-p.$anchorOffsetX,f=-p.$anchorOffsetY}else d=i+p.$x-p.$anchorOffsetX,f=n+p.$y-p.$anchorOffsetY;var v=void 0;switch(1!=p.$alpha&&(v=r.globalAlpha,r.globalAlpha*=p.$alpha),p.$renderMode){case 1:break;case 2:s+=this.drawWithFilter(p,r,d,f);break;case 3:s+=this.drawWithClip(p,r,d,f);break;case 4:s+=this.drawWithScrollRect(p,r,d,f);break;default:s+=this.drawDisplayObject(p,r,d,f)}p.$useTranslate?r.restore():v&&(r.globalAlpha=v)}return s},n.prototype.drawWithFilter=function(t,e,r,i){if(t.$children&&0==t.$children.length&&(!t.$renderNode||0==t.$renderNode.$getRenderCount()))return 0;var n,s=0,c=t.$filters,u=c.length,l=0!==t.$blendMode;l&&(n=v[t.$blendMode],n||(n=y));var p=t.$getOriginalBounds(),d=p.x,f=p.y,m=p.width,$=p.height;if(0>=m||0>=$)return s;var b=this.createRenderBuffer(m-d,$-f,!0),x=b.context;if(s+=t.$mask?this.drawWithClip(t,x,-d,-f):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,x,-d,-f):this.drawDisplayObject(t,x,-d,-f),s>0){l&&(e.globalCompositeOperation=n),s++;for(var T=x.getImageData(0,0,b.surface.width,b.surface.height),E=0;u>E;E++){var w=c[E];if("colorTransform"==w.type)o(T.data,b.surface.width,b.surface.height,w.$matrix);else if("blur"==w.type)a(T.data,b.surface.width,b.surface.height,w.$blurX,w.$blurY);else if("glow"==w.type){var S=w.$red,D=w.$green,R=w.$blue,C=w.$alpha;w.$inner||w.$knockout||w.$hideObject?g(T.data,b.surface.width,b.surface.height,[S/255,D/255,R/255,C],w.$blurX,w.$blurY,w.$angle?w.$angle/180*Math.PI:0,w.$distance||0,w.$strength,w.$inner?1:0,w.$knockout?0:1,w.$hideObject?1:0):h(T.data,b.surface.width,b.surface.height,[S/255,D/255,R/255,C],w.$blurX,w.$blurY,w.$angle?w.$angle/180*Math.PI:0,w.$distance||0,w.$strength)}else"custom"==w.type}x.putImageData(T,0,0),e.drawImage(b.surface,r+d,i+f),l&&(e.globalCompositeOperation=y)}return _.push(b),s},n.prototype.drawWithClip=function(e,r,i,n){var o,a=0,s=0!==e.$blendMode;s&&(o=v[e.$blendMode],o||(o=y));var c=e.$scrollRect?e.$scrollRect:e.$maskRect,h=e.$mask;if(h){var u=h.$getMatrix();if(0==u.a&&0==u.b||0==u.c&&0==u.d)return a}if(!(h||e.$children&&0!=e.$children.length))return c&&(r.save(),r.beginPath(),r.rect(c.x+i,c.y+n,c.width,c.height),r.clip()),s&&(r.globalCompositeOperation=o),a+=this.drawDisplayObject(e,r,i,n),s&&(r.globalCompositeOperation=y),c&&r.restore(),a;if(h){var l=h.$getRenderNode();if((!h.$children||0==h.$children.length)&&l&&3==l.type&&1==l.drawData.length&&1==l.drawData[0].type&&1==l.drawData[0].fillAlpha){this.renderingMask=!0,r.save();var p=t.Matrix.create();p.copyFrom(h.$getConcatenatedMatrix()),h.$getConcatenatedMatrixAt(e,p),p.prepend(1,0,0,1,i,n),r.transform(p.a,p.b,p.c,p.d,p.tx,p.ty);var d=this.drawDisplayObject(h,r,0,0);return this.renderingMask=!1,p.$invertInto(p),r.transform(p.a,p.b,p.c,p.d,p.tx,p.ty),t.Matrix.release(p),c&&(r.beginPath(),r.rect(c.x+i,c.y+n,c.width,c.height),r.clip()),d+=this.drawDisplayObject(e,r,i,n),r.restore(),d}}var f=e.$getOriginalBounds(),g=f.x,m=f.y,$=f.width,_=f.height;if(0>=$||0>=_)return a;var x=this.createRenderBuffer($,_),T=x.context;if(!T)return a+=this.drawDisplayObject(e,r,i,n);if(a+=this.drawDisplayObject(e,T,-g,-m),h){var l=h.$getRenderNode(),p=t.Matrix.create();if(p.copyFrom(h.$getConcatenatedMatrix()),h.$getConcatenatedMatrixAt(e,p),p.translate(-g,-m),l&&1==l.$getRenderCount()||h.$displayList)T.globalCompositeOperation="destination-in",T.save(),T.setTransform(p.a,p.b,p.c,p.d,p.tx,p.ty),a+=this.drawDisplayObject(h,T,0,0),T.restore();else{var E=this.createRenderBuffer($,_),w=E.context;w.setTransform(p.a,p.b,p.c,p.d,p.tx,p.ty),a+=this.drawDisplayObject(h,w,0,0),T.globalCompositeOperation="destination-in",T.drawImage(E.surface,0,0),b.push(E)}t.Matrix.release(p)}return a>0&&(a++,s&&(r.globalCompositeOperation=o),c&&(r.save(),r.beginPath(),r.rect(c.x+i,c.y+n,c.width,c.height),r.clip()),r.drawImage(x.surface,i+g,n+m),c&&r.restore(),s&&(r.globalCompositeOperation=y)),b.push(x),a},n.prototype.drawWithScrollRect=function(t,e,r,i){var n=0,o=t.$scrollRect?t.$scrollRect:t.$maskRect;return o.isEmpty()?n:(t.$scrollRect&&(r-=o.x,i-=o.y),e.save(),e.beginPath(),e.rect(o.x+r,o.y+i,o.width,o.height),e.clip(),n+=this.drawDisplayObject(t,e,r,i),e.restore(),n)},n.prototype.drawNodeToBuffer=function(t,e,r,i){var n=e.context;n.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),this.renderNode(t,n,i)},n.prototype.drawDisplayToBuffer=function(t,e,r){var i=e.context;r&&i.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty);var n;n=t.$renderDirty?t.$getRenderNode():t.$renderNode;var o=0;if(n)switch(o++,n.type){case 1:this.renderBitmap(n,i);break;case 2:this.renderText(n,i);break;case 3:this.renderGraphics(n,i);break;case 4:this.renderGroup(n,i);break;case 5:this.renderMesh(n,i);break;case 6:this.renderNormalBitmap(n,i)}var a=t.$children;if(a)for(var s=a.length,c=0;s>c;c++){var h=a[c];switch(h.$renderMode){case 1:break;case 2:o+=this.drawWithFilter(h,i,0,0);break;case 3:o+=this.drawWithClip(h,i,0,0);break;case 4:o+=this.drawWithScrollRect(h,i,0,0);break;default:o+=this.drawDisplayObject(h,i,0,0)}}return o},n.prototype.renderNode=function(t,e,r){var i=0;switch(t.type){case 1:i=this.renderBitmap(t,e);break;case 2:i=1,this.renderText(t,e);break;case 3:i=this.renderGraphics(t,e,r);break;case 4:i=this.renderGroup(t,e);break;case 5:i=this.renderMesh(t,e);break;case 6:i+=this.renderNormalBitmap(t,e)}return i},n.prototype.renderNormalBitmap=function(t,e){var r=t.image;if(!r||!r.source)return 0;if(e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing),t.rotated){var i=t.sourceX,n=t.sourceY,o=t.sourceW,a=t.sourceH,s=t.drawX,c=t.drawY,h=t.drawW,u=t.drawH;e.save(),e.transform(0,-1,1,0,0,u),e.drawImage(r.source,i,n,a,o,s+e.$offsetX,c+e.$offsetY,u,h),e.restore()}else e.drawImage(r.source,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX+e.$offsetX,t.drawY+e.$offsetY,t.drawW,t.drawH);return 1},n.prototype.renderBitmap=function(t,e){var r=t.image;if(!r||!r.source)return 0;e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing);var i,n,a=t.drawData,s=a.length,c=0,h=t.matrix,u=t.blendMode,l=t.alpha,p=!1;h&&(e.save(),p=!0,(0!=e.$offsetX||0!=e.$offsetY)&&(e.translate(e.$offsetX,e.$offsetY),i=e.$offsetX,n=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(h.a,h.b,h.c,h.d,h.tx,h.ty)),u&&(e.globalCompositeOperation=v[u]);var d;l==l&&(d=e.globalAlpha,e.globalAlpha*=l);var f=0,g=t.filter;if(g&&8==s){var m=a[0],$=a[1],_=a[2],x=a[3],T=a[4],E=a[5],w=a[6],S=a[7];t.rotated&&(_=a[3],x=a[2],w=a[7],S=a[6]);var D=this.createRenderBuffer(w,S),R=D.context;f++,t.rotated&&e.transform(0,-1,1,0,0,w),R.drawImage(r.source,m,$,_,x,0,0,w,S),f++;var C=R.getImageData(0,0,w,S);o(C.data,w,S,g.$matrix),R.putImageData(C,0,0),e.drawImage(D.surface,0,0,w,S,T+e.$offsetX,E+e.$offsetY,w,S),b.push(D)}else for(;s>c;)if(f++,t.rotated){var m=a[c++],$=a[c++],x=a[c++],_=a[c++],P=a[c++],O=a[c++],S=a[c++],w=a[c++];e.save(),e.transform(0,-1,1,0,0,w),e.drawImage(r.source,m,$,_,x,P+e.$offsetX,O+e.$offsetY,w,S),e.restore()}else e.drawImage(r.source,a[c++],a[c++],a[c++],a[c++],a[c++]+e.$offsetX,a[c++]+e.$offsetY,a[c++],a[c++]);return p?e.restore():(u&&(e.globalCompositeOperation=y),l==l&&(e.globalAlpha=d)),i&&(e.$offsetX=i),n&&(e.$offsetY=n),f},n.prototype.renderMesh=function(t,e){return 0},n.prototype.renderText=function(r,i){i.textAlign="left",i.textBaseline="middle",i.lineJoin="round";for(var n=r.drawData,o=n.length,a=0;o>a;){var s=n[a++],c=n[a++],h=n[a++],u=n[a++];i.font=e(r,u);var l=null==u.textColor?r.textColor:u.textColor,p=null==u.strokeColor?r.strokeColor:u.strokeColor,d=null==u.stroke?r.stroke:u.stroke;i.fillStyle=t.toColorString(l),i.strokeStyle=t.toColorString(p),d&&(i.lineWidth=2*d,i.strokeText(h,s+i.$offsetX,c+i.$offsetY)),i.fillText(h,s+i.$offsetX,c+i.$offsetY)}},n.prototype.renderGraphics=function(t,e,n){var o=t.drawData,a=o.length;n=!!n;for(var s=0;a>s;s++){var c=o[s];switch(c.type){case 1:var h=c;e.fillStyle=n?m:r(h.fillColor,h.fillAlpha),this.renderPath(c,e),this.renderingMask?e.clip():e.fill();break;case 2:var u=c;e.fillStyle=n?m:i(e,u.gradientType,u.colors,u.alphas,u.ratios,u.matrix),e.save();var l=u.matrix;this.renderPath(c,e),e.transform(l.a,l.b,l.c,l.d,l.tx,l.ty),e.fill(),e.restore();break;case 3:var p=c,d=p.lineWidth;e.lineWidth=d,e.strokeStyle=n?m:r(p.lineColor,p.lineAlpha),e.lineCap=$[p.caps],e.lineJoin=p.joints,e.miterLimit=p.miterLimit,e.setLineDash&&e.setLineDash(p.lineDash);var f=1===d||3===d;f&&e.translate(.5,.5),this.renderPath(c,e),e.stroke(),f&&e.translate(-.5,-.5)}}return 0==a?0:1},n.prototype.renderPath=function(t,e){e.beginPath();for(var r=t.$data,i=t.$commands,n=i.length,o=0,a=0;n>a;a++){var s=i[a];switch(s){case 4:e.bezierCurveTo(r[o++]+e.$offsetX,r[o++]+e.$offsetY,r[o++]+e.$offsetX,r[o++]+e.$offsetY,r[o++]+e.$offsetX,r[o++]+e.$offsetY);break;case 3:e.quadraticCurveTo(r[o++]+e.$offsetX,r[o++]+e.$offsetY,r[o++]+e.$offsetX,r[o++]+e.$offsetY);break;case 2:e.lineTo(r[o++]+e.$offsetX,r[o++]+e.$offsetY);break;case 1:e.moveTo(r[o++]+e.$offsetX,r[o++]+e.$offsetY)}}},n.prototype.renderGroup=function(t,e){var r,i,n=t.matrix,o=!1;n&&(e.save(),o=!0,(0!=e.$offsetX||0!=e.$offsetY)&&(e.translate(e.$offsetX,e.$offsetY),r=e.$offsetX,i=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(n.a,n.b,n.c,n.d,n.tx,n.ty));for(var a=0,s=t.drawData,c=s.length,h=0;c>h;h++){var u=s[h];a+=this.renderNode(u,e)}return o&&e.restore(),r&&(e.$offsetX=r),i&&(e.$offsetY=i),a},n.prototype.createRenderBuffer=function(e,r,i){var n=i?_.pop():b.pop();return n?n.resize(e,r,!0):n=new t.sys.CanvasRenderBuffer(e,r),n},n}();t.CanvasRenderer=x,__reflect(x.prototype,"egret.CanvasRenderer"),t.getFontString=e,t.getRGBAString=r;var T=!1;try{T=void 0!==typeof Uint8ClampedArray}catch(E){}}(egret||(egret={}));var egret;!function(t){t.DeviceOrientation=null}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(t){t.WEB="web",t.NATIVE="native",t.RUNTIME2="runtime2",t.MYGAME="mygame",t.WXGAME="wxgame",t.BAIDUGAME="baidugame",t.QGAME="qgame",t.OPPOGAME="oppogame",t.QQGAME="qqgame",t.VIVOGAME="vivogame"}(e=t.RuntimeType||(t.RuntimeType={}));var r=function(){function e(){}return e.language="zh-CN",e.os="Unknown",e.runtimeType=t.RuntimeType.WEB,e.engineVersion="5.2.33",e.renderMode="Unknown",e.boundingClientWidth=0,e.boundingClientHeight=0,e}();t.Capabilities=r,__reflect(r.prototype,"egret.Capabilities")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;r.$renderBuffer=new t.sys.RenderBuffer;var i=new t.BitmapData(r.$renderBuffer.surface);return i.$deleteSource=!1,r._setBitmapData(i),r}return __extends(r,e),r.prototype.drawToTexture=function(e,r,i){if(void 0===i&&(i=1),r&&(0==r.width||0==r.height))return!1;var n=r||e.$getOriginalBounds();if(0==n.width||0==n.height)return!1;i/=t.$TextureScaleFactor;var o=(n.x+n.width)*i,a=(n.y+n.height)*i;r&&(o=n.width*i,a=n.height*i);var s=this.$renderBuffer;if(!s)return!1;if(s.resize(o,a),this.$bitmapData.width=o,this.$bitmapData.height=a,t.nativeRender){egret_native.activateBuffer(this.$renderBuffer);var c=!1,h=0,u=0,l=0,p=0;r&&(c=!0,h=r.x,u=r.y,l=r.width,p=r.height),egret_native.updateNativeRender(),egret_native.nrRenderDisplayObject(e.$nativeDisplayObject.id,i,c,h,u,l,p),egret_native.activateBuffer(null)}else{var d=t.Matrix.create();d.identity(),d.scale(i,i),r&&d.translate(-r.x,-r.y),t.sys.systemRenderer.render(e,s,d,!0),t.Matrix.release(d)}return this.$initData(0,0,o,a,0,0,o,a,o,a),!0},r.prototype.getPixel32=function(e,r){var i;if(this.$renderBuffer){var n=t.$TextureScaleFactor;e=Math.round(e/n),r=Math.round(r/n),i=this.$renderBuffer.getPixels(e,r,1,1)}return i},r.prototype.dispose=function(){e.prototype.dispose.call(this),this.$renderBuffer=null},r}(t.Texture);t.RenderTexture=e,__reflect(e.prototype,"egret.RenderTexture")}(egret||(egret={}));var egret;!function(t){function e(t,e){i[t]=e}function r(t){return i[t]}var i={};t.registerImplementation=e,t.getImplementation=r}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$graphics=new t.Graphics,r.$graphics.$setTarget(r),r}return __extends(r,e),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(8)},Object.defineProperty(r.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),r.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},r.prototype.$hitTest=function(t,r){var i=e.prototype.$hitTest.call(this,t,r);return i==this&&(i=this.$graphics.$hitTest(t,r)),i},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},r}(t.DisplayObject);t.Shape=e,__reflect(e.prototype,"egret.Shape")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r){var i=t.call(this,e)||this;return i.firstCharHeight=0,"string"==typeof r?i.charList=i.parseConfig(r):r&&r.hasOwnProperty("frames")?i.charList=r.frames:i.charList={},i}return __extends(e,t),e.prototype.getTexture=function(t){var e=this._textureMap[t];if(!e){var r=this.charList[t];if(!r)return null;e=this.createTexture(t,r.x,r.y,r.w,r.h,r.offX,r.offY,r.sourceW,r.sourceH),this._textureMap[t]=e}return e},e.prototype.getConfig=function(t,e){return this.charList[t]?this.charList[t][e]:0},e.prototype._getFirstCharHeight=function(){if(0==this.firstCharHeight)for(var t in this.charList){var e=this.charList[t];if(e){var r=e.sourceH;if(void 0===r){var i=e.h;void 0===i&&(i=0);var n=e.offY;void 0===n&&(n=0),r=i+n}if(0>=r)continue;this.firstCharHeight=r;break}}return this.firstCharHeight},e.prototype.parseConfig=function(t){t=t.split("\r\n").join("\n");for(var e=t.split("\n"),r=this.getConfigByKey(e[3],"count"),i={},n=4;4+r>n;n++){var o=e[n],a=String.fromCharCode(this.getConfigByKey(o,"id")),s={};i[a]=s,s.x=this.getConfigByKey(o,"x"),s.y=this.getConfigByKey(o,"y"),s.w=this.getConfigByKey(o,"width"),s.h=this.getConfigByKey(o,"height"),s.offX=this.getConfigByKey(o,"xoffset"),s.offY=this.getConfigByKey(o,"yoffset"),s.xadvance=this.getConfigByKey(o,"xadvance")}return i},e.prototype.getConfigByKey=function(t,e){for(var r=t.split(" "),i=0,n=r.length;n>i;i++){var o=r[i];if(e==o.substring(0,e.length)){var a=o.substring(e.length+1);return parseInt(a)}}return 0},e}(t.SpriteSheet);t.BitmapFont=e,__reflect(e.prototype,"egret.BitmapFont")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$smoothing=t.Bitmap.defaultSmoothing,r.$text="",r.$textFieldWidth=0/0,r.$textLinesChanged=!1,r.$textFieldHeight=0/0,r.$font=null,r.$fontStringChanged=!1,r.$lineSpacing=0,r.$letterSpacing=0,r.$textAlign=t.HorizontalAlign.LEFT,r.$verticalAlign=t.VerticalAlign.TOP,r.$textWidth=0/0,r.$textHeight=0/0,r.$textOffsetX=0,r.$textOffsetY=0,r.$textStartX=0,r.$textStartY=0,r.textLines=[],r.$lineHeights=[],t.nativeRender||(r.$renderNode=new t.sys.BitmapNode),r}return __extends(r,e),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(11)},Object.defineProperty(r.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(e){var r=this;if(e!=r.$smoothing&&(r.$smoothing=e,!t.nativeRender)){var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"text",{get:function(){return this.$text},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),r.prototype.$setText=function(t){t=null==t?"":String(t);var e=this;return t==e.$text?!1:(e.$text=t,e.$invalidateContentBounds(),!0)},r.prototype.$getWidth=function(){var t=this,e=t.$textFieldWidth;return isNaN(e)?t.$getContentBounds().width:e},r.prototype.$setWidth=function(t){var e=this;return 0>t||t==e.$textFieldWidth?!1:(e.$textFieldWidth=t,e.$invalidateContentBounds(),!0)},r.prototype.$invalidateContentBounds=function(){this.$renderDirty=!0,this.$textLinesChanged=!0,this.$updateRenderNode()},r.prototype.$getHeight=function(){var t=this,e=t.$textFieldHeight;return isNaN(e)?t.$getContentBounds().height:e},r.prototype.$setHeight=function(t){var e=this;return 0>t||t==e.$textFieldHeight?!1:(e.$textFieldHeight=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"font",{get:function(){return this.$font},set:function(t){this.$setFont(t)},enumerable:!0,configurable:!0}),r.prototype.$setFont=function(t){var e=this;return e.$font==t?!1:(e.$font=t,e.$fontStringChanged=!0,this.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"lineSpacing",{get:function(){return this.$lineSpacing},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),r.prototype.$setLineSpacing=function(t){var e=this;return e.$lineSpacing==t?!1:(e.$lineSpacing=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"letterSpacing",{get:function(){return this.$letterSpacing},set:function(t){this.$setLetterSpacing(t)},enumerable:!0,configurable:!0}),r.prototype.$setLetterSpacing=function(t){var e=this;return e.$letterSpacing==t?!1:(e.$letterSpacing=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"textAlign",{get:function(){return this.$textAlign},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),r.prototype.$setTextAlign=function(t){var e=this;return e.$textAlign==t?!1:(e.$textAlign=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"verticalAlign",{get:function(){return this.$verticalAlign},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),r.prototype.$setVerticalAlign=function(t){var e=this;return e.$verticalAlign==t?!1:(e.$verticalAlign=t,e.$invalidateContentBounds(),!0)},r.prototype.$updateRenderNode=function(){var e=this,i=this.$getTextLines(),n=i.length;if(0==n)return void(t.nativeRender&&e.$font&&(e.$nativeDisplayObject.setDataToBitmapNode(e.$nativeDisplayObject.id,e.$font.$texture,[]),e.$nativeDisplayObject.setWidth(0),e.$nativeDisplayObject.setHeight(0)));var o,a=[],s=this.$textLinesWidth,c=e.$font;t.nativeRender||(o=this.$renderNode,c.$texture&&(o.image=c.$texture.$bitmapData),o.smoothing=e.$smoothing);for(var h=c._getFirstCharHeight(),u=Math.ceil(h*r.EMPTY_FACTOR),l=!isNaN(e.$textFieldHeight),p=e.$textWidth,d=e.$textFieldWidth,f=e.$textFieldHeight,g=e.$textAlign,v=this.$textOffsetY+this.$textStartY,y=this.$lineHeights,m=0;n>m;m++){var $=y[m];if(l&&m>0&&v+$>f)break;var b=i[m],_=b.length,x=this.$textOffsetX;if(g!=t.HorizontalAlign.LEFT){var T=d>p?d:p;g==t.HorizontalAlign.RIGHT?x+=T-s[m]:g==t.HorizontalAlign.CENTER&&(x+=Math.floor((T-s[m])/2))}for(var E=0;_>E;E++){var w=b.charAt(E),S=c.getTexture(w);if(S){var D=S.$bitmapWidth,R=S.$bitmapHeight;t.nativeRender?a.push(S.$bitmapX,S.$bitmapY,D,R,x+S.$offsetX,v+S.$offsetY,S.$getScaleBitmapWidth(),S.$getScaleBitmapHeight(),S.$sourceWidth,S.$sourceHeight):(o.imageWidth=S.$sourceWidth,o.imageHeight=S.$sourceHeight,o.drawImage(S.$bitmapX,S.$bitmapY,D,R,x+S.$offsetX,v+S.$offsetY,S.$getScaleBitmapWidth(),S.$getScaleBitmapHeight())),x+=(c.getConfig(w,"xadvance")||S.$getTextureWidth())+e.$letterSpacing}else" "==w?x+=u:t.$warn(1046,w)}v+=$+e.$lineSpacing}if(t.nativeRender){e.$nativeDisplayObject.setDataToBitmapNode(e.$nativeDisplayObject.id,c.$texture,a);var C=e.$getContentBounds();e.$nativeDisplayObject.setWidth(C.width),e.$nativeDisplayObject.setHeight(C.height)}},r.prototype.$measureContentBounds=function(t){var e=this.$getTextLines();0==e.length?t.setEmpty():t.setTo(this.$textOffsetX+this.$textStartX,this.$textOffsetY+this.$textStartY,this.$textWidth-this.$textOffsetX,this.$textHeight-this.$textOffsetY)},Object.defineProperty(r.prototype,"textWidth",{get:function(){return this.$getTextLines(),this.$textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textHeight",{get:function(){return this.$getTextLines(),this.$textHeight},enumerable:!0,configurable:!0}),r.prototype.$getTextLines=function(){function e(t){return $&&n.length>0&&f>$?!1:(f+=h+l,s||c||(u-=p),n.push(t),a.push(h),o.push(u),d=Math.max(u,d),!0)}var i=this;if(!i.$textLinesChanged)return i.textLines;var n=[];i.textLines=n;var o=[];i.$textLinesWidth=o,i.$textLinesChanged=!1;var a=[];if(i.$lineHeights=a,!i.$text||!i.$font)return i.$textWidth=0,i.$textHeight=0,n;for(var s,c,h,u,l=i.$lineSpacing,p=i.$letterSpacing,d=0,f=0,g=0,v=0,y=!isNaN(i.$textFieldWidth),m=i.$textFieldWidth,$=i.$textFieldHeight,b=i.$font,_=b._getFirstCharHeight(),x=Math.ceil(_*r.EMPTY_FACTOR),T=i.$text,E=T.split(/(?:\r\n|\r|\n)/),w=E.length,S=!0,D=0;w>D;D++){var R=E[D],C=R.length;h=0,u=0,s=!0,c=!1;for(var P=0;C>P;P++){s||(u+=p);var O=R.charAt(P),L=void 0,M=void 0,A=0,I=0,F=b.getTexture(O);if(F)L=F.$getTextureWidth(),M=F.$getTextureHeight(),A=F.$offsetX,I=F.$offsetY;else{if(" "!=O){t.$warn(1046,O),s&&(s=!1);continue}L=x,M=_}if(s&&(s=!1),S&&(S=!1),y&&P>0&&u+L>m){if(!e(R.substring(0,P)))break;R=R.substring(P),C=R.length,P=0,u=P==C-1?L:b.getConfig(O,"xadvance")||L,h=M}else u+=P==C-1?L:b.getConfig(O,"xadvance")||L,h=Math.max(M,h)}if($&&D>0&&f>$)break;if(c=!0,!e(R))break}f-=l,i.$textWidth=d,i.$textHeight=f,this.$textOffsetX=g,this.$textOffsetY=v,this.$textStartX=0,this.$textStartY=0;var B;return m>d&&(B=i.$textAlign,B==t.HorizontalAlign.RIGHT?this.$textStartX=m-d:B==t.HorizontalAlign.CENTER&&(this.$textStartX=Math.floor((m-d)/2))),$>f&&(B=i.$verticalAlign,B==t.VerticalAlign.BOTTOM?this.$textStartY=$-f:B==t.VerticalAlign.MIDDLE&&(this.$textStartY=Math.floor(($-f)/2))),n},r.EMPTY_FACTOR=.33,r}(t.DisplayObject);t.BitmapText=e,__reflect(e.prototype,"egret.BitmapText")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.HorizontalAlign=e,__reflect(e.prototype,"egret.HorizontalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this.replaceArr=[],this.resutlArr=[],this.initReplaceArr()}return e.prototype.initReplaceArr=function(){this.replaceArr=[],this.replaceArr.push([/&lt;/g,"<"]),this.replaceArr.push([/&gt;/g,">"]),this.replaceArr.push([/&amp;/g,"&"]),this.replaceArr.push([/&quot;/g,'"']),this.replaceArr.push([/&apos;/g,"'"])},e.prototype.replaceSpecial=function(t){for(var e=0;e<this.replaceArr.length;e++){var r=this.replaceArr[e][0],i=this.replaceArr[e][1];t=t.replace(r,i)}return t},e.prototype.parse=function(e){this.stackArray=[],this.resutlArr=[];for(var r=0,i=e.length;i>r;){var n=e.indexOf("<",r);if(0>n)this.addToResultArr(e.substring(r)),r=i;else{this.addToResultArr(e.substring(r,n));var o=e.indexOf(">",n);-1==o?(t.$error(1038),o=n):"/"==e.charAt(n+1)?this.stackArray.pop():this.addToArray(e.substring(n+1,o)),r=o+1}}return this.resutlArr},e.prototype.parser=function(t){return this.parse(t)},e.prototype.addToResultArr=function(t){""!=t&&(t=this.replaceSpecial(t),this.stackArray.length>0?this.resutlArr.push({text:t,style:this.stackArray[this.stackArray.length-1]}):this.resutlArr.push({text:t}))},e.prototype.changeStringToObject=function(t){t=t.trim();var e={},r=[];if("i"==t.charAt(0)||"b"==t.charAt(0)||"u"==t.charAt(0))this.addProperty(e,t,"true");else if(r=t.match(/^(font|a)\s/)){t=t.substring(r[0].length).trim();for(var i=0,n=void 0;n=t.match(this.getHeadReg());){var o=n[0],a="";t=t.substring(o.length).trim(),'"'==t.charAt(0)?(i=t.indexOf('"',1),a=t.substring(1,i),i+=1):"'"==t.charAt(0)?(i=t.indexOf("'",1),a=t.substring(1,i),i+=1):(a=t.match(/(\S)+/)[0],i=a.length),this.addProperty(e,o.substring(0,o.length-1).trim(),a.trim()),t=t.substring(i).trim()}}return e},e.prototype.getHeadReg=function(){return/^(color|textcolor|strokecolor|stroke|b|bold|i|italic|u|size|fontfamily|href|target)(\s)*=/},e.prototype.addProperty=function(t,e,r){switch(e.toLowerCase()){case"color":case"textcolor":r=r.replace(/#/,"0x"),t.textColor=parseInt(r);break;case"strokecolor":r=r.replace(/#/,"0x"),t.strokeColor=parseInt(r);break;case"stroke":t.stroke=parseInt(r);break;case"b":case"bold":t.bold="true"==r;break;case"u":t.underline="true"==r;break;case"i":case"italic":t.italic="true"==r;break;case"size":t.size=parseInt(r);break;case"fontfamily":t.fontFamily=r;break;case"href":t.href=this.replaceSpecial(r);break;case"target":t.target=this.replaceSpecial(r)}},e.prototype.addToArray=function(t){var e=this.changeStringToObject(t);if(0==this.stackArray.length)this.stackArray.push(e);else{var r=this.stackArray[this.stackArray.length-1];for(var i in r)null==e[i]&&(e[i]=r[i]);this.stackArray.push(e)}},e}();t.HtmlTextParser=e,__reflect(e.prototype,"egret.HtmlTextParser")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t.stageTextAdded=!1,t._text=null,t._isFocus=!1,t}return __extends(r,e),r.prototype.init=function(e){this._text=e,this.stageText=new t.StageText,this.stageText.$setTextField(this._text)},r.prototype._addStageText=function(){this.stageTextAdded||(this._text.$inputEnabled||(this._text.$touchEnabled=!0),this.tempStage=this._text.stage,this.stageText.$addToStage(),this.stageText.addEventListener("updateText",this.updateTextHandler,this),this._text.addEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.stageText.addEventListener("blur",this.blurHandler,this),this.stageText.addEventListener("focus",this.focusHandler,this),this.stageTextAdded=!0)},r.prototype._removeStageText=function(){this.stageTextAdded&&(this._text.$inputEnabled||(this._text.$touchEnabled=!1),this.stageText.$removeFromStage(),this.stageText.removeEventListener("updateText",this.updateTextHandler,this),this._text.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this.stageText.removeEventListener("blur",this.blurHandler,this),this.stageText.removeEventListener("focus",this.focusHandler,this),this.stageTextAdded=!1)},r.prototype._getText=function(){return this.stageText.$getText()},r.prototype._setText=function(t){this.stageText.$setText(t)},r.prototype._setColor=function(t){this.stageText.$setColor(t)},r.prototype.focusHandler=function(e){this._isFocus||(this._isFocus=!0,e.showing||this._text.$setIsTyping(!0),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_IN,!0)))},r.prototype.blurHandler=function(e){this._isFocus&&(this._isFocus=!1,this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this._text.$setIsTyping(!1),this.stageText.$onBlur(),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_OUT,!0)))},r.prototype.onMouseDownHandler=function(t){this.$onFocus()},r.prototype.$onFocus=function(){var e=this;this._text.visible&&(this._isFocus||(this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),t.callLater(function(){e.tempStage.addEventListener(t.TouchEvent.TOUCH_BEGIN,e.onStageDownHandler,e)},this),t.nativeRender&&this.stageText.$setText(this._text.$TextField[13]),this.stageText.$show()))},r.prototype.onStageDownHandler=function(t){t.$target!=this._text&&this.stageText.$hide()},r.prototype.updateTextHandler=function(e){var r,i,n=this._text.$TextField,o=this.stageText.$getText(),a=!1;null!=n[35]&&(r=new RegExp("["+n[35]+"]","g"),i=o.match(r),o=i?i.join(""):"",a=!0),null!=n[36]&&(r=new RegExp("[^"+n[36]+"]","g"),i=o.match(r),o=i?i.join(""):"",a=!0),a&&this.stageText.$getText()!=o&&this.stageText.$setText(o),this.resetText(),this._text.dispatchEvent(new t.Event(t.Event.CHANGE,!0))},r.prototype.resetText=function(){this._text.$setBaseText(this.stageText.$getText())},r.prototype._hideInput=function(){this.stageText.$removeFromStage()},r.prototype.updateInput=function(){!this._text.$visible&&this.stageText&&this._hideInput()},r.prototype._updateProperties=function(){return this._isFocus?(this.stageText.$resetStageText(),void this.updateInput()):(this.stageText.$setText(this._text.$TextField[13]),this.stageText.$resetStageText(),void this.updateInput())},r}(t.HashObject);t.InputController=e,__reflect(e.prototype,"egret.InputController")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(e,r,n){n=n||{};var o=null==n.italic?r[16]:n.italic,a=null==n.bold?r[15]:n.bold,s=null==n.size?r[0]:n.size,c=n.fontFamily||r[8]||i.default_fontFamily;return t.sys.measureText(e,c,s,a,o)}var r=new RegExp("(?=[\\u00BF-\\u1FFF\\u2C00-\\uD7FF]|\\b|\\s)(?![)}\\.\\,\\!\\?\\]\\:])"),i=function(i){function n(){var e=i.call(this)||this;e.$inputEnabled=!1,e.inputUtils=null,e.$graphicsNode=null,e.isFlow=!1,e.textArr=[],e.linesArr=[],e.$isTyping=!1;var r=new t.sys.TextNode;return r.fontFamily=n.default_fontFamily,e.textNode=r,e.$renderNode=r,e.$TextField={0:n.default_size,1:0,2:n.default_textColor,3:0/0,4:0/0,5:0,6:0,7:0,8:n.default_fontFamily,9:"left",10:"top",11:"#ffffff",12:"",13:"",14:[],15:!1,16:!1,17:!0,18:!1,19:!1,20:!1,21:0,22:0,23:0,24:t.TextFieldType.DYNAMIC,25:0,26:"#000000",27:0,28:-1,29:0,30:!1,31:!1,32:0,33:!1,34:16777215,35:null,36:null,37:t.TextFieldInputType.TEXT,38:!1},e}return __extends(n,i),n.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(7)},n.prototype.isInput=function(){return this.$TextField[24]==t.TextFieldType.INPUT},n.prototype.$setTouchEnabled=function(t){i.prototype.$setTouchEnabled.call(this,t),this.isInput()&&(this.$inputEnabled=!0)},Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this.$TextField[8]},set:function(t){this.$setFontFamily(t)},enumerable:!0,configurable:!0}),n.prototype.$setFontFamily=function(e){var r=this.$TextField;return r[8]==e?!1:(r[8]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setFontFamily(e),!0)},Object.defineProperty(n.prototype,"size",{get:function(){return this.$TextField[0]},set:function(t){this.$setSize(t)},enumerable:!0,configurable:!0}),n.prototype.$setSize=function(e){var r=this.$TextField;return r[0]==e?!1:(r[0]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setFontSize(e),!0)},Object.defineProperty(n.prototype,"bold",{get:function(){return this.$TextField[15]},set:function(t){this.$setBold(t)},enumerable:!0,configurable:!0}),n.prototype.$setBold=function(e){var r=this.$TextField;return e==r[15]?!1:(r[15]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setBold(e),!0)},Object.defineProperty(n.prototype,"italic",{get:function(){return this.$TextField[16]
},set:function(t){this.$setItalic(t)},enumerable:!0,configurable:!0}),n.prototype.$setItalic=function(e){var r=this.$TextField;return e==r[16]?!1:(r[16]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setItalic(e),!0)},n.prototype.invalidateFontString=function(){this.$TextField[17]=!0,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textAlign",{get:function(){return this.$TextField[9]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextAlign=function(e){var r=this.$TextField;return r[9]==e?!1:(r[9]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setTextAlign(e),!0)},Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this.$TextField[10]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setVerticalAlign=function(e){var r=this.$TextField;return r[10]==e?!1:(r[10]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setVerticalAlign(e),!0)},Object.defineProperty(n.prototype,"lineSpacing",{get:function(){return this.$TextField[1]},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),n.prototype.$setLineSpacing=function(e){var r=this.$TextField;return r[1]==e?!1:(r[1]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setLineSpacing(e),!0)},Object.defineProperty(n.prototype,"textColor",{get:function(){return this.$TextField[2]},set:function(t){this.$setTextColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextColor=function(e){var r=this.$TextField;return r[2]==e?!1:(r[2]=e,this.inputUtils&&this.inputUtils._setColor(this.$TextField[2]),this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setTextColor(e),!0)},Object.defineProperty(n.prototype,"wordWrap",{get:function(){return this.$TextField[19]},set:function(t){this.$setWordWrap(t)},enumerable:!0,configurable:!0}),n.prototype.$setWordWrap=function(e){var r=this.$TextField;e!=r[19]&&(r[20]||(r[19]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setWordWrap(e)))},Object.defineProperty(n.prototype,"type",{get:function(){return this.$TextField[24]},set:function(t){this.$setType(t)},enumerable:!0,configurable:!0}),n.prototype.$setType=function(e){var r=this.$TextField;return r[24]!=e?(r[24]=e,t.nativeRender&&this.$nativeDisplayObject.setType(e),e==t.TextFieldType.INPUT?(isNaN(r[3])&&this.$setWidth(100),isNaN(r[4])&&this.$setHeight(30),this.$setTouchEnabled(!0),null==this.inputUtils&&(this.inputUtils=new t.InputController),this.inputUtils.init(this),this.$invalidateTextField(),this.$stage&&this.inputUtils._addStageText()):(this.inputUtils&&(this.inputUtils._removeStageText(),this.inputUtils=null),this.$setTouchEnabled(!1)),!0):!1},Object.defineProperty(n.prototype,"inputType",{get:function(){return this.$TextField[37]},set:function(e){this.$TextField[37]!=e&&(this.$TextField[37]=e,t.nativeRender&&this.$nativeDisplayObject.setInputType(e))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.$getText()},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),n.prototype.$getText=function(){return this.$TextField[24]==t.TextFieldType.INPUT?this.inputUtils._getText():this.$TextField[13]},n.prototype.$setBaseText=function(e){e=null==e?"":e.toString(),this.isFlow=!1;var r=this.$TextField;if(r[13]!=e){this.$invalidateTextField(),r[13]=e;var i="";return i=r[20]?this.changeToPassText(e):e,t.nativeRender&&this.$nativeDisplayObject.setText(i),this.setMiddleStyle([{text:i}]),!0}return!1},n.prototype.$setText=function(t){null==t&&(t="");var e=this.$setBaseText(t);return this.inputUtils&&this.inputUtils._setText(this.$TextField[13]),e},Object.defineProperty(n.prototype,"displayAsPassword",{get:function(){return this.$TextField[20]},set:function(t){this.$setDisplayAsPassword(t)},enumerable:!0,configurable:!0}),n.prototype.$setDisplayAsPassword=function(e){var r=this.$TextField;if(r[20]!=e){r[20]=e,this.$invalidateTextField();var i="";return i=e?this.changeToPassText(r[13]):r[13],t.nativeRender&&this.$nativeDisplayObject.setText(i),this.setMiddleStyle([{text:i}]),!0}return!1},Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this.$TextField[25]},set:function(t){this.$setStrokeColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setStrokeColor=function(e){var r=this.$TextField;return r[25]!=e?(this.$invalidateTextField(),r[25]=e,t.nativeRender&&this.$nativeDisplayObject.setStrokeColor(e),r[26]=t.toColorString(e),!0):!1},Object.defineProperty(n.prototype,"stroke",{get:function(){return this.$TextField[27]},set:function(t){this.$setStroke(t)},enumerable:!0,configurable:!0}),n.prototype.$setStroke=function(e){return this.$TextField[27]!=e?(this.$invalidateTextField(),this.$TextField[27]=e,t.nativeRender&&this.$nativeDisplayObject.setStroke(e),!0):!1},Object.defineProperty(n.prototype,"maxChars",{get:function(){return this.$TextField[21]},set:function(t){this.$setMaxChars(t)},enumerable:!0,configurable:!0}),n.prototype.$setMaxChars=function(e){return this.$TextField[21]!=e?(this.$TextField[21]=e,t.nativeRender&&this.$nativeDisplayObject.setMaxChars(e),!0):!1},Object.defineProperty(n.prototype,"scrollV",{get:function(){return Math.min(Math.max(this.$TextField[28],1),this.maxScrollV)},set:function(e){e=Math.max(e,1),e!=this.$TextField[28]&&(this.$TextField[28]=e,t.nativeRender&&this.$nativeDisplayObject.setScrollV(e),this.$invalidateTextField())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxScrollV",{get:function(){return this.$getLinesArr(),Math.max(this.$TextField[29]-t.TextFieldUtils.$getScrollNum(this)+1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionBeginIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEndIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"caretIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),n.prototype.$setSelection=function(t,e){return!1},n.prototype.$getLineHeight=function(){return this.$TextField[1]+this.$TextField[0]},Object.defineProperty(n.prototype,"numLines",{get:function(){return this.$getLinesArr(),this.$TextField[29]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"multiline",{get:function(){return this.$TextField[30]},set:function(t){this.$setMultiline(t)},enumerable:!0,configurable:!0}),n.prototype.$setMultiline=function(e){return this.$TextField[30]==e?!1:(this.$TextField[30]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setMultiline(e),!0)},Object.defineProperty(n.prototype,"restrict",{get:function(){var t=this.$TextField,e=null;return null!=t[35]&&(e=t[35]),null!=t[36]&&(null==e&&(e=""),e+="^"+t[36]),e},set:function(t){var e=this.$TextField;if(null==t)e[35]=null,e[36]=null;else{for(var r=-1;r<t.length&&(r=t.indexOf("^",r),0!=r)&&r>0&&"\\"==t.charAt(r-1);)r++;0==r?(e[35]=null,e[36]=t.substring(r+1)):r>0?(e[35]=t.substring(0,r),e[36]=t.substring(r+1)):(e[35]=t,e[36]=null)}},enumerable:!0,configurable:!0}),n.prototype.$setWidth=function(e){t.nativeRender&&this.$nativeDisplayObject.setTextFieldWidth(e);var r=this.$TextField;if(isNaN(e)){if(isNaN(r[3]))return!1;r[3]=0/0}else{if(r[3]==e)return!1;r[3]=e}return e=+e,0>e?!1:(this.$invalidateTextField(),!0)},n.prototype.$setHeight=function(e){t.nativeRender&&this.$nativeDisplayObject.setTextFieldHeight(e);var r=this.$TextField;if(isNaN(e)){if(isNaN(r[4]))return!1;r[4]=0/0}else{if(r[4]==e)return!1;r[4]=e}return e=+e,0>e?!1:(this.$invalidateTextField(),!0)},n.prototype.$getWidth=function(){var t=this.$TextField;return isNaN(t[3])?this.$getContentBounds().width:t[3]},n.prototype.$getHeight=function(){var t=this.$TextField;return isNaN(t[4])?this.$getContentBounds().height:t[4]},Object.defineProperty(n.prototype,"border",{get:function(){return this.$TextField[31]},set:function(t){this.$setBorder(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorder=function(e){e=!!e,this.$TextField[31]!=e&&(this.$TextField[31]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBorder(e))},Object.defineProperty(n.prototype,"borderColor",{get:function(){return this.$TextField[32]},set:function(t){this.$setBorderColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorderColor=function(e){e=+e||0,this.$TextField[32]!=e&&(this.$TextField[32]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBorderColor(e))},Object.defineProperty(n.prototype,"background",{get:function(){return this.$TextField[33]},set:function(t){this.$setBackground(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackground=function(e){this.$TextField[33]!=e&&(this.$TextField[33]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBackground(e))},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.$TextField[34]},set:function(t){this.$setBackgroundColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackgroundColor=function(e){this.$TextField[34]!=e&&(this.$TextField[34]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBackgroundColor(e))},n.prototype.fillBackground=function(e){var r=this.$graphicsNode;r&&r.clear();var i=this.$TextField;if(i[33]||i[31]||e&&e.length>0){if(!r)if(r=this.$graphicsNode=new t.sys.GraphicsNode,t.nativeRender)this.$renderNode=this.textNode;else{var n=new t.sys.GroupNode;n.addNode(r),n.addNode(this.textNode),this.$renderNode=n}var o=void 0,a=void 0;if(i[33]&&(o=r.beginFill(i[34]),o.drawRect(0,0,this.$getWidth(),this.$getHeight())),i[31]&&(a=r.lineStyle(1,i[32]),a.drawRect(0,0,this.$getWidth()-1,this.$getHeight()-1)),e&&e.length>0)for(var s=i[2],c=-1,h=e.length,u=0;h>u;u+=4){var l=e[u],p=e[u+1],d=e[u+2],f=e[u+3]||s;(0>c||c!=f)&&(c=f,a=r.lineStyle(2,f,1,t.CapsStyle.NONE)),a.moveTo(l,p),a.lineTo(l+d,p)}}if(r){var g=this.$getRenderBounds();r.x=g.x,r.y=g.y,r.width=g.width,r.height=g.height,t.Rectangle.release(g)}},n.prototype.setFocus=function(){this.type==t.TextFieldType.INPUT&&this.$stage&&this.inputUtils.$onFocus()},n.prototype.$onRemoveFromStage=function(){i.prototype.$onRemoveFromStage.call(this),this.removeEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._removeStageText(),this.textNode&&(this.textNode.clean(),t.nativeRender&&egret_native.NativeDisplayObject.disposeTextData(this))},n.prototype.$onAddToStage=function(e,r){i.prototype.$onAddToStage.call(this,e,r),this.addEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._addStageText()},n.prototype.$invalidateTextField=function(){var e=this;if(e.$renderDirty=!0,e.$TextField[18]=!0,e.$TextField[38]=!0,t.nativeRender);else{var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}},n.prototype.$getRenderBounds=function(){var e=this.$getContentBounds(),r=t.Rectangle.create();r.copyFrom(e),this.$TextField[31]&&(r.width+=2,r.height+=2);var i=2*this.$TextField[27];return i>0&&(r.width+=2*i,r.height+=2*i),r.x-=i+2,r.y-=i+2,r.width=Math.ceil(r.width)+4,r.height=Math.ceil(r.height)+4,r},n.prototype.$measureContentBounds=function(e){this.$getLinesArr();var r=0,i=0;t.nativeRender?(r=egret_native.nrGetTextFieldWidth(this.$nativeDisplayObject.id),i=egret_native.nrGetTextFieldHeight(this.$nativeDisplayObject.id)):(r=isNaN(this.$TextField[3])?this.$TextField[5]:this.$TextField[3],i=isNaN(this.$TextField[4])?t.TextFieldUtils.$getTextHeight(this):this.$TextField[4]),e.setTo(0,0,r,i)},n.prototype.$updateRenderNode=function(){if(this.$TextField[24]==t.TextFieldType.INPUT){if(this.inputUtils._updateProperties(),this.$isTyping)return void this.fillBackground()}else if(0==this.$TextField[3]){var e=this.$graphicsNode;return void(e&&e.clear())}var r=this.drawText();this.fillBackground(r);var i=this.$getRenderBounds(),n=this.textNode;n.x=i.x,n.y=i.y,n.width=Math.ceil(i.width),n.height=Math.ceil(i.height),t.Rectangle.release(i)},Object.defineProperty(n.prototype,"textFlow",{get:function(){return this.textArr},set:function(e){this.isFlow=!0;var r="";null==e&&(e=[]);for(var i=0;i<e.length;i++){var n=e[i];r+=n.text}this.$TextField[20]?this.$setBaseText(r):(this.$TextField[13]=r,this.setMiddleStyle(e),t.nativeRender&&this.$nativeDisplayObject.setTextFlow(e))},enumerable:!0,configurable:!0}),n.prototype.changeToPassText=function(t){if(this.$TextField[20]){for(var e="",r=0,i=t.length;i>r;r++)switch(t.charAt(r)){case"\n":e+="\n";break;case"\r":break;default:e+="*"}return e}return t},n.prototype.setMiddleStyle=function(t){this.$TextField[18]=!0,this.$TextField[38]=!0,this.textArr=t,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.$getLinesArr(),t.nativeRender?egret_native.nrGetTextWidth(this.$nativeDisplayObject.id):this.$TextField[5]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.$getLinesArr(),t.nativeRender?egret_native.nrGetTextHeight(this.$nativeDisplayObject.id):t.TextFieldUtils.$getTextHeight(this)},enumerable:!0,configurable:!0}),n.prototype.appendText=function(t){this.appendElement({text:t})},n.prototype.appendElement=function(e){var r=this.$TextField[13]+e.text;return t.nativeRender?(this.textArr.push(e),this.$TextField[13]=r,this.$TextField[18]=!0,this.$TextField[38]=!0,void this.$nativeDisplayObject.setTextFlow(this.textArr)):void(this.$TextField[20]?this.$setBaseText(r):(this.$TextField[13]=r,this.textArr.push(e),this.setMiddleStyle(this.textArr)))},n.prototype.$getLinesArr=function(){var e=this.$TextField;return t.nativeRender&&e[38]?(egret_native.updateNativeRender(),void(e[38]=!1)):this.$getLinesArr2()},n.prototype.$getLinesArr2=function(){var i=this.$TextField;if(!i[18])return this.linesArr;i[18]=!1;var n=this.textArr;this.linesArr.length=0,i[6]=0,i[5]=0;var o=i[3];if(!isNaN(o)&&0==o)return i[29]=0,[{width:0,height:0,charNum:0,elements:[],hasNextLine:!1}];for(var a,s=this.linesArr,c=0,h=0,u=0,l=0,p=0,d=n.length;d>p;p++){var f=n[p];if(f.text){f.style=f.style||{};for(var g=f.text.toString(),v=g.split(/(?:\r\n|\r|\n)/),y=0,m=v.length;m>y;y++){null==s[l]&&(a={width:0,height:0,elements:[],charNum:0,hasNextLine:!1},s[l]=a,c=0,u=0,h=0),u=i[24]==t.TextFieldType.INPUT?i[0]:Math.max(u,f.style.size||i[0]);var $=!0;if(""==v[y])y==m-1&&($=!1);else{var b=e(v[y],i,f.style);if(isNaN(o))c+=b,h+=v[y].length,a.elements.push({width:b,text:v[y],style:f.style}),y==m-1&&($=!1);else if(o>=c+b)a.elements.push({width:b,text:v[y],style:f.style}),c+=b,h+=v[y].length,y==m-1&&($=!1);else{var _=0,x=0,T=v[y],E=void 0;E=i[19]?T.split(r):T.match(/./g);for(var w=E.length,S=0;w>_;_++){var D=E[_].length,R=!1;if(1==D&&w-1>_){var C=E[_].charCodeAt(0),P=E[_+1].charCodeAt(0);if(C>=55296&&56319>=C&&56320==(64512&P)){var O=E[_]+E[_+1];D=2,R=!0,b=e(O,i,f.style)}else b=e(E[_],i,f.style)}else b=e(E[_],i,f.style);if(0!=c&&c+b>o&&c+_!=0)break;if(x+b>o)for(var L=E[_].match(/./g),M=0,A=L.length;A>M;M++){var D=L[M].length,I=!1;if(1==D&&A-1>M){var C=L[M].charCodeAt(0),P=L[M+1].charCodeAt(0);if(C>=55296&&56319>=C&&56320==(64512&P)){var O=L[M]+L[M+1];D=2,I=!0,b=e(O,i,f.style)}else b=e(L[M],i,f.style)}else b=e(L[M],i,f.style);if(M>0&&c+b>o)break;S+=D,x+=b,c+=b,h+=S,I&&M++}else S+=D,x+=b,c+=b,h+=S;R&&_++}if(_>0){a.elements.push({width:x,text:T.substring(0,S),style:f.style});var F=T.substring(S),B=void 0,k=F.length;for(B=0;k>B&&" "==F.charAt(B);B++);v[y]=F.substring(B)}""!=v[y]&&(y--,$=!1)}}$&&(h++,a.hasNextLine=!0),y<v.length-1&&(a.width=c,a.height=u,a.charNum=h,i[5]=Math.max(i[5],c),i[6]+=u,l++)}p==n.length-1&&a&&(a.width=c,a.height=u,a.charNum=h,i[5]=Math.max(i[5],c),i[6]+=u)}else a&&(a.width=c,a.height=u,a.charNum=h,i[5]=Math.max(i[5],c),i[6]+=u)}return i[29]=s.length,s},n.prototype.$setIsTyping=function(e){this.$isTyping=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setIsTyping(e)},n.prototype.drawText=function(){var e=this.textNode,r=this.$TextField;e.bold=r[15],e.fontFamily=r[8]||n.default_fontFamily,e.italic=r[16],e.size=r[0],e.stroke=r[27],e.strokeColor=r[25],e.textColor=r[2];var i=this.$getLinesArr();if(0==r[5])return[];var o=isNaN(r[3])?r[5]:r[3],a=t.TextFieldUtils.$getTextHeight(this),s=0,c=t.TextFieldUtils.$getStartLine(this),h=r[4];if(!isNaN(h)&&h>a){var u=t.TextFieldUtils.$getValign(this);s+=u*(h-a)}s=Math.round(s);for(var l=t.TextFieldUtils.$getHalign(this),p=0,d=[],f=c,g=r[29];g>f;f++){var v=i[f],y=v.height;if(s+=y/2,f!=c){if(r[24]==t.TextFieldType.INPUT&&!r[30])break;if(!isNaN(h)&&s>h)break}p=Math.round((o-v.width)*l);for(var m=0,$=v.elements.length;$>m;m++){var b=v.elements[m],_=b.style.size||r[0];e.drawText(p,s+(y-_)/2,b.text,b.style),b.style.underline&&d.push(p,s+y/2,b.width,b.style.textColor),p+=b.width}s+=y/2+r[1]}return d},n.prototype.addEvent=function(){this.addEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.removeEvent=function(){this.removeEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.onTapHandler=function(e){if(this.$TextField[24]!=t.TextFieldType.INPUT){var r=t.TextFieldUtils.$getTextElement(this,e.localX,e.localY);if(null!=r){var i=r.style;if(i&&i.href)if(i.href.match(/^event:/)){var n=i.href.match(/^event:/)[0];t.TextEvent.dispatchTextEvent(this,t.TextEvent.LINK,i.href.substring(n.length))}else open(i.href,i.target||"_blank")}}},n.default_fontFamily="Arial",n.default_size=30,n.default_textColor=16777215,n}(t.DisplayObject);t.TextField=i,__reflect(i.prototype,"egret.TextField")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.TEL="tel",t.PASSWORD="password",t}();t.TextFieldInputType=e,__reflect(e.prototype,"egret.TextFieldInputType")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.DYNAMIC="dynamic",t.INPUT="input",t}();t.TextFieldType=e,__reflect(e.prototype,"egret.TextFieldType")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.$getStartLine=function(t){var r=t.$TextField,i=e.$getTextHeight(t),n=0,o=r[4];return isNaN(o)||(o>i||i>o&&(n=Math.max(r[28]-1,0),n=Math.min(r[29]-1,n)),r[30]||(n=Math.max(r[28]-1,0),r[29]>0&&(n=Math.min(r[29]-1,n)))),n},e.$getHalign=function(e){var r=e.$getLinesArr2(),i=0;return e.$TextField[9]==t.HorizontalAlign.CENTER?i=.5:e.$TextField[9]==t.HorizontalAlign.RIGHT&&(i=1),e.$TextField[24]==t.TextFieldType.INPUT&&!e.$TextField[30]&&r.length>1&&(i=0),i},e.$getTextHeight=function(e){var r=t.TextFieldType.INPUT!=e.$TextField[24]||e.$TextField[30]?e.$TextField[6]+(e.$TextField[29]-1)*e.$TextField[1]:e.$TextField[0];return r},e.$getValign=function(r){var i=e.$getTextHeight(r),n=r.$TextField[4];if(!isNaN(n)&&n>i){var o=0;return r.$TextField[10]==t.VerticalAlign.MIDDLE?o=.5:r.$TextField[10]==t.VerticalAlign.BOTTOM&&(o=1),o}return 0},e.$getTextElement=function(t,r,i){var n=e.$getHit(t,r,i),o=t.$getLinesArr2();return n&&o[n.lineIndex]&&o[n.lineIndex].elements[n.textElementIndex]?o[n.lineIndex].elements[n.textElementIndex]:null},e.$getHit=function(t,r,i){var n=t.$getLinesArr2();if(0==t.$TextField[3])return null;var o=0,a=e.$getTextHeight(t),s=0,c=t.$TextField[4];if(!isNaN(c)&&c>a){var h=e.$getValign(t);s=h*(c-a),0!=s&&(i-=s)}for(var u=e.$getStartLine(t),l=0,p=u;p<n.length;p++){var d=n[p];if(l+d.height>=i){i>l&&(o=p+1);break}if(l+=d.height,l+t.$TextField[1]>i)return null;l+=t.$TextField[1]}if(0==o)return null;var f=n[o-1],g=t.$TextField[3];isNaN(g)&&(g=t.textWidth);var v=e.$getHalign(t);r-=v*(g-f.width);for(var y=0,p=0;p<f.elements.length;p++){var m=f.elements[p];if(y+m.width<=r)y+=m.width;else if(r>y)return{lineIndex:o-1,textElementIndex:p}}return null},e.$getScrollNum=function(t){var e=1;if(t.$TextField[30]){var r=t.height,i=t.size,n=t.lineSpacing;e=Math.floor(r/(i+n));var o=r-(i+n)*e;o>i/2&&e++}return e},e}();t.TextFieldUtils=e,__reflect(e.prototype,"egret.TextFieldUtils")}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TOP="top",t.BOTTOM="bottom",t.MIDDLE="middle",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.VerticalAlign=e,__reflect(e.prototype,"egret.VerticalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.encode=function(t){for(var e=new Uint8Array(t),r=e.length,i="",n=0;r>n;n+=3)i+=chars[e[n]>>2],i+=chars[(3&e[n])<<4|e[n+1]>>4],i+=chars[(15&e[n+1])<<2|e[n+2]>>6],i+=chars[63&e[n+2]];return r%3===2?i=i.substring(0,i.length-1)+"=":r%3===1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(t){var e=.75*t.length,r=t.length,i=0,n=0,o=0,a=0,s=0;"="===t[t.length-1]&&(e--,"="===t[t.length-2]&&e--);for(var c=new ArrayBuffer(e),h=new Uint8Array(c),u=0;r>u;u+=4)n=lookup[t.charCodeAt(u)],o=lookup[t.charCodeAt(u+1)],a=lookup[t.charCodeAt(u+2)],s=lookup[t.charCodeAt(u+3)],h[i++]=n<<2|o>>4,h[i++]=(15&o)<<4|a>>2,h[i++]=(3&a)<<6|63&s;return c},t}();t.Base64Util=e,__reflect(e.prototype,"egret.Base64Util")}(egret||(egret={}));for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;var egret;!function(t){var e=function(){function t(){}return t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t}();t.Endian=e,__reflect(e.prototype,"egret.Endian");var r=function(){function r(t,r){void 0===r&&(r=0),this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,0>r&&(r=0),this.bufferExtSize=r;var i,n=0;if(t){var o=void 0;if(t instanceof Uint8Array?(o=t,n=t.length):(n=t.byteLength,o=new Uint8Array(t)),0==r)i=new Uint8Array(n);else{var a=(n/r|0)+1;i=new Uint8Array(a*r)}i.set(o)}else i=new Uint8Array(r);this.write_position=n,this._position=0,this._bytes=i,this.data=new DataView(i.buffer),this.endian=e.BIG_ENDIAN}return Object.defineProperty(r.prototype,"endian",{get:function(){return 0==this.$endian?e.LITTLE_ENDIAN:e.BIG_ENDIAN},set:function(t){this.$endian=t==e.LITTLE_ENDIAN?0:1},enumerable:!0,configurable:!0}),r.prototype.setArrayBuffer=function(t){},Object.defineProperty(r.prototype,"readAvailable",{get:function(){return this.write_position-this._position},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buffer",{get:function(){return this.data.buffer.slice(0,this.write_position)},set:function(t){var e,r=t.byteLength,i=new Uint8Array(t),n=this.bufferExtSize;if(0==n)e=new Uint8Array(r);else{var o=(r/n|0)+1;e=new Uint8Array(o*n)}e.set(i),this.write_position=r,this._bytes=e,this.data=new DataView(e.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rawBuffer",{get:function(){return this.data.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataView",{get:function(){return this.data},set:function(t){this.buffer=t.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,t>this.write_position&&(this.write_position=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){return this.write_position},set:function(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)},enumerable:!0,configurable:!0}),r.prototype._validateBuffer=function(t){if(this.data.byteLength<t){var e=this.bufferExtSize,r=void 0;if(0==e)r=new Uint8Array(t);else{var i=((t/e>>0)+1)*e;r=new Uint8Array(i)}r.set(this._bytes),this._bytes=r,this.data=new DataView(r.buffer)}},Object.defineProperty(r.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),r.prototype.clear=function(){var t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0},r.prototype.readBoolean=function(){return this.validate(1)?!!this._bytes[this.position++]:void 0},r.prototype.readByte=function(){return this.validate(1)?this.data.getInt8(this.position++):void 0},r.prototype.readBytes=function(e,r,i){if(void 0===r&&(r=0),void 0===i&&(i=0),e){var n=this._position,o=this.write_position-n;if(0>o)return void t.$error(1025);if(0==i)i=o;else if(i>o)return void t.$error(1025);var a=e._position;e._position=0,e.validateBuffer(r+i),e._position=a,e._bytes.set(this._bytes.subarray(n,n+i),r),this.position+=i}},r.prototype.readDouble=function(){if(this.validate(8)){var t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}},r.prototype.readFloat=function(){if(this.validate(4)){var t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}},r.prototype.readInt=function(){if(this.validate(4)){var t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}},r.prototype.readShort=function(){if(this.validate(2)){var t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}},r.prototype.readUnsignedByte=function(){return this.validate(1)?this._bytes[this.position++]:void 0},r.prototype.readUnsignedInt=function(){if(this.validate(4)){var t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}},r.prototype.readUnsignedShort=function(){if(this.validate(2)){var t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}},r.prototype.readUTF=function(){var t=this.readUnsignedShort();return t>0?this.readUTFBytes(t):""},r.prototype.readUTFBytes=function(t){if(this.validate(t)){var e=this.data,r=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(r)}},r.prototype.writeBoolean=function(t){this.validateBuffer(1),this._bytes[this.position++]=+t},r.prototype.writeByte=function(t){this.validateBuffer(1),this._bytes[this.position++]=255&t},r.prototype.writeBytes=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=0);var i;0>e||0>r||(i=0==r?t.length-e:Math.min(t.length-e,r),i>0&&(this.validateBuffer(i),this._bytes.set(t._bytes.subarray(e,e+i),this._position),this.position=this._position+i))},r.prototype.writeDouble=function(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8},r.prototype.writeFloat=function(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4},r.prototype.writeInt=function(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4},r.prototype.writeShort=function(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2},r.prototype.writeUnsignedInt=function(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4},r.prototype.writeUnsignedShort=function(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2},r.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),r=e.length;this.validateBuffer(2+r),this.data.setUint16(this._position,r,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)},r.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},r.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},r.prototype._writeUint8Array=function(t,e){void 0===e&&(e=!0);var r=this._position,i=r+t.length;e&&this.validateBuffer(i),this.bytes.set(t,r),this.position=i},r.prototype.validate=function(e){var r=this._bytes.length;return r>0&&this._position+e<=r?!0:void t.$error(1025)},r.prototype.validateBuffer=function(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)},r.prototype.encodeUTF8=function(t){for(var e=0,r=this.stringToCodePoints(t),i=[];r.length>e;){var n=r[e++];if(this.inRange(n,55296,57343))this.encoderError(n);else if(this.inRange(n,0,127))i.push(n);else{var o=void 0,a=void 0;for(this.inRange(n,128,2047)?(o=1,a=192):this.inRange(n,2048,65535)?(o=2,a=224):this.inRange(n,65536,1114111)&&(o=3,a=240),i.push(this.div(n,Math.pow(64,o))+a);o>0;){var s=this.div(n,Math.pow(64,o-1));i.push(128+s%64),o-=1}}}return new Uint8Array(i)},r.prototype.decodeUTF8=function(t){for(var e,r=!1,i=0,n="",o=0,a=0,s=0,c=0;t.length>i;){var h=t[i++];if(h==this.EOF_byte)e=0!=a?this.decoderError(r):this.EOF_code_point;else if(0==a)this.inRange(h,0,127)?e=h:(this.inRange(h,194,223)?(a=1,c=128,o=h-192):this.inRange(h,224,239)?(a=2,c=2048,o=h-224):this.inRange(h,240,244)?(a=3,c=65536,o=h-240):this.decoderError(r),o*=Math.pow(64,a),e=null);else if(this.inRange(h,128,191))if(s+=1,o+=(h-128)*Math.pow(64,a-s),s!==a)e=null;else{var u=o,l=c;o=0,a=0,s=0,c=0,e=this.inRange(u,l,1114111)&&!this.inRange(u,55296,57343)?u:this.decoderError(r,h)}else o=0,a=0,s=0,c=0,i--,e=this.decoderError(r,h);null!==e&&e!==this.EOF_code_point&&(65535>=e?e>0&&(n+=String.fromCharCode(e)):(e-=65536,n+=String.fromCharCode(55296+(e>>10&1023)),n+=String.fromCharCode(56320+(1023&e))))}return n},r.prototype.encoderError=function(e){t.$error(1026,e)},r.prototype.decoderError=function(e,r){return e&&t.$error(1027),r||65533},r.prototype.inRange=function(t,e,r){return t>=e&&r>=t},r.prototype.div=function(t,e){return Math.floor(t/e)},r.prototype.stringToCodePoints=function(t){for(var e=[],r=0,i=t.length;r<t.length;){var n=t.charCodeAt(r);if(this.inRange(n,55296,57343))if(this.inRange(n,56320,57343))e.push(65533);else if(r==i-1)e.push(65533);else{var o=t.charCodeAt(r+1);if(this.inRange(o,56320,57343)){var a=1023&n,s=1023&o;r+=1,e.push(65536+(a<<10)+s)}else e.push(65533)}else e.push(n);r+=1}return e},r}();t.ByteArray=r,__reflect(r.prototype,"egret.ByteArray")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$graphics=new t.Graphics,r.$graphics.$setTarget(r),r}return __extends(r,e),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(9)},Object.defineProperty(r.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),r.prototype.$hitTest=function(e,r){if(!this.$visible)return null;var i=this.$getInvertedConcatenatedMatrix(),n=i.a*e+i.c*r+i.tx,o=i.b*e+i.d*r+i.ty,a=this.$scrollRect?this.$scrollRect:this.$maskRect;if(a&&!a.contains(n,o))return null;if(this.$mask&&!this.$mask.$hitTest(e,r))return null;for(var s=this.$children,c=!1,h=null,u=s.length-1;u>=0;u--){var l=s[u];if(!l.$maskedObject&&(h=l.$hitTest(e,r))){if(c=!0,h.$touchEnabled)break;h=null}}return h?this.$touchChildren?h:this:c?this:(h=t.DisplayObject.prototype.$hitTest.call(this,e,r),h&&(h=this.$graphics.$hitTest(e,r)),h)},r.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},r}(t.DisplayObjectContainer);t.Sprite=e,__reflect(e.prototype,"egret.Sprite")}(egret||(egret={}));var egret;!function(t){function e(t,e,r){var i=t.prototype;Object.defineProperty(i,"__class__",{value:e,enumerable:!1,writable:!0});var n=[e];r&&(n=n.concat(r));var o=i.__types__;if(i.__types__)for(var a=o.length,s=0;a>s;s++){var c=o[s];-1==n.indexOf(c)&&n.push(c)}Object.defineProperty(i,"__types__",{value:n,enumerable:!1,writable:!0})}t.registerClass=e}(egret||(egret={}));var egret;!function(t){t.BitmapFillMode={REPEAT:"repeat",SCALE:"scale",CLIP:"clip"}}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"logLevel",{set:function(t){},enumerable:!0,configurable:!0}),t.ALL="all",t.DEBUG="debug",t.INFO="info",t.WARN="warn",t.ERROR="error",t.OFF="off",t}();t.Logger=e,__reflect(e.prototype,"egret.Logger")
}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.sin=function(e){var r=Math.floor(e),i=r+1,n=t.sinInt(r);if(r==e)return n;var o=t.sinInt(i);return(e-r)*o+(i-e)*n},t.sinInt=function(t){return t%=360,0>t&&(t+=360),egret_sin_map[t]},t.cos=function(e){var r=Math.floor(e),i=r+1,n=t.cosInt(r);if(r==e)return n;var o=t.cosInt(i);return(e-r)*o+(i-e)*n},t.cosInt=function(t){return t%=360,0>t&&(t+=360),egret_cos_map[t]},t.convertStringToHashCode=function(t){if(0===t.length)return 0;for(var e=0,r=0,i=t.length;i>r;++r){var n=t.charCodeAt(r);e=(e<<5)-e+n,e|=0}return e},t}();t.NumberUtils=e,__reflect(e.prototype,"egret.NumberUtils")}(egret||(egret={}));for(var egret_sin_map={},egret_cos_map={},DEG_TO_RAD=Math.PI/180,NumberUtils_i=0;360>NumberUtils_i;NumberUtils_i++)egret_sin_map[NumberUtils_i]=Math.sin(NumberUtils_i*DEG_TO_RAD),egret_cos_map[NumberUtils_i]=Math.cos(NumberUtils_i*DEG_TO_RAD);egret_sin_map[90]=1,egret_cos_map[90]=0,egret_sin_map[180]=0,egret_cos_map[180]=-1,egret_sin_map[270]=-1,egret_cos_map[270]=0,Function.prototype.bind||(Function.prototype.bind=function(t){"function"!=typeof this&&egret.$error(1029);var e=Array.prototype.slice.call(arguments,1),r=this,i=function(){},n=function(){return r.apply(this instanceof i&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,n.prototype=new i,n});var egret;!function(t){var e=function(e){function r(t,r){void 0===r&&(r=0);var i=e.call(this)||this;return i._delay=0,i._currentCount=0,i._running=!1,i.updateInterval=1e3,i.lastCount=1e3,i.lastTimeStamp=0,i.delay=t,i.repeatCount=0|+r,i}return __extends(r,e),Object.defineProperty(r.prototype,"delay",{get:function(){return this._delay},set:function(t){1>t&&(t=1),this._delay!=t&&(this._delay=t,this.lastCount=this.updateInterval=Math.round(60*t))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),r.prototype.reset=function(){this.stop(),this._currentCount=0},r.prototype.start=function(){this._running||(this.lastCount=this.updateInterval,this.lastTimeStamp=t.getTimer(),t.ticker.$startTick(this.$update,this),this._running=!0)},r.prototype.stop=function(){this._running&&(t.stopTick(this.$update,this),this._running=!1)},r.prototype.$update=function(e){var r=e-this.lastTimeStamp;if(r>=this._delay)this.lastCount=this.updateInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return!1;this.lastCount+=this.updateInterval}this.lastTimeStamp=e,this._currentCount++;var i=this.repeatCount>0&&this._currentCount>=this.repeatCount;return(0==this.repeatCount||this._currentCount<=this.repeatCount)&&t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER),i&&(this.stop(),t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER_COMPLETE)),!1},r}(t.EventDispatcher);t.Timer=e,__reflect(e.prototype,"egret.Timer")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(e,r){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];t.$callLaterFunctionList.push(e),t.$callLaterThisList.push(r),t.$callLaterArgsList.push(i)}function r(e,r){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];t.$callAsyncFunctionList.push(e),t.$callAsyncThisList.push(r),t.$callAsyncArgsList.push(i)}t.$callLaterFunctionList=[],t.$callLaterThisList=[],t.$callLaterArgsList=[],t.callLater=e,t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[],t.$callAsync=r}(egret||(egret={}));var egret;!function(t){function e(t,e,r){for(var i=[],n=3;n<arguments.length;n++)i[n-3]=arguments[n];var o,a=t.prototype;t.hasOwnProperty("__sets__")||Object.defineProperty(t,"__sets__",{value:{}}),o=t.__sets__;var s=o[r];if(s)return s.apply(e,i);var c=Object.getPrototypeOf(a);if(null!=c){for(;!c.hasOwnProperty(r);)if(c=Object.getPrototypeOf(c),null==c)return;s=Object.getOwnPropertyDescriptor(c,r).set,o[r]=s,s.apply(e,i)}}function r(t,e,r){var i,n=t.prototype;t.hasOwnProperty("__gets__")||Object.defineProperty(t,"__gets__",{value:{}}),i=t.__gets__;var o=i[r];if(o)return o.call(e);var a=Object.getPrototypeOf(n);if(null!=a){for(;!a.hasOwnProperty(r);)if(a=Object.getPrototypeOf(a),null==a)return;return o=Object.getOwnPropertyDescriptor(a,r).get,i[r]=o,o.call(e)}}t.superSetter=e,t.superGetter=r}(egret||(egret={}));var egret;!function(t){function e(t){if(!t)return null;var e=r[t];if(e)return e;var i=t.split("."),n=i.length;e=global;for(var o=0;n>o;o++){var a=i[o];if(e=e[a],!e)return null}return r[t]=e,e}var r={};t.getDefinitionByName=e}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(t){var e=typeof t;if(!t||"object"!=e&&!t.prototype)return e;var r=t.prototype?t.prototype:Object.getPrototypeOf(t);if(r.hasOwnProperty("__class__"))return r.__class__;var i=r.constructor.toString().trim(),n=i.indexOf("("),o=i.substring(9,n);return Object.defineProperty(r,"__class__",{value:o,enumerable:!1,writable:!0}),o}t.getQualifiedClassName=e}(egret||(egret={}));var egret;!function(t){function e(e){if(!e||"object"!=typeof e&&!e.prototype)return null;var r=e.prototype?e.prototype:Object.getPrototypeOf(e),i=Object.getPrototypeOf(r);if(!i)return null;var n=t.getQualifiedClassName(i.constructor);return n?n:null}t.getQualifiedSuperclassName=e}(egret||(egret={}));var egret;!function(t){function e(){return Date.now()-t.sys.$START_TIME}t.getTimer=e}(egret||(egret={}));var egret;!function(t){function e(e){var r=t.getDefinitionByName(e);return r?!0:!1}t.hasDefinition=e}(egret||(egret={}));var egret;!function(t){function e(t,e){if(!t||"object"!=typeof t)return!1;var r=Object.getPrototypeOf(t),i=r?r.__types__:null;return i?-1!==i.indexOf(e):!1}t.is=e}(egret||(egret={}));var egret;!function(t){function e(e,r){t.ticker.$startTick(e,r)}t.startTick=e}(egret||(egret={}));var egret;!function(t){function e(e,r){t.ticker.$stopTick(e,r)}t.stopTick=e}(egret||(egret={}));var egret;!function(t){function e(t){0>t&&(t=0),t>16777215&&(t=16777215);for(var e=t.toString(16).toUpperCase();e.length>6;)e=e.slice(1,e.length);for(;e.length<6;)e="0"+e;return"#"+e}t.toColorString=e}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r},egret;!function(t){var e;!function(e){var r=function(e){function r(r){var i=e.call(this)||this;return i.onUpdate=function(e){var r=new t.GeolocationEvent(t.Event.CHANGE),n=e.coords;r.altitude=n.altitude,r.heading=n.heading,r.accuracy=n.accuracy,r.latitude=n.latitude,r.longitude=n.longitude,r.speed=n.speed,r.altitudeAccuracy=n.altitudeAccuracy,i.dispatchEvent(r)},i.onError=function(e){var r=t.GeolocationEvent.UNAVAILABLE;e.code==e.PERMISSION_DENIED&&(r=t.GeolocationEvent.PERMISSION_DENIED);var n=new t.GeolocationEvent(t.IOErrorEvent.IO_ERROR);n.errorType=r,n.errorMessage=e.message,i.dispatchEvent(n)},i.geolocation=navigator.geolocation,i}return __extends(r,e),r.prototype.start=function(){var e=this.geolocation;e?this.watchId=e.watchPosition(this.onUpdate,this.onError):this.onError({code:2,message:t.sys.tr(3004),PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2})},r.prototype.stop=function(){var t=this.geolocation;t.clearWatch(this.watchId)},r}(t.EventDispatcher);e.WebGeolocation=r,__reflect(r.prototype,"egret.web.WebGeolocation",["egret.Geolocation"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.onChange=function(e){var i=new t.MotionEvent(t.Event.CHANGE),n={x:e.acceleration.x,y:e.acceleration.y,z:e.acceleration.z},o={x:e.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y,z:e.accelerationIncludingGravity.z},a={alpha:e.rotationRate.alpha,beta:e.rotationRate.beta,gamma:e.rotationRate.gamma};i.acceleration=n,i.accelerationIncludingGravity=o,i.rotationRate=a,r.dispatchEvent(i)},r}return __extends(r,e),r.prototype.start=function(){window.addEventListener("devicemotion",this.onChange)},r.prototype.stop=function(){window.removeEventListener("devicemotion",this.onChange)},r}(t.EventDispatcher);e.WebMotion=r,__reflect(r.prototype,"egret.web.WebMotion",["egret.Motion"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){if(window.location){var e=location.search;if(""==e)return"";e=e.slice(1);for(var r=e.split("&"),i=r.length,n=0;i>n;n++){var o=r[n],a=o.split("=");if(a[0]==t)return a[1]}}return""}e.getOption=r,t.getOption=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(e){var i=r.call(this)||this;return i.$startTime=0,i.audio=null,i.isStopped=!1,i.canPlay=function(){i.audio.removeEventListener("canplay",i.canPlay);try{i.audio.currentTime=i.$startTime}catch(t){}finally{i.audio.play()}},i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(t.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i._volume=1,e.addEventListener("ended",i.onPlayEnd),i.audio=e,i}return __extends(i,r),i.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);try{this.audio.volume=this._volume,this.audio.currentTime=this.$startTime}catch(e){return void this.audio.addEventListener("canplay",this.canPlay)}this.audio.play()},i.prototype.stop=function(){if(this.audio){this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0;var r=this.audio;r.removeEventListener("ended",this.onPlayEnd),r.removeEventListener("canplay",this.canPlay),r.volume=0,this._volume=0,this.audio=null;var i=this.$url;window.setTimeout(function(){r.pause(),e.HtmlSound.$recycle(i,r)},200)}},Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.isStopped?void t.$error(1036):(this._volume=e,void(this.audio&&(this.audio.volume=e)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.audio?this.audio.currentTime:0},enumerable:!0,configurable:!0}),i}(t.EventDispatcher);e.HtmlSoundChannel=r,__reflect(r.prototype,"egret.web.HtmlSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(){function e(){}return e.decodeAudios=function(){if(!(e.decodeArr.length<=0||e.isDecoding)){e.isDecoding=!0;var r=e.decodeArr.shift();e.ctx.decodeAudioData(r.buffer,function(t){r.self.audioBuffer=t,r.success&&r.success(),e.isDecoding=!1,e.decodeAudios()},function(){t.log("sound decode error"),r.fail&&r.fail(),e.isDecoding=!1,e.decodeAudios()})}},e.decodeArr=[],e.isDecoding=!1,e}();e.WebAudioDecode=r,__reflect(r.prototype,"egret.web.WebAudioDecode");var i=function(i){function n(){var t=i.call(this)||this;return t.loaded=!1,t}return __extends(n,i),Object.defineProperty(n.prototype,"length",{get:function(){if(this.audioBuffer)return this.audioBuffer.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),n.prototype.load=function(e){function i(){o.loaded=!0,o.dispatchEventWith(t.Event.COMPLETE)}function n(){o.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}var o=this;this.url=e;var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.addEventListener("load",function(){var e=a.status>=400;e?o.dispatchEventWith(t.IOErrorEvent.IO_ERROR):(r.decodeArr.push({buffer:a.response,success:i,fail:n,self:o,url:o.url}),r.decodeAudios())}),a.addEventListener("error",function(){o.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}),a.send()},n.prototype.play=function(r,i){r=+r||0,i=+i||0;var n=new e.WebAudioSoundChannel;return n.$url=this.url,n.$loops=i,n.$audioBuffer=this.audioBuffer,n.$startTime=r,n.$play(),t.sys.$pushSoundChannel(n),n},n.prototype.close=function(){},n.MUSIC="music",n.EFFECT="effect",n}(t.EventDispatcher);e.WebAudioSound=i,__reflect(i.prototype,"egret.web.WebAudioSound",["egret.Sound"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var i=r.call(this)||this;return i.$startTime=0,i.bufferSource=null,i.context=e.WebAudioDecode.ctx,i.isStopped=!1,i._currentTime=0,i._volume=1,i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(t.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i._startTime=0,i.context.createGain?i.gain=i.context.createGain():i.gain=i.context.createGainNode(),i}return __extends(i,r),i.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);this.bufferSource&&(this.bufferSource.onended=null,this.bufferSource=null);var e=this.context,r=this.gain,i=e.createBufferSource();this.bufferSource=i,i.buffer=this.$audioBuffer,i.connect(r),r.connect(e.destination),i.onended=this.onPlayEnd,this._startTime=Date.now(),this.gain.gain.value=this._volume,i.start(0,this.$startTime),this._currentTime=0},i.prototype.stop=function(){if(this.bufferSource){var e=this.bufferSource;e.stop?e.stop(0):e.noteOff(0),e.onended=null,e.disconnect(),this.bufferSource=null,this.$audioBuffer=null}this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0},Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.isStopped?void t.$error(1036):(this._volume=e,void(this.gain.gain.value=e))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.bufferSource?(Date.now()-this._startTime)/1e3+this.$startTime:0},enumerable:!0,configurable:!0}),i}(t.EventDispatcher);e.WebAudioSoundChannel=r,__reflect(r.prototype,"egret.web.WebAudioSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(r,i){void 0===i&&(i=!0);var n=e.call(this)||this;return n.loaded=!1,n.closed=!1,n.heightSet=0/0,n.widthSet=0/0,n.waiting=!1,n.userPause=!1,n.userPlay=!1,n.isPlayed=!1,n.screenChanged=function(e){var r=document.fullscreenEnabled||document.webkitIsFullScreen;r||(n.checkFullScreen(!1),t.Capabilities.isMobile||(n._fullscreen=r))},n._fullscreen=!0,n.onVideoLoaded=function(){n.video.removeEventListener("canplay",n.onVideoLoaded);var e=n.video;n.loaded=!0,n.posterData&&(n.posterData.width=n.getPlayWidth(),n.posterData.height=n.getPlayHeight()),e.width=e.videoWidth,e.height=e.videoHeight,window.setTimeout(function(){n.dispatchEventWith(t.Event.COMPLETE)},200)},n.$renderNode=new t.sys.BitmapNode,n.src=r,n.once(t.Event.ADDED_TO_STAGE,n.loadPoster,n),r&&n.load(),n}return __extends(r,e),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(1)},r.prototype.load=function(e,r){var i=this;if(void 0===r&&(r=!0),e=e||this.src,this.src=e,!this.video||this.video.src!=e){var n;!this.video||t.Capabilities.isMobile?(n=document.createElement("video"),this.video=n,n.controls=null):n=this.video,n.src=e,n.setAttribute("autoplay","autoplay"),n.setAttribute("webkit-playsinline","true"),n.addEventListener("canplay",this.onVideoLoaded),n.addEventListener("error",function(){return i.onVideoError()}),n.addEventListener("ended",function(){return i.onVideoEnded()});var o=!1;n.addEventListener("canplay",function(){i.waiting=!1,o?i.userPause?i.pause():i.userPlay&&i.play():(o=!0,n.pause())}),n.addEventListener("waiting",function(){i.waiting=!0}),n.load(),this.videoPlay(),n.style.position="absolute",n.style.top="0px",n.style.zIndex="-88888",n.style.left="0px",n.height=1,n.width=1}},r.prototype.play=function(e,r){var i=this;if(void 0===r&&(r=!1),0==this.loaded)return this.load(this.src),void this.once(t.Event.COMPLETE,function(t){return i.play(e,r)},this);this.isPlayed=!0;var n=this.video;void 0!=e&&(n.currentTime=+e||0),n.loop=!!r,t.Capabilities.isMobile?n.style.zIndex="-88888":n.style.zIndex="9999",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.height=n.videoHeight,n.width=n.videoWidth,"Windows PC"!=t.Capabilities.os&&"Mac OS"!=t.Capabilities.os&&window.setTimeout(function(){n.width=0},1e3),this.checkFullScreen(this._fullscreen)},r.prototype.videoPlay=function(){return this.userPause=!1,this.waiting?void(this.userPlay=!0):(this.userPlay=!1,void this.video.play())},r.prototype.checkFullScreen=function(e){var r=this.video;if(e)null==r.parentElement&&(r.removeAttribute("webkit-playsinline"),document.body.appendChild(r)),t.stopTick(this.markDirty,this),this.goFullscreen();else if(null!=r.parentElement&&r.parentElement.removeChild(r),r.setAttribute("webkit-playsinline","true"),this.setFullScreenMonitor(!1),t.startTick(this.markDirty,this),t.Capabilities.isMobile)return this.video.currentTime=0,void this.onVideoEnded();this.videoPlay()},r.prototype.goFullscreen=function(){var e,r=this.video;return e=t.web.getPrefixStyleName("requestFullscreen",r),r[e]||(e=t.web.getPrefixStyleName("requestFullScreen",r),r[e])?(r.removeAttribute("webkit-playsinline"),r[e](),this.setFullScreenMonitor(!0),!0):!0},r.prototype.setFullScreenMonitor=function(t){var e=this.video;t?(e.addEventListener("mozfullscreenchange",this.screenChanged),e.addEventListener("webkitfullscreenchange",this.screenChanged),e.addEventListener("mozfullscreenerror",this.screenError),e.addEventListener("webkitfullscreenerror",this.screenError)):(e.removeEventListener("mozfullscreenchange",this.screenChanged),e.removeEventListener("webkitfullscreenchange",this.screenChanged),e.removeEventListener("mozfullscreenerror",this.screenError),e.removeEventListener("webkitfullscreenerror",this.screenError))},r.prototype.screenError=function(){t.$error(3014)},r.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.oCancelFullScreen?document.oCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},r.prototype.onVideoEnded=function(){this.pause(),this.isPlayed=!1,this.dispatchEventWith(t.Event.ENDED)},r.prototype.onVideoError=function(){this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},r.prototype.close=function(){var t=this;this.closed=!0,this.video.removeEventListener("canplay",this.onVideoLoaded),this.video.removeEventListener("error",function(){return t.onVideoError()}),this.video.removeEventListener("ended",function(){return t.onVideoEnded()}),this.pause(),0==this.loaded&&this.video&&(this.video.src=""),this.video&&this.video.parentElement&&(this.video.parentElement.removeChild(this.video),this.video=null),this.loaded=!1},r.prototype.pause=function(){return this.userPlay=!1,this.waiting?void(this.userPause=!0):(this.userPause=!1,this.video.pause(),void t.stopTick(this.markDirty,this))},Object.defineProperty(r.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(t){this.video&&(this.video.volume=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this.video?this.video.currentTime:0},set:function(t){this.video&&(this.video.currentTime=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(e){t.Capabilities.isMobile||(this._fullscreen=!!e,this.video&&0==this.video.paused&&this.checkFullScreen(this._fullscreen))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bitmapData",{get:function(){return this.video&&this.loaded?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=new t.BitmapData(this.video),this._bitmapData.$deleteSource=!1),this._bitmapData):null},enumerable:!0,configurable:!0}),r.prototype.loadPoster=function(){var e=this,r=this.poster;if(r){var i=new t.ImageLoader;i.once(t.Event.COMPLETE,function(r){if(i.data,e.posterData=i.data,e.$renderDirty=!0,e.posterData.width=e.getPlayWidth(),e.posterData.height=e.getPlayHeight(),t.nativeRender){var n=new t.Texture;n._setBitmapData(e.posterData),e.$nativeDisplayObject.setTexture(n)}},this),i.load(r)}},r.prototype.$measureContentBounds=function(t){var e=this.bitmapData,r=this.posterData;e?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):r?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):t.setEmpty()},r.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:0/0:this.widthSet},r.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:0/0:this.heightSet},r.prototype.$updateRenderNode=function(){var e=this.$renderNode,r=this.bitmapData,i=this.posterData,n=this.getPlayWidth(),o=this.getPlayHeight();this.isPlayed&&!t.Capabilities.isMobile||!i?this.isPlayed&&r&&(e.image=r,e.imageWidth=r.width,e.imageHeight=r.height,t.WebGLUtils.deleteWebGLTexture(r.webGLTexture),r.webGLTexture=null,e.drawImage(0,0,r.width,r.height,0,0,n,o)):(e.image=i,e.imageWidth=n,e.imageHeight=o,e.drawImage(0,0,i.width,i.height,0,0,n,o))},r.prototype.markDirty=function(){return this.$renderDirty=!0,!0},r.prototype.$setHeight=function(t){if(this.heightSet=t,this.paused){var r=this;this.$renderDirty=!0,window.setTimeout(function(){r.$renderDirty=!1},200)}e.prototype.$setHeight.call(this,t)},r.prototype.$setWidth=function(t){if(this.widthSet=t,this.paused){var r=this;this.$renderDirty=!0,window.setTimeout(function(){r.$renderDirty=!1},200)}e.prototype.$setWidth.call(this,t)},Object.defineProperty(r.prototype,"paused",{get:function(){return this.video?this.video.paused:!0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){if(this.video)return this.video.duration;throw new Error("Video not loaded!")},enumerable:!0,configurable:!0}),r}(t.DisplayObject);e.WebVideo=r,__reflect(r.prototype,"egret.web.WebVideo",["egret.Video","egret.DisplayObject"]),t.Video=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t.timeout=0,t._url="",t._method="",t}return __extends(r,e),Object.defineProperty(r.prototype,"response",{get:function(){if(!this._xhr)return null;if(void 0!=this._xhr.response)return this._xhr.response;if("text"==this._responseType)return this._xhr.responseText;if("arraybuffer"==this._responseType&&/msie 9.0/i.test(navigator.userAgent)){var t=window;return t.convertResponseBodyToText(this._xhr.responseBody)}return"document"==this._responseType?this._xhr.responseXML:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"responseType",{get:function(){return this._responseType},set:function(t){this._responseType=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(t){this._withCredentials=t},enumerable:!0,configurable:!0}),r.prototype.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},r.prototype.open=function(t,e){void 0===e&&(e="GET"),this._url=t,this._method=e,this._xhr&&(this._xhr.abort(),this._xhr=null);var r=this.getXHR();window.XMLHttpRequest?(r.addEventListener("load",this.onload.bind(this)),r.addEventListener("error",this.onerror.bind(this))):r.onreadystatechange=this.onReadyStateChange.bind(this),r.onprogress=this.updateProgress.bind(this),r.ontimeout=this.onTimeout.bind(this),r.open(this._method,this._url,!0),this._xhr=r},r.prototype.send=function(t){if(null!=this._responseType&&(this._xhr.responseType=this._responseType),null!=this._withCredentials&&(this._xhr.withCredentials=this._withCredentials),this.headerObj)for(var e in this.headerObj)this._xhr.setRequestHeader(e,this.headerObj[e]);this._xhr.timeout=this.timeout,this._xhr.send(t)},r.prototype.abort=function(){this._xhr&&this._xhr.abort()},r.prototype.getAllResponseHeaders=function(){if(!this._xhr)return null;var t=this._xhr.getAllResponseHeaders();return t?t:""},r.prototype.setRequestHeader=function(t,e){this.headerObj||(this.headerObj={}),this.headerObj[t]=e},r.prototype.getResponseHeader=function(t){if(!this._xhr)return null;var e=this._xhr.getResponseHeader(t);return e?e:""},r.prototype.onTimeout=function(){this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},r.prototype.onReadyStateChange=function(){var e=this._xhr;if(4==e.readyState){var r=e.status>=400||0==e.status,i=(this._url,this);window.setTimeout(function(){r?i.dispatchEventWith(t.IOErrorEvent.IO_ERROR):i.dispatchEventWith(t.Event.COMPLETE)},0)}},r.prototype.updateProgress=function(e){e.lengthComputable&&t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.PROGRESS,e.loaded,e.total)},r.prototype.onload=function(){var e=this,r=this._xhr,i=(this._url,r.status>=400);window.setTimeout(function(){i?e.dispatchEventWith(t.IOErrorEvent.IO_ERROR):e.dispatchEventWith(t.Event.COMPLETE)},0)},r.prototype.onerror=function(){var e=(this._url,this);window.setTimeout(function(){e.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},0)},r}(t.EventDispatcher);e.WebHttpRequest=r,__reflect(r.prototype,"egret.web.WebHttpRequest",["egret.HttpRequest"]),t.HttpRequest=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=window.URL||window.webkitURL,i=function(i){function n(){var t=null!==i&&i.apply(this,arguments)||this;return t.data=null,t._crossOrigin=null,t._hasCrossOriginSet=!1,t.currentImage=null,t.request=null,t}return __extends(n,i),Object.defineProperty(n.prototype,"crossOrigin",{get:function(){return this._crossOrigin},set:function(t){this._hasCrossOriginSet=!0,this._crossOrigin=t},enumerable:!0,configurable:!0}),n.prototype.load=function(r){if(e.Html5Capatibility._canUseBlob&&0!=r.indexOf("wxLocalResource:")&&0!=r.indexOf("data:")&&0!=r.indexOf("http:")&&0!=r.indexOf("https:")){var i=this.request;i||(i=this.request=new t.web.WebHttpRequest,i.addEventListener(t.Event.COMPLETE,this.onBlobLoaded,this),i.addEventListener(t.IOErrorEvent.IO_ERROR,this.onBlobError,this),i.responseType="blob"),i.open(r),i.send()}else this.loadImage(r)},n.prototype.onBlobLoaded=function(t){var e=this.request.response;this.request=void 0,this.loadImage(r.createObjectURL(e))},n.prototype.onBlobError=function(t){this.dispatchIOError(this.currentURL),this.request=void 0},n.prototype.loadImage=function(t){var e=new Image;this.data=null,this.currentImage=e,this._hasCrossOriginSet?this._crossOrigin&&(e.crossOrigin=this._crossOrigin):n.crossOrigin&&(e.crossOrigin=n.crossOrigin),e.onload=this.onImageComplete.bind(this),e.onerror=this.onLoadError.bind(this),e.src=t},n.prototype.onImageComplete=function(e){var r=this.getImage(e);if(r){this.data=new t.BitmapData(r);var i=this;window.setTimeout(function(){i.dispatchEventWith(t.Event.COMPLETE)},0)}},n.prototype.onLoadError=function(t){var e=this.getImage(t);e&&this.dispatchIOError(e.src)},n.prototype.dispatchIOError=function(e){var r=this;window.setTimeout(function(){r.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},0)},n.prototype.getImage=function(e){var i=e.target,n=i.src;if(0==n.indexOf("blob:"))try{r.revokeObjectURL(i.src)}catch(o){t.$warn(1037)}return i.onerror=null,i.onload=null,this.currentImage!==i?null:(this.currentImage=null,i)},n.crossOrigin=null,n}(t.EventDispatcher);e.WebImageLoader=i,__reflect(i.prototype,"egret.web.WebImageLoader",["egret.ImageLoader"]),t.ImageLoader=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t._isNeedShow=!1,t.inputElement=null,t.inputDiv=null,t._gscaleX=0,t._gscaleY=0,t.textValue="",t.colorValue=16777215,t._styleInfoes={},t}return __extends(r,e),r.prototype.$setTextField=function(t){return this.$textfield=t,!0},r.prototype.$addToStage=function(){this.htmlInput=t.web.$getTextAdapter(this.$textfield)},r.prototype._initElement=function(){var e=this.$textfield.localToGlobal(0,0),r=e.x,i=e.y,n=this.htmlInput.$scaleX,o=this.htmlInput.$scaleY;this.inputDiv.style.left=r*n+"px",this.inputDiv.style.top=i*o+"px",this.$textfield.multiline&&this.$textfield.height>this.$textfield.size?(this.inputDiv.style.top=i*o+"px",this.inputElement.style.top=-this.$textfield.lineSpacing/2*o+"px"):(this.inputDiv.style.top=i*o+"px",this.inputElement.style.top="0px");for(var a=this.$textfield,s=1,c=1,h=0;a.parent;)s*=a.scaleX,c*=a.scaleY,h+=a.rotation,a=a.parent;var u=t.web.getPrefixStyleName("transform");this.inputDiv.style[u]="rotate("+h+"deg)",this._gscaleX=n*s,this._gscaleY=o*c},r.prototype.$show=function(){this.htmlInput.isCurrentStageText(this)?this.inputElement.onblur=null:(this.inputElement=this.htmlInput.getInputElement(this),this.$textfield.multiline?this.inputElement.type="text":this.inputElement.type=this.$textfield.inputType,this.inputDiv=this.htmlInput._inputDIV),this.htmlInput._needShow=!0,this._isNeedShow=!0,this._initElement()},r.prototype.onBlurHandler=function(){this.htmlInput.clearInputElement(),window.scrollTo(0,0)},r.prototype.onFocusHandler=function(){var t=this;window.setTimeout(function(){t.inputElement&&t.inputElement.scrollIntoView()},200)},r.prototype.executeShow=function(){this.inputElement.value=this.$getText(),null==this.inputElement.onblur&&(this.inputElement.onblur=this.onBlurHandler.bind(this)),null==this.inputElement.onfocus&&(this.inputElement.onfocus=this.onFocusHandler.bind(this)),this.$resetStageText(),this.$textfield.maxChars>0?this.inputElement.setAttribute("maxlength",this.$textfield.maxChars):this.inputElement.removeAttribute("maxlength"),this.inputElement.selectionStart=this.inputElement.value.length,this.inputElement.selectionEnd=this.inputElement.value.length,this.inputElement.focus()},r.prototype.$hide=function(){this.htmlInput&&this.htmlInput.disconnectStageText(this)},r.prototype.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},r.prototype.$setText=function(t){return this.textValue=t,this.resetText(),!0},r.prototype.resetText=function(){this.inputElement&&(this.inputElement.value=this.textValue)},r.prototype.$setColor=function(t){return this.colorValue=t,this.resetColor(),!0},r.prototype.resetColor=function(){this.inputElement&&this.setElementStyle("color",t.toColorString(this.colorValue))},r.prototype.$onBlur=function(){},r.prototype._onInput=function(){var e=this;window.setTimeout(function(){e.inputElement&&e.inputElement.selectionStart==e.inputElement.selectionEnd&&(e.textValue=e.inputElement.value,t.Event.dispatchEvent(e,"updateText",!1))},0)},r.prototype.setAreaHeight=function(){var e=this.$textfield;if(e.multiline){var r=t.TextFieldUtils.$getTextHeight(e);if(e.height<=e.size)this.setElementStyle("height",e.size*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",e.size*this._gscaleY+"px");else if(e.height<r)this.setElementStyle("height",e.height*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px");else{this.setElementStyle("height",(r+e.lineSpacing)*this._gscaleY+"px");var i=(e.height-r)*this._gscaleY,n=t.TextFieldUtils.$getValign(e),o=i*n,a=i-o;this.setElementStyle("padding",o+"px 0px "+a+"px 0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px")}}},r.prototype._onClickHandler=function(e){this._isNeedShow&&(e.stopImmediatePropagation(),this._isNeedShow=!1,this.executeShow(),this.dispatchEvent(new t.Event("focus")))},r.prototype._onDisconnect=function(){this.inputElement=null,this.dispatchEvent(new t.Event("blur"))},r.prototype.setElementStyle=function(t,e){this.inputElement&&this._styleInfoes[t]!=e&&(this.inputElement.style[t]=e)},r.prototype.$removeFromStage=function(){this.inputElement&&this.htmlInput.disconnectStageText(this)
},r.prototype.$resetStageText=function(){if(this.inputElement){var e=this.$textfield;this.setElementStyle("fontFamily",e.fontFamily),this.setElementStyle("fontStyle",e.italic?"italic":"normal"),this.setElementStyle("fontWeight",e.bold?"bold":"normal"),this.setElementStyle("textAlign",e.textAlign),this.setElementStyle("fontSize",e.size*this._gscaleY+"px"),this.setElementStyle("color",t.toColorString(e.textColor));var r=void 0;if(e.stage?(r=e.localToGlobal(0,0).x,r=Math.min(e.width,e.stage.stageWidth-r)):r=e.width,this.setElementStyle("width",r*this._gscaleX+"px"),this.setElementStyle("verticalAlign",e.verticalAlign),e.multiline)this.setAreaHeight();else if(this.setElementStyle("lineHeight",e.size*this._gscaleY+"px"),e.height<e.size){this.setElementStyle("height",e.size*this._gscaleY+"px");var i=e.size/2*this._gscaleY;this.setElementStyle("padding","0px 0px "+i+"px 0px")}else{this.setElementStyle("height",e.size*this._gscaleY+"px");var n=(e.height-e.size)*this._gscaleY,o=t.TextFieldUtils.$getValign(e),a=n*o,i=n-a;i<e.size/2*this._gscaleY&&(i=e.size/2*this._gscaleY),this.setElementStyle("padding",a+"px 0px "+i+"px 0px")}this.inputDiv.style.clip="rect(0px "+e.width*this._gscaleX+"px "+e.height*this._gscaleY+"px 0px)",this.inputDiv.style.height=e.height*this._gscaleY+"px",this.inputDiv.style.width=r*this._gscaleX+"px"}},r}(t.EventDispatcher);e.HTML5StageText=r,__reflect(r.prototype,"egret.web.HTML5StageText",["egret.StageText"]),t.StageText=r}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){var r=function(){function e(){this._needShow=!1,this.$scaleX=1,this.$scaleY=1}return e.prototype.isInputOn=function(){return null!=this._stageText},e.prototype.isCurrentStageText=function(t){return this._stageText==t},e.prototype.initValue=function(t){t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.border="none",t.style.padding="0"},e.prototype.$updateSize=function(){if(this.canvas){this.$scaleX=t.sys.DisplayList.$canvasScaleX,this.$scaleY=t.sys.DisplayList.$canvasScaleY,this.StageDelegateDiv.style.left=this.canvas.style.left,this.StageDelegateDiv.style.top=this.canvas.style.top;var e=t.web.getPrefixStyleName("transform");this.StageDelegateDiv.style[e]=this.canvas.style[e],this.StageDelegateDiv.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px"}},e.prototype._initStageDelegateDiv=function(e,r){this.canvas=r;var i,n=this;i||(i=document.createElement("div"),this.StageDelegateDiv=i,i.id="StageDelegateDiv",e.appendChild(i),n.initValue(i),n._inputDIV=document.createElement("div"),n.initValue(n._inputDIV),n._inputDIV.style.width="0px",n._inputDIV.style.height="0px",n._inputDIV.style.left="0px",n._inputDIV.style.top="-100px",n._inputDIV.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",i.appendChild(n._inputDIV),this.canvas.addEventListener("click",function(t){n._needShow?(n._needShow=!1,n._stageText._onClickHandler(t),n.show()):n._inputElement&&(n.clearInputElement(),n._inputElement.blur(),n._inputElement=null)}),n.initInputElement(!0),n.initInputElement(!1))},e.prototype.initInputElement=function(t){var e,r=this;t?(e=document.createElement("textarea"),e.style.resize="none",r._multiElement=e,e.id="egretTextarea"):(e=document.createElement("input"),r._simpleElement=e,e.id="egretInput"),e.type="text",r._inputDIV.appendChild(e),e.setAttribute("tabindex","-1"),e.style.width="1px",e.style.height="12px",r.initValue(e),e.style.outline="thin",e.style.background="none",e.style.overflow="hidden",e.style.wordBreak="break-all",e.style.opacity=0,e.oninput=function(){r._stageText&&r._stageText._onInput()}},e.prototype.show=function(){var e=this,r=e._inputElement;t.$callAsync(function(){r.style.opacity=1},e)},e.prototype.disconnectStageText=function(t){(null==this._stageText||this._stageText==t)&&(this._inputElement&&this._inputElement.blur(),this.clearInputElement()),this._needShow=!1},e.prototype.clearInputElement=function(){var t=this;if(t._inputElement){t._inputElement.value="",t._inputElement.onblur=null,t._inputElement.onfocus=null,t._inputElement.style.width="1px",t._inputElement.style.height="12px",t._inputElement.style.left="0px",t._inputElement.style.top="0px",t._inputElement.style.opacity=0;var e=void 0;e=t._simpleElement==t._inputElement?t._multiElement:t._simpleElement,e.style.display="block",t._inputDIV.style.left="0px",t._inputDIV.style.top="-100px",t._inputDIV.style.height="0px",t._inputDIV.style.width="0px"}t._stageText&&(t._stageText._onDisconnect(),t._stageText=null,this.canvas.userTyping=!1)},e.prototype.getInputElement=function(t){var e=this;e.clearInputElement(),e._stageText=t,this.canvas.userTyping=!0,e._stageText.$textfield.multiline?e._inputElement=e._multiElement:e._inputElement=e._simpleElement;var r;return r=e._simpleElement==e._inputElement?e._multiElement:e._simpleElement,r.style.display="none",e._inputElement},e}();e.HTMLInput=r,__reflect(r.prototype,"egret.web.HTMLInput")}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=t.stage?t.stage.$hashCode:0,r=i[e],a=n[e],s=o[e];return a&&s&&(delete n[e],delete o[e]),r}function r(t,e,r,a){t._initStageDelegateDiv(r,a),i[e.$hashCode]=t,n[e.$hashCode]=a,o[e.$hashCode]=r}var i={},n={},o={};t.$getTextAdapter=e,t.$cacheTextAdapter=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(e,r,o,a,s){n||i();var c="";return s&&(c+="italic "),a&&(c+="bold "),c+=(o||12)+"px ",c+=r||"Arial",n.font=c,t.sys.measureTextWith(n,e)}function i(){n=t.sys.canvasHitTestBuffer.context,n.textAlign="left",n.textBaseline="middle"}var n=null;t.sys.measureText=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(e,r){var i=t.sys.createCanvas(e,r),n=i.getContext("2d");if(void 0===n.imageSmoothingEnabled){for(var o,a=["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"],s=a.length-1;s>=0&&(o=a[s],void 0===n[o]);s--);try{Object.defineProperty(n,"imageSmoothingEnabled",{get:function(){return this[o]},set:function(t){this[o]=t}})}catch(c){n.imageSmoothingEnabled=n[o]}}return i}var i=function(){function e(e,i,n){this.surface=t.sys.createCanvasRenderBufferSurface(r,e,i,n),this.context=this.surface.getContext("2d"),this.context&&(this.context.$offsetX=0,this.context.$offsetY=0),this.resize(e,i)}return Object.defineProperty(e.prototype,"width",{get:function(){return this.surface.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.surface.height},enumerable:!0,configurable:!0}),e.prototype.resize=function(e,r,i){t.sys.resizeCanvasRenderBuffer(this,e,r,i)},e.prototype.getPixels=function(t,e,r,i){return void 0===r&&(r=1),void 0===i&&(i=1),this.context.getImageData(t,e,r,i).data},e.prototype.toDataURL=function(t,e){return this.surface.toDataURL(t,e)},e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.surface.width,this.surface.height)},e.prototype.destroy=function(){this.surface.width=this.surface.height=0},e}();e.CanvasRenderBuffer=i,__reflect(i.prototype,"egret.web.CanvasRenderBuffer",["egret.sys.RenderBuffer"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(r,i){var n=e.call(this)||this;return n.onTouchBegin=function(t){var e=n.getLocation(t);n.touch.onTouchBegin(e.x,e.y,t.identifier)},n.onMouseMove=function(t){0==t.buttons?n.onTouchEnd(t):n.onTouchMove(t)},n.onTouchMove=function(t){var e=n.getLocation(t);n.touch.onTouchMove(e.x,e.y,t.identifier)},n.onTouchEnd=function(t){var e=n.getLocation(t);n.touch.onTouchEnd(e.x,e.y,t.identifier)},n.scaleX=1,n.scaleY=1,n.rotation=0,n.canvas=i,n.touch=new t.sys.TouchHandler(r),n.addListeners(),n}return __extends(r,e),r.prototype.addListeners=function(){var e=this;window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(t){t.identifier=t.pointerId,e.onTouchBegin(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerMove",function(t){t.identifier=t.pointerId,e.onTouchMove(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerUp",function(t){t.identifier=t.pointerId,e.onTouchEnd(t),e.prevent(t)},!1)):(t.Capabilities.isMobile||this.addMouseListener(),this.addTouchListener())},r.prototype.addMouseListener=function(){this.canvas.addEventListener("mousedown",this.onTouchBegin),this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("mouseup",this.onTouchEnd)},r.prototype.addTouchListener=function(){var t=this;this.canvas.addEventListener("touchstart",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchBegin(e.changedTouches[i]);t.prevent(e)},!1),this.canvas.addEventListener("touchmove",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchMove(e.changedTouches[i]);t.prevent(e)},!1),this.canvas.addEventListener("touchend",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchEnd(e.changedTouches[i]);t.prevent(e)},!1),this.canvas.addEventListener("touchcancel",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchEnd(e.changedTouches[i]);t.prevent(e)},!1)},r.prototype.prevent=function(t){t.stopPropagation(),1==t.isScroll||this.canvas.userTyping||t.preventDefault()},r.prototype.getLocation=function(e){e.identifier=+e.identifier||0;var r=document.documentElement,i=this.canvas.getBoundingClientRect(),n=i.left+window.pageXOffset-r.clientLeft,o=i.top+window.pageYOffset-r.clientTop,a=e.pageX-n,s=a,c=e.pageY-o,h=c;return 90==this.rotation?(s=c,h=i.width-a):-90==this.rotation&&(s=i.height-c,h=a),s/=this.scaleX,h/=this.scaleY,t.$TempPoint.setTo(Math.round(s),Math.round(h))},r.prototype.updateScaleMode=function(t,e,r){this.scaleX=t,this.scaleY=e,this.rotation=r},r.prototype.$updateMaxTouches=function(){this.touch.$initMaxTouches()},r}(t.HashObject);e.WebTouchHandler=r,__reflect(r.prototype,"egret.web.WebTouchHandler")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){t.WebLifeCycleHandler=function(t){var e=function(){document[r]?t.pause():t.resume()};window.addEventListener("focus",t.resume,!1),window.addEventListener("blur",t.pause,!1);var r,i;"undefined"!=typeof document.hidden?(r="hidden",i="visibilitychange"):"undefined"!=typeof document.mozHidden?(r="mozHidden",i="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(r="msHidden",i="msvisibilitychange"):"undefined"!=typeof document.webkitHidden?(r="webkitHidden",i="webkitvisibilitychange"):"undefined"!=typeof document.oHidden&&(r="oHidden",i="ovisibilitychange"),"onpageshow"in window&&"onpagehide"in window&&(window.addEventListener("pageshow",t.resume,!1),window.addEventListener("pagehide",t.pause,!1)),r&&i&&document.addEventListener(i,e,!1);var n=navigator.userAgent,o=/micromessenger/gi.test(n),a=/mqq/gi.test(n),s=/mobile.*qq/gi.test(n);if((s||o)&&(a=!1),a){var c=window.browser||{};c.execWebFn=c.execWebFn||{},c.execWebFn.postX5GamePlayerMessage=function(e){var r=e.type;"app_enter_background"==r?t.pause():"app_enter_foreground"==r&&t.resume()},window.browser=c}}}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t,e){var r="";if(null!=e)r=i(t,e);else{if(null==a){var n=document.createElement("div").style;a=i("transform",n)}r=a}return""==r?t:r+t.charAt(0).toUpperCase()+t.substring(1,t.length)}function i(t,e){if(t in e)return"";t=t.charAt(0).toUpperCase()+t.substring(1,t.length);for(var r=["webkit","ms","Moz","O"],i=0;i<r.length;i++){var n=r[i]+t;if(n in e)return r[i]}return""}var n=function(){function t(){}return t.WEB_AUDIO=2,t.HTML5_AUDIO=3,t}();e.AudioType=n,__reflect(n.prototype,"egret.web.AudioType");var o=function(r){function i(){return r.call(this)||this}return __extends(i,r),i.$init=function(){var r=navigator.userAgent.toLowerCase();i.ua=r,i._canUseBlob=!1;var o=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,a=r.indexOf("iphone")>=0||r.indexOf("ipad")>=0||r.indexOf("ipod")>=0;if(o)try{e.WebAudioDecode.ctx=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)}catch(s){o=!1}var c,h=i._audioType;h==n.WEB_AUDIO&&o||h==n.HTML5_AUDIO?(c=!1,i.setAudioType(h)):!a&&r.indexOf("safari")>=0&&-1===r.indexOf("chrome")?(c=!1,i.setAudioType(n.WEB_AUDIO)):(c=!0,i.setAudioType(n.HTML5_AUDIO)),r.indexOf("android")>=0?c&&o&&i.setAudioType(n.WEB_AUDIO):a&&i.getIOSVersion()>=7&&(i._canUseBlob=!0,c&&o&&i.setAudioType(n.WEB_AUDIO));var u=window.URL||window.webkitURL;u||(i._canUseBlob=!1),r.indexOf("egretnative")>=0&&(i.setAudioType(n.HTML5_AUDIO),i._canUseBlob=!0),t.Sound=i._AudioClass},i.setAudioType=function(e){switch(i._audioType=e,e){case n.WEB_AUDIO:i._AudioClass=t.web.WebAudioSound;break;case n.HTML5_AUDIO:i._AudioClass=t.web.HtmlSound}},i.getIOSVersion=function(){var t=i.ua.toLowerCase().match(/cpu [^\d]*\d.*like mac os x/);if(!t||0==t.length)return 0;var e=t[0];return parseInt(e.match(/\d+(_\d)*/)[0])||0},i._canUseBlob=!1,i._audioType=0,i.ua="",i}(t.HashObject);e.Html5Capatibility=o,__reflect(o.prototype,"egret.web.Html5Capatibility");var a=null;e.getPrefixStyleName=r,e.getPrefix=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t,e){return i(t,e)}function i(t,e){var r=document.createElement("canvas");return isNaN(t)||isNaN(e)||(r.width=t,r.height=e),r}function n(t,e,r,i){if(t){var n=t,o=n.surface;i?(o.width<e&&(o.width=e),o.height<r&&(o.height=r)):(o.width!==e&&(o.width=e),o.height!==r&&(o.height=r)),n.onResize()}}function o(r){for(var i={antialias:e.WebGLRenderContext.antialias,stencil:!0},n=null,o=["webgl","experimental-webgl"],a=0;a<o.length;++a){try{n=r.getContext(o[a],i)}catch(s){}if(n)break}return n||t.$error(1021),n}function a(t){return t?t.getContext("2d"):null}function s(e,r){var i=e,n=i.context,o=n.createTexture();return o?(o[t.glContext]=n,n.bindTexture(n.TEXTURE_2D,o),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),o[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),o):void(i.contextLost=!0)}function c(e,r,i,n){var o=e,a=o.context,s=a.createTexture();return s?(s[t.glContext]=a,a.bindTexture(a.TEXTURE_2D,s),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),s[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,a.texImage2D(a.TEXTURE_2D,0,a.RGBA,r,i,0,a.RGBA,a.UNSIGNED_BYTE,n),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),s):(o.contextLost=!0,null)}function h(t,e,r){var i=t,n=i.context;n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,e.texture);var o=3*e.count;return n.drawElements(n.TRIANGLES,o,n.UNSIGNED_SHORT,2*r),o}function u(t,e){return t.measureText(e).width}function l(t,e,r,i){return t(e,r)}function p(t,e,r,i){var n=t,o=n.surface;if(i){var a=!1;o.width<e&&(o.width=e,a=!0),o.height<r&&(o.height=r,a=!0),a||(n.context.globalCompositeOperation="source-over",n.context.setTransform(1,0,0,1,0,0),n.context.globalAlpha=1)}else o.width!=e&&(o.width=e),o.height!=r&&(o.height=r);n.clear()}t.sys.mainCanvas=r,t.sys.createCanvas=i,e.resizeContext=n,t.sys.resizeContext=n,t.sys.getContextWebGL=o,e.getContext2d=a,t.sys.getContext2d=a,t.sys.createTexture=s,t.sys._createTexture=c,t.sys.drawTextureElements=h,t.sys.measureTextWith=u,t.sys.createCanvasRenderBufferSurface=l,t.sys.resizeCanvasRenderBuffer=p,t.Geolocation=t.web.WebGeolocation,t.Motion=t.web.WebMotion}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(){if(s)for(var t=document.querySelectorAll(".egret-player"),e=t.length,r=0;e>r;r++){var i=t[r],n=i["egret-player"];n.updateScreenSize()}}function i(r){if(!s){s=!0,r||(r={});var i=navigator.userAgent.toLowerCase();if(i.indexOf("egretnative")>=0&&-1==i.indexOf("egretwebview")&&(t.Capabilities.runtimeType=t.RuntimeType.RUNTIME2),i.indexOf("egretnative")>=0&&t.nativeRender)egret_native.addModuleCallback(function(){if(e.Html5Capatibility.$init(),"webgl"==r.renderMode){var i=r.antialias;e.WebGLRenderContext.antialias=!!i}t.sys.CanvasRenderBuffer=e.CanvasRenderBuffer,n(r.renderMode),egret_native.nrSetRenderMode(2);var s;s=r.canvasScaleFactor?r.canvasScaleFactor:r.calculateCanvasScaleFactor?r.calculateCanvasScaleFactor(t.sys.canvasHitTestBuffer.context):window.devicePixelRatio,t.sys.DisplayList.$canvasScaleFactor=s;var h=t.ticker;o(h),r.screenAdapter?t.sys.screenAdapter=r.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);for(var u=document.querySelectorAll(".egret-player"),l=u.length,p=0;l>p;p++){var d=u[p],f=new e.WebPlayer(d,r);d["egret-player"]=f}window.addEventListener("resize",function(){isNaN(c)&&(c=window.setTimeout(a,300))})},null),egret_native.initNativeRender();else{e.Html5Capatibility._audioType=r.audioType,e.Html5Capatibility.$init();var h=r.renderMode;if("webgl"==h){var u=r.antialias;e.WebGLRenderContext.antialias=!!u}t.sys.CanvasRenderBuffer=e.CanvasRenderBuffer,i.indexOf("egretnative")>=0&&"webgl"!=h&&(t.$warn(1051),h="webgl"),n(h);var l=void 0;if(r.canvasScaleFactor)l=r.canvasScaleFactor;else if(r.calculateCanvasScaleFactor)l=r.calculateCanvasScaleFactor(t.sys.canvasHitTestBuffer.context);else{var p=t.sys.canvasHitTestBuffer.context,d=p.backingStorePixelRatio||p.webkitBackingStorePixelRatio||p.mozBackingStorePixelRatio||p.msBackingStorePixelRatio||p.oBackingStorePixelRatio||p.backingStorePixelRatio||1;l=(window.devicePixelRatio||1)/d}t.sys.DisplayList.$canvasScaleFactor=l;var f=t.ticker;o(f),r.screenAdapter?t.sys.screenAdapter=r.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);for(var g=document.querySelectorAll(".egret-player"),v=g.length,y=0;v>y;y++){var m=g[y],$=new e.WebPlayer(m,r);m["egret-player"]=$}window.addEventListener("resize",function(){isNaN(c)&&(c=window.setTimeout(a,300))})}}}function n(r){"webgl"==r&&t.WebGLUtils.checkCanUseWebGL()?(t.sys.RenderBuffer=e.WebGLRenderBuffer,t.sys.systemRenderer=new e.WebGLRenderer,t.sys.canvasRenderer=new t.CanvasRenderer,t.sys.customHitTestBuffer=new e.WebGLRenderBuffer(3,3),t.sys.canvasHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.Capabilities.renderMode="webgl"):(t.sys.RenderBuffer=e.CanvasRenderBuffer,t.sys.systemRenderer=new t.CanvasRenderer,t.sys.canvasRenderer=t.sys.systemRenderer,t.sys.customHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.sys.canvasHitTestBuffer=t.sys.customHitTestBuffer,t.Capabilities.renderMode="canvas")}function o(t){function e(){r(e),t.update()}var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;r||(r=function(t){return window.setTimeout(t,1e3/60)}),r(e)}function a(){c=0/0,t.updateAllScreens()}var s=!1;window.isNaN=function(t){return t=+t,t!==t},t.runEgret=i,t.updateAllScreens=r;var c=0/0}(e=t.web||(t.web={}))}(egret||(egret={}));var language,egret;!function(t){var e;!function(e){var r=function(){function e(){}return e.detect=function(){var r=t.Capabilities,i=navigator.userAgent.toLowerCase();r.isMobile=-1!=i.indexOf("mobile")||-1!=i.indexOf("android"),r.isMobile?i.indexOf("windows")<0&&(-1!=i.indexOf("iphone")||-1!=i.indexOf("ipad")||-1!=i.indexOf("ipod"))?r.os="iOS":-1!=i.indexOf("android")&&-1!=i.indexOf("linux")?r.os="Android":-1!=i.indexOf("windows")&&(r.os="Windows Phone"):-1!=i.indexOf("windows nt")?r.os="Windows PC":"MacIntel"==navigator.platform&&navigator.maxTouchPoints>1?(r.os="iOS",r.isMobile=!0):-1!=i.indexOf("mac os")&&(r.os="Mac OS");var n=(navigator.language||navigator.browserLanguage).toLowerCase(),o=n.split("-");o.length>1&&(o[1]=o[1].toUpperCase()),r.language=o.join("-"),e.injectUIntFixOnIE9()},e.injectUIntFixOnIE9=function(){if(/msie 9.0/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var t="<!-- IEBinaryToArray_ByteStr -->\r\n<script type='text/vbscript' language='VBScript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n</script>\r\n<!-- convertResponseBodyToText -->\r\n<script>\r\nlet convertResponseBodyToText = function (binary) {\r\n   let byteMapping = {};\r\n   for ( let i = 0; i < 256; i++ ) {\r\n       for ( let j = 0; j < 256; j++ ) {\r\n           byteMapping[ String.fromCharCode( i + j * 256 ) ] =\r\n           String.fromCharCode(i) + String.fromCharCode(j);\r\n       }\r\n   }\r\n   let rawBytes = IEBinaryToArray_ByteStr(binary);\r\n   let lastChr = IEBinaryToArray_ByteStr_Last(binary);\r\n   return rawBytes.replace(/[\\s\\S]/g,                           function( match ) { return byteMapping[match]; }) + lastChr;\r\n};\r\n</script>\r\n";document.write(t)}},e}();e.WebCapability=r,__reflect(r.prototype,"egret.web.WebCapability"),r.detect()}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(){function e(e,r,i,n,o){if(this.showPanle=!0,this.fpsHeight=0,this.WIDTH=101,this.HEIGHT=20,this.bgCanvasColor="#18304b",this.fpsFrontColor="#18fefe",this.WIDTH_COST=50,this.cost1Color="#18fefe",this.cost3Color="#ff0000",this.arrFps=[],this.arrCost=[],this.arrLog=[],r||i){"canvas"==t.Capabilities.renderMode?this.renderMode="Canvas":this.renderMode="WebGL",this.panelX=void 0===o.x?0:parseInt(o.x),this.panelY=void 0===o.y?0:parseInt(o.y),this.fontColor=void 0===o.textColor?"#ffffff":o.textColor.replace("0x","#"),this.fontSize=void 0===o.size?12:parseInt(o.size),t.Capabilities.isMobile&&(this.fontSize-=2);var a=document.createElement("div");a.style.position="absolute",a.style.background="rgba(0,0,0,"+o.bgAlpha+")",a.style.left=this.panelX+"px",a.style.top=this.panelY+"px",a.style.pointerEvents="none",a.id="egret-fps-panel",document.body.appendChild(a);var s=document.createElement("div");s.style.color=this.fontColor,s.style.fontSize=this.fontSize+"px",s.style.lineHeight=this.fontSize+"px",s.style.margin="4px 4px 4px 4px",this.container=s,a.appendChild(s),r&&this.addFps(),i&&this.addLog()}}return e.prototype.addFps=function(){var t=document.createElement("div");t.style.display="inline-block",this.containerFps=t,this.container.appendChild(t);var e=document.createElement("div");e.style.paddingBottom="2px",this.fps=e,this.containerFps.appendChild(e),e.innerHTML="0 FPS "+this.renderMode+"<br/>min0 max0 avg0";var r=document.createElement("canvas");this.containerFps.appendChild(r),r.width=this.WIDTH,r.height=this.HEIGHT,this.canvasFps=r;var i=r.getContext("2d");this.contextFps=i,i.fillStyle=this.bgCanvasColor,i.fillRect(0,0,this.WIDTH,this.HEIGHT);var n=document.createElement("div");this.divDatas=n,this.containerFps.appendChild(n);var o=document.createElement("div");o.style["float"]="left",o.innerHTML="Draw<br/>Cost",n.appendChild(o);var a=document.createElement("div");a.style.paddingLeft=o.offsetWidth+20+"px",n.appendChild(a);var s=document.createElement("div");this.divDraw=s,s.innerHTML="0<br/>",a.appendChild(s);var c=document.createElement("div");this.divCost=c,c.innerHTML='<font  style="color:'+this.cost1Color+'">0<font/> <font  style="color:'+this.cost3Color+'">0<font/>',a.appendChild(c),r=document.createElement("canvas"),this.canvasCost=r,this.containerFps.appendChild(r),r.width=this.WIDTH,r.height=this.HEIGHT,i=r.getContext("2d"),this.contextCost=i,i.fillStyle=this.bgCanvasColor,i.fillRect(0,0,this.WIDTH,this.HEIGHT),i.fillStyle="#000000",i.fillRect(this.WIDTH_COST,0,1,this.HEIGHT),this.fpsHeight=this.container.offsetHeight},e.prototype.addLog=function(){var t=document.createElement("div");t.style.maxWidth=document.body.clientWidth-8-this.panelX+"px",t.style.wordWrap="break-word",this.log=t,this.container.appendChild(t)},e.prototype.update=function(t,e){void 0===e&&(e=!1);var r,i,n;e?(r=this.arrFps[this.arrFps.length-1],i=this.arrCost[this.arrCost.length-1][0],n=this.arrCost[this.arrCost.length-1][1]):(r=t.fps,i=t.costTicker,n=t.costRender,this.lastNumDraw=t.draw,this.arrFps.push(r),this.arrCost.push([i,n]));var o=0,a=this.arrFps.length;a>101&&(a=101,this.arrFps.shift(),this.arrCost.shift());for(var s=this.arrFps[0],c=this.arrFps[0],h=0;a>h;h++){var u=this.arrFps[h];o+=u,s>u?s=u:u>c&&(c=u)}var l=this.WIDTH,p=this.HEIGHT,d=this.contextFps;d.drawImage(this.canvasFps,1,0,l-1,p,0,0,l-1,p),d.fillStyle=this.bgCanvasColor,d.fillRect(l-1,0,1,p);var f=Math.floor(r/60*20);1>f&&(f=1),d.fillStyle=this.fpsFrontColor,d.fillRect(l-1,20-f,1,f);var g=this.WIDTH_COST;d=this.contextCost,d.drawImage(this.canvasCost,1,0,g-1,p,0,0,g-1,p),d.drawImage(this.canvasCost,g+2,0,g-1,p,g+1,0,g-1,p);var v=Math.floor(i/2);1>v?v=1:v>20&&(v=20);var y=Math.floor(n/2);1>y?y=1:y>20&&(y=20),d.fillStyle=this.bgCanvasColor,d.fillRect(g-1,0,1,p),d.fillRect(2*g,0,1,p),d.fillRect(3*g+1,0,1,p),d.fillStyle=this.cost1Color,d.fillRect(g-1,20-v,1,v),d.fillStyle=this.cost3Color,d.fillRect(2*g,20-y,1,y);var m=Math.floor(o/a),$=r+" FPS "+this.renderMode;this.showPanle&&($+="<br/>min"+s+" max"+c+" avg"+m,this.divDraw.innerHTML=this.lastNumDraw+"<br/>",this.divCost.innerHTML='<font  style="color:#18fefe">'+i+'<font/> <font  style="color:#ff0000">'+n+"<font/>"),this.fps.innerHTML=$},e.prototype.updateInfo=function(t){this.arrLog.push(t),this.updateLogLayout()},e.prototype.updateWarn=function(t){this.arrLog.push("[Warning]"+t),this.updateLogLayout()},e.prototype.updateError=function(t){this.arrLog.push("[Error]"+t),this.updateLogLayout()},e.prototype.updateLogLayout=function(){for(this.log.innerHTML=this.arrLog.join("<br/>");document.body.clientHeight<this.log.offsetHeight+this.fpsHeight+this.panelY+2*this.fontSize;)this.arrLog.shift(),this.log.innerHTML=this.arrLog.join("<br/>")},e}();e.WebFps=r,__reflect(r.prototype,"egret.web.WebFps",["egret.FPSDisplay"]),t.FPSDisplay=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r;!function(r){function i(t){return window.localStorage.getItem(t)}function n(e,r){try{return window.localStorage.setItem(e,r),!0}catch(i){return t.$warn(1047,e,r),!1}}function o(t){window.localStorage.removeItem(t)}function a(){window.localStorage.clear()}e.getItem=i,e.setItem=n,e.removeItem=o,e.clear=a}(r=e.web||(e.web={}))}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(t,e){var i=r.call(this)||this;return i.init(t,e),i.initOrientation(),i}return __extends(i,r),i.prototype.init=function(r,i){console.log("Egret Engine Version:",t.Capabilities.engineVersion);var n=this.readOption(r,i),o=new t.Stage;o.$screen=this,o.$scaleMode=n.scaleMode,o.$orientation=n.orientation,o.$maxTouches=n.maxTouches,o.frameRate=n.frameRate,o.textureScaleFactor=n.textureScaleFactor;var a=new t.sys.RenderBuffer(void 0,void 0,!0),s=a.surface;this.attachCanvas(r,s);var c=new e.WebTouchHandler(o,s),h=new t.sys.Player(a,o,n.entryClassName);t.lifecycle.stage=o,t.lifecycle.addLifecycleListener(e.WebLifeCycleHandler);var u=new e.HTMLInput;(n.showFPS||n.showLog)&&(t.nativeRender||h.displayFPS(n.showFPS,n.showLog,n.logFilter,n.fpsStyles)),this.playerOption=n,this.container=r,this.canvas=s,this.stage=o,this.player=h,this.webTouchHandler=c,this.webInput=u,t.web.$cacheTextAdapter(u,o,r,s),this.updateScreenSize(),this.updateMaxTouches(),h.start()},i.prototype.initOrientation=function(){var e=this;window.addEventListener("orientationchange",function(){window.setTimeout(function(){t.StageOrientationEvent.dispatchStageOrientationEvent(e.stage,t.StageOrientationEvent.ORIENTATION_CHANGE)},350)})},i.prototype.readOption=function(e,r){var i={};i.entryClassName=e.getAttribute("data-entry-class"),i.scaleMode=e.getAttribute("data-scale-mode")||t.StageScaleMode.NO_SCALE,i.frameRate=+e.getAttribute("data-frame-rate")||30,i.contentWidth=+e.getAttribute("data-content-width")||480,i.contentHeight=+e.getAttribute("data-content-height")||800,i.orientation=e.getAttribute("data-orientation")||t.OrientationMode.AUTO,i.maxTouches=+e.getAttribute("data-multi-fingered")||2,i.textureScaleFactor=+e.getAttribute("texture-scale-factor")||1,i.showFPS="true"==e.getAttribute("data-show-fps");for(var n=e.getAttribute("data-show-fps-style")||"",o=n.split(","),a={},s=0;s<o.length;s++){var c=o[s].split(":");a[c[0]]=c[1]}return i.fpsStyles=a,i.showLog="true"==e.getAttribute("data-show-log"),i.logFilter=e.getAttribute("data-log-filter"),i},i.prototype.attachCanvas=function(t,e){var r=e.style;r.cursor="inherit",r.position="absolute",r.top="0",r.bottom="0",r.left="0",r.right="0",t.appendChild(e),r=t.style,r.overflow="hidden",r.position="absolute"},i.prototype.updateScreenSize=function(){var e=this.canvas;if(!e.userTyping){var r=this.playerOption,i=this.container.getBoundingClientRect(),n=0,o=i.width,a=i.height;if(0!=o&&0!=a){i.top<0&&(a+=i.top,n=-i.top);var s=!1,c=this.stage.$orientation;c!=t.OrientationMode.AUTO&&(s=c!=t.OrientationMode.PORTRAIT&&a>o||c==t.OrientationMode.PORTRAIT&&o>a);var h=s?a:o,u=s?o:a;t.Capabilities.boundingClientWidth=h,t.Capabilities.boundingClientHeight=u;var l=t.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode,h,u,r.contentWidth,r.contentHeight),p=l.stageWidth,d=l.stageHeight,f=l.displayWidth,g=l.displayHeight;e.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",e.width!=p&&(e.width=p),e.height!=d&&(e.height=d);var v=0;s?c==t.OrientationMode.LANDSCAPE?(v=90,e.style.top=n+(a-f)/2+"px",e.style.left=(o+g)/2+"px"):(v=-90,e.style.top=n+(a+f)/2+"px",e.style.left=(o-g)/2+"px"):(e.style.top=n+(a-g)/2+"px",e.style.left=(o-f)/2+"px");var y=f/p,m=g/d,$=y*t.sys.DisplayList.$canvasScaleFactor,b=m*t.sys.DisplayList.$canvasScaleFactor;"canvas"==t.Capabilities.renderMode&&($=Math.ceil($),b=Math.ceil(b));var _=t.Matrix.create();_.identity(),_.scale(y/$,m/b),_.rotate(v*Math.PI/180);var x="matrix("+_.a+","+_.b+","+_.c+","+_.d+","+_.tx+","+_.ty+")";t.Matrix.release(_),e.style[t.web.getPrefixStyleName("transform")]=x,t.sys.DisplayList.$setCanvasScale($,b),this.webTouchHandler.updateScaleMode(y,m,v),this.webInput.$updateSize(),this.player.updateStageSize(p,d),t.nativeRender&&(e.width=p*$,e.height=d*b)}}},i.prototype.setContentSize=function(t,e){var r=this.playerOption;r.contentWidth=t,r.contentHeight=e,this.updateScreenSize()},i.prototype.updateMaxTouches=function(){this.webTouchHandler.$updateMaxTouches()},i}(t.HashObject);e.WebPlayer=r,__reflect(r.prototype,"egret.web.WebPlayer",["egret.sys.Screen"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(e,r){s||(s=t.sys.createCanvas(),c=s.getContext("2d"));var i=e.$getTextureWidth(),n=e.$getTextureHeight();null==r&&(r=t.$TempRectangle,r.x=0,r.y=0,r.width=i,r.height=n),r.x=Math.min(r.x,i-1),r.y=Math.min(r.y,n-1),r.width=Math.min(r.width,i-r.x),r.height=Math.min(r.height,n-r.y);var o=r.width,a=r.height,h=s;if(h.style.width=o+"px",h.style.height=a+"px",s.width=o,s.height=a,"webgl"==t.Capabilities.renderMode){var u=void 0;e.$renderBuffer?u=e:(u=new t.RenderTexture,u.drawToTexture(new t.Bitmap(e)));for(var l=u.$renderBuffer.getPixels(r.x,r.y,o,a),p=new ImageData(o,a),d=0;d<l.length;d++)p.data[d]=l[d];return c.putImageData(p,0,0),e.$renderBuffer||u.dispose(),h}var f=e,g=Math.round(f.$offsetX),v=Math.round(f.$offsetY),y=f.$bitmapWidth,m=f.$bitmapHeight;return c.drawImage(f.$bitmapData.source,f.$bitmapX+r.x/t.$TextureScaleFactor,f.$bitmapY+r.y/t.$TextureScaleFactor,y*r.width/i,m*r.height/n,g,v,r.width,r.height),h}function i(e,i,n){try{var o=r(this,i),a=o.toDataURL(e,n);return a
}catch(s){t.$error(1033)}return null}function n(t,e,r,n){var o=i.call(this,t,r,n);if(null!=o){var a=o.replace(/^data:image[^;]*/,"data:image/octet-stream"),s=document.createElement("a");s.download=e,s.href=a;var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(c)}}function o(e,r){return t.$warn(1041,"getPixel32","getPixels"),this.getPixels(e,r)}function a(e,i,n,o){if(void 0===n&&(n=1),void 0===o&&(o=1),"webgl"==t.Capabilities.renderMode){var a=void 0;this.$renderBuffer?a=this:(a=new t.RenderTexture,a.drawToTexture(new t.Bitmap(this)));var s=a.$renderBuffer.getPixels(e,i,n,o);return s}try{var h=(r(this),c.getImageData(e,i,n,o).data);return h}catch(u){t.$error(1039)}}var s,c;t.Texture.prototype.toDataURL=i,t.Texture.prototype.saveToFile=n,t.Texture.prototype.getPixel32=o,t.Texture.prototype.getPixels=a}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){for(var e=s.parseFromString(t,"text/xml"),r=e.childNodes.length,n=0;r>n;n++){var o=e.childNodes[n];if(1==o.nodeType)return i(o,null)}return null}function i(t,e){if("parsererror"==t.localName)throw new Error(t.textContent);for(var r=new o(t.localName,e,t.prefix,t.namespaceURI,t.nodeName),n=t.attributes,s=r.attributes,c=n.length,h=0;c>h;h++){var u=n[h],l=u.name;0!=l.indexOf("xmlns:")&&(s[l]=u.value,r["$"+l]=u.value)}var p=t.childNodes;c=p.length;for(var d=r.children,h=0;c>h;h++){var f=p[h],g=f.nodeType,v=null;if(1==g)v=i(f,r);else if(3==g){var y=f.textContent.trim();y&&(v=new a(y,r))}v&&d.push(v)}return r}var n=function(){function t(t,e){this.nodeType=t,this.parent=e}return t}();e.XMLNode=n,__reflect(n.prototype,"egret.web.XMLNode");var o=function(t){function e(e,r,i,n,o){var a=t.call(this,1,r)||this;return a.attributes={},a.children=[],a.localName=e,a.prefix=i,a.namespace=n,a.name=o,a}return __extends(e,t),e}(n);e.XML=o,__reflect(o.prototype,"egret.web.XML");var a=function(t){function e(e,r){var i=t.call(this,3,r)||this;return i.text=e,i}return __extends(e,t),e}(n);e.XMLText=a,__reflect(a.prototype,"egret.web.XMLText");var s=new DOMParser;t.XML={parse:r}}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.onChange=function(e){var i=new t.OrientationEvent(t.Event.CHANGE);i.beta=e.beta,i.gamma=e.gamma,i.alpha=e.alpha,r.dispatchEvent(i)},r}return __extends(r,e),r.prototype.start=function(){window.addEventListener("deviceorientation",this.onChange)},r.prototype.stop=function(){window.removeEventListener("deviceorientation",this.onChange)},r}(t.EventDispatcher);e.WebDeviceOrientation=r,__reflect(r.prototype,"egret.web.WebDeviceOrientation",["egret.DeviceOrientation"])}(e=t.web||(t.web={}))}(egret||(egret={})),egret.DeviceOrientation=egret.web.WebDeviceOrientation;var egret;!function(t){var e;!function(e){var r=function(){function t(){}return t.call=function(t,e){},t.addCallback=function(t,e){},t}();e.WebExternalInterface=r,__reflect(r.prototype,"egret.web.WebExternalInterface",["egret.ExternalInterface"]);var i=navigator.userAgent.toLowerCase();i.indexOf("egretnative")<0&&(t.ExternalInterface=r)}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){function r(e){var r=JSON.parse(e),n=r.functionName,o=i[n];if(o){var a=r.value;o.call(null,a)}else t.$warn(1050,n)}var i={},n=function(){function t(){}return t.call=function(t,e){var r={};r.functionName=t,r.value=e,egret_native.sendInfoToPlugin(JSON.stringify(r))},t.addCallback=function(t,e){i[t]=e},t}();e.NativeExternalInterface=n,__reflect(n.prototype,"egret.web.NativeExternalInterface",["egret.ExternalInterface"]);var o=navigator.userAgent.toLowerCase();o.indexOf("egretnative")>=0&&(t.ExternalInterface=n,egret_native.receivedPluginInfo=r)}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){var r={},i=function(){function e(){}return e.call=function(t,e){__global.ExternalInterface.call(t,e)},e.addCallback=function(t,e){r[t]=e},e.invokeCallback=function(e,i){var n=r[e];n?n.call(null,i):t.$warn(1050,e)},e}();e.WebViewExternalInterface=i,__reflect(i.prototype,"egret.web.WebViewExternalInterface",["egret.ExternalInterface"]);var n=navigator.userAgent.toLowerCase();n.indexOf("egretwebview")>=0&&(t.ExternalInterface=i)}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var t=r.call(this)||this;return t.loaded=!1,t}return __extends(i,r),Object.defineProperty(i.prototype,"length",{get:function(){if(this.originAudio)return this.originAudio.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),i.prototype.load=function(e){function r(){i.$recycle(a.url,s),o(),c.indexOf("firefox")>=0&&(s.pause(),s.muted=!1),h&&document.body.appendChild(s),a.loaded=!0,a.dispatchEventWith(t.Event.COMPLETE)}function n(){o(),a.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}function o(){s.removeEventListener("canplaythrough",r),s.removeEventListener("error",n),h&&document.body.removeChild(s)}var a=this;this.url=e;var s=new Audio(e);s.addEventListener("canplaythrough",r),s.addEventListener("error",n);var c=navigator.userAgent.toLowerCase();c.indexOf("firefox")>=0&&(s.autoplay=!0,s.muted=!0);var h=c.indexOf("edge")>=0||c.indexOf("trident")>=0;h&&document.body.appendChild(s),s.load(),this.originAudio=s,i.clearAudios[this.url]&&delete i.clearAudios[this.url]},i.prototype.play=function(r,n){r=+r||0,n=+n||0;var o=i.$pop(this.url);null==o&&(o=this.originAudio.cloneNode()),o.autoplay=!0;var a=new e.HtmlSoundChannel(o);return a.$url=this.url,a.$loops=n,a.$startTime=r,a.$play(),t.sys.$pushSoundChannel(a),a},i.prototype.close=function(){this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),i.$clear(this.url),this.loaded=!1},i.$clear=function(t){i.clearAudios[t]=!0;var e=i.audios[t];e&&(e.length=0)},i.$pop=function(t){var e=i.audios[t];return e&&e.length>0?e.pop():null},i.$recycle=function(t,e){if(!i.clearAudios[t]){var r=i.audios[t];null==i.audios[t]&&(r=i.audios[t]=[]),r.push(e)}},i.MUSIC="music",i.EFFECT="effect",i.audios={},i.clearAudios={},i}(t.EventDispatcher);e.HtmlSound=r,__reflect(r.prototype,"egret.web.HtmlSound",["egret.Sound"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.drawData=[],this.drawDataLen=0}return t.prototype.pushDrawRect=function(){if(0==this.drawDataLen||1!=this.drawData[this.drawDataLen-1].type){var t=this.drawData[this.drawDataLen]||{};t.type=1,t.count=0,this.drawData[this.drawDataLen]=t,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=2},t.prototype.pushDrawTexture=function(t,e,r,i,n){if(void 0===e&&(e=2),r){var o=this.drawData[this.drawDataLen]||{};o.type=0,o.texture=t,o.filter=r,o.count=e,o.textureWidth=i,o.textureHeight=n,this.drawData[this.drawDataLen]=o,this.drawDataLen++}else{if(0==this.drawDataLen||0!=this.drawData[this.drawDataLen-1].type||t!=this.drawData[this.drawDataLen-1].texture||this.drawData[this.drawDataLen-1].filter){var o=this.drawData[this.drawDataLen]||{};o.type=0,o.texture=t,o.count=0,this.drawData[this.drawDataLen]=o,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=e}},t.prototype.pushChangeSmoothing=function(t,e){t.smoothing=e;var r=this.drawData[this.drawDataLen]||{};r.type=10,r.texture=t,r.smoothing=e,this.drawData[this.drawDataLen]=r,this.drawDataLen++},t.prototype.pushPushMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=2,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushPopMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=3,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushSetBlend=function(t){for(var e=this.drawDataLen,r=!1,i=e-1;i>=0;i--){var n=this.drawData[i];if(n){if((0==n.type||1==n.type)&&(r=!0),!r&&4==n.type){this.drawData.splice(i,1),this.drawDataLen--;continue}if(4==n.type){if(n.value==t)return;break}}}var o=this.drawData[this.drawDataLen]||{};o.type=4,o.value=t,this.drawData[this.drawDataLen]=o,this.drawDataLen++},t.prototype.pushResize=function(t,e,r){var i=this.drawData[this.drawDataLen]||{};i.type=5,i.buffer=t,i.width=e,i.height=r,this.drawData[this.drawDataLen]=i,this.drawDataLen++},t.prototype.pushClearColor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=6,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.pushActivateBuffer=function(t){for(var e=this.drawDataLen,r=!1,i=e-1;i>=0;i--){var n=this.drawData[i];!n||(4!=n.type&&7!=n.type&&(r=!0),r||7!=n.type)||(this.drawData.splice(i,1),this.drawDataLen--)}var o=this.drawData[this.drawDataLen]||{};o.type=7,o.buffer=t,o.width=t.rootRenderTarget.width,o.height=t.rootRenderTarget.height,this.drawData[this.drawDataLen]=o,this.drawDataLen++},t.prototype.pushEnableScissor=function(t,e,r,i){var n=this.drawData[this.drawDataLen]||{};n.type=8,n.x=t,n.y=e,n.width=r,n.height=i,this.drawData[this.drawDataLen]=n,this.drawDataLen++},t.prototype.pushDisableScissor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=9,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.clear=function(){for(var t=0;t<this.drawDataLen;t++){var e=this.drawData[t];e.type=0,e.count=0,e.texture=null,e.filter=null,e.value="",e.buffer=null,e.width=0,e.height=0,e.textureWidth=0,e.textureHeight=0,e.smoothing=!1,e.x=0,e.y=0}this.drawDataLen=0},t}();t.WebGLDrawCmdManager=e,__reflect(e.prototype,"egret.web.WebGLDrawCmdManager")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(){function e(){this.vertSize=5,this.vertByteSize=4*this.vertSize,this.maxQuadsCount=2048,this.maxVertexCount=4*this.maxQuadsCount,this.maxIndicesCount=6*this.maxQuadsCount,this.vertices=null,this.indices=null,this.indicesForMesh=null,this.vertexIndex=0,this.indexIndex=0,this.hasMesh=!1,this._vertices=null,this._verticesFloat32View=null,this._verticesUint32View=null;var t=this.maxVertexCount*this.vertSize;this.vertices=new Float32Array(t),this._vertices=new ArrayBuffer(this.maxVertexCount*this.vertByteSize),this._verticesFloat32View=new Float32Array(this._vertices),this._verticesUint32View=new Uint32Array(this._vertices),this.vertices=this._verticesFloat32View;var e=this.maxIndicesCount;this.indices=new Uint16Array(e),this.indicesForMesh=new Uint16Array(e);for(var r=0,i=0;e>r;r+=6,i+=4)this.indices[r+0]=i+0,this.indices[r+1]=i+1,this.indices[r+2]=i+2,this.indices[r+3]=i+0,this.indices[r+4]=i+2,this.indices[r+5]=i+3}return e.prototype.reachMaxSize=function(t,e){return void 0===t&&(t=4),void 0===e&&(e=6),this.vertexIndex>this.maxVertexCount-t||this.indexIndex>this.maxIndicesCount-e},e.prototype.getVertices=function(){var t=this.vertices.subarray(0,this.vertexIndex*this.vertSize);return t},e.prototype.getIndices=function(){return this.indices},e.prototype.getMeshIndices=function(){return this.indicesForMesh},e.prototype.changeToMeshIndices=function(){if(!this.hasMesh){for(var t=0,e=this.indexIndex;e>t;++t)this.indicesForMesh[t]=this.indices[t];this.hasMesh=!0}},e.prototype.isMesh=function(){return this.hasMesh},e.prototype.cacheArrays=function(e,r,i,n,o,a,s,c,h,u,l,p,d,f,g){var v=e.globalAlpha;v=Math.min(v,1);var y=e.globalTintColor||16777215,m=e.currentTexture;v=1>v&&m&&m[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL]?t.WebGLUtils.premultiplyTint(y,v):y+(255*v<<24);var $=e.globalMatrix,b=$.a,_=$.b,x=$.c,T=$.d,E=$.tx,w=$.ty,S=e.$offsetX,D=e.$offsetY;if((0!=S||0!=D)&&(E=S*b+D*x+E,w=S*_+D*T+w),!d){(0!=a||0!=s)&&(E=a*b+s*x+E,w=a*_+s*T+w);var R=c/n;1!=R&&(b=R*b,_=R*_);var C=h/o;1!=C&&(x=C*x,T=C*T)}if(d){var P=this.vertices,O=this._verticesUint32View,L=this.vertexIndex*this.vertSize,M=0,A=0,I=0,F=0,B=0,k=0,N=0;for(M=0,I=p.length;I>M;M+=2)A=L+5*M/2,k=d[M],N=d[M+1],F=p[M],B=p[M+1],P[A+0]=b*k+x*N+E,P[A+1]=_*k+T*N+w,g?(P[A+2]=(r+(1-B)*o)/u,P[A+3]=(i+F*n)/l):(P[A+2]=(r+F*n)/u,P[A+3]=(i+B*o)/l),O[A+4]=v;if(this.hasMesh)for(var j=0,U=f.length;U>j;++j)this.indicesForMesh[this.indexIndex+j]=f[j]+this.vertexIndex;this.vertexIndex+=p.length/2,this.indexIndex+=f.length}else{var H=u,W=l,G=n,X=o;r/=H,i/=W;var P=this.vertices,O=this._verticesUint32View,L=this.vertexIndex*this.vertSize;if(g){var Y=n;n=o/H,o=Y/W,P[L++]=E,P[L++]=w,P[L++]=n+r,P[L++]=i,O[L++]=v,P[L++]=b*G+E,P[L++]=_*G+w,P[L++]=n+r,P[L++]=o+i,O[L++]=v,P[L++]=b*G+x*X+E,P[L++]=T*X+_*G+w,P[L++]=r,P[L++]=o+i,O[L++]=v,P[L++]=x*X+E,P[L++]=T*X+w,P[L++]=r,P[L++]=i,O[L++]=v}else n/=H,o/=W,P[L++]=E,P[L++]=w,P[L++]=r,P[L++]=i,O[L++]=v,P[L++]=b*G+E,P[L++]=_*G+w,P[L++]=n+r,P[L++]=i,O[L++]=v,P[L++]=b*G+x*X+E,P[L++]=T*X+_*G+w,P[L++]=n+r,P[L++]=o+i,O[L++]=v,P[L++]=x*X+E,P[L++]=T*X+w,P[L++]=r,P[L++]=o+i,O[L++]=v;if(this.hasMesh){var V=this.indicesForMesh;V[this.indexIndex+0]=0+this.vertexIndex,V[this.indexIndex+1]=1+this.vertexIndex,V[this.indexIndex+2]=2+this.vertexIndex,V[this.indexIndex+3]=0+this.vertexIndex,V[this.indexIndex+4]=2+this.vertexIndex,V[this.indexIndex+5]=3+this.vertexIndex}this.vertexIndex+=4,this.indexIndex+=6}},e.prototype.clear=function(){this.hasMesh=!1,this.vertexIndex=0,this.indexIndex=0},e}();e.WebGLVertexArrayObject=r,__reflect(r.prototype,"egret.web.WebGLVertexArrayObject")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(t,e,i){var n=r.call(this)||this;return n.clearColor=[0,0,0,0],n.useFrameBuffer=!0,n.gl=t,n._resize(e,i),n}return __extends(i,r),i.prototype._resize=function(t,e){t=t||1,e=e||1,1>t&&(t=1),1>e&&(e=1),this.width=t,this.height=e},i.prototype.resize=function(t,e){this._resize(t,e);var r=this.gl;this.frameBuffer&&(r.bindTexture(r.TEXTURE_2D,this.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null)),this.stencilBuffer&&(r.deleteRenderbuffer(this.stencilBuffer),this.stencilBuffer=null)},i.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer())},i.prototype.getFrameBuffer=function(){return this.useFrameBuffer?this.frameBuffer:null},i.prototype.initFrameBuffer=function(){if(!this.frameBuffer){var t=this.gl;this.texture=this.createTexture(),this.frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0)}},i.prototype.createTexture=function(){var r=e.WebGLRenderContext.getInstance(0,0);return t.sys._createTexture(r,this.width,this.height,null)},i.prototype.clear=function(t){var e=this.gl;t&&this.activate(),e.colorMask(!0,!0,!0,!0),e.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),e.clear(e.COLOR_BUFFER_BIT)},i.prototype.enabledStencil=function(){if(this.frameBuffer&&!this.stencilBuffer){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),this.stencilBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencilBuffer)}},i.prototype.dispose=function(){t.WebGLUtils.deleteWebGLTexture(this.texture)},i}(t.HashObject);e.WebGLRenderTarget=r,__reflect(r.prototype,"egret.web.WebGLRenderTarget")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r={},i=function(){function i(r,i){if(this._defaultEmptyTexture=null,this.glID=null,this.projectionX=0/0,this.projectionY=0/0,this.contextLost=!1,this._supportedCompressedTextureInfo=[],this.$scissorState=!1,this.vertSize=5,this.surface=t.sys.mainCanvas(r,i),!t.nativeRender){this.initWebGL(),this.$bufferStack=[];var n=this.context;this.vertexBuffer=n.createBuffer(),this.indexBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.drawCmdManager=new e.WebGLDrawCmdManager,this.vao=new e.WebGLVertexArrayObject,this.setGlobalCompositeOperation("source-over")}}return i.getInstance=function(t,e){return this.instance?this.instance:(this.instance=new i(t,e),this.instance)},i.prototype.pushBuffer=function(t){this.$bufferStack.push(t),t!=this.currentBuffer&&(this.currentBuffer,this.drawCmdManager.pushActivateBuffer(t)),this.currentBuffer=t},i.prototype.popBuffer=function(){if(!(this.$bufferStack.length<=1)){var t=this.$bufferStack.pop(),e=this.$bufferStack[this.$bufferStack.length-1];t!=e&&this.drawCmdManager.pushActivateBuffer(e),this.currentBuffer=e}},i.prototype.activateBuffer=function(t,e,r){t.rootRenderTarget.activate(),this.bindIndices||this.uploadIndicesArray(this.vao.getIndices()),t.restoreStencil(),t.restoreScissor(),this.onResize(e,r)},i.prototype.uploadVerticesArray=function(t){var e=this.context;e.bufferData(e.ARRAY_BUFFER,t,e.STREAM_DRAW)},i.prototype.uploadIndicesArray=function(t){var e=this.context;e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW),this.bindIndices=!0},i.prototype.destroy=function(){this.surface.width=this.surface.height=0},i.prototype.onResize=function(t,e){t=t||this.surface.width,e=e||this.surface.height,this.projectionX=t/2,this.projectionY=-e/2,this.context&&this.context.viewport(0,0,t,e)},i.prototype.resize=function(e,r,i){t.sys.resizeContext(this,e,r,i)},i.prototype._buildSupportedCompressedTextureInfo=function(t){for(var e=[],r=0,i=t;r<i.length;r++){var n=i[r];if(n){var o={extensionName:n.name,supportedFormats:[]};for(var a in n)o.supportedFormats.push([a,n[a]]);var a;e.push(o)}}return e},i.prototype.initWebGL=function(){this.onResize(),this.surface.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1),this.surface.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1),this.getWebGLContext();var e=this.context;this.$maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.pvrtc=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.pvrtc&&(this.pvrtc.name="WEBGL_compressed_texture_pvrtc"),this.etc1=e.getExtension("WEBGL_compressed_texture_etc1")||e.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),this.etc1&&(this.etc1.name="WEBGL_compressed_texture_etc1"),t.Capabilities.supportedCompressedTexture=t.Capabilities.supportedCompressedTexture||{},t.Capabilities.supportedCompressedTexture.pvrtc=!!this.pvrtc,t.Capabilities.supportedCompressedTexture.etc1=!!this.etc1,this._supportedCompressedTextureInfo=this._buildSupportedCompressedTextureInfo([this.etc1,this.pvrtc])},i.prototype.handleContextLost=function(){this.contextLost=!0},i.prototype.handleContextRestored=function(){this.initWebGL(),this.contextLost=!1},i.prototype.getWebGLContext=function(){var e=t.sys.getContextWebGL(this.surface);this.setContext(e)},i.prototype.setContext=function(t){this.context=t,t.id=i.glContextId++,this.glID=t.id,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,!0),t.activeTexture(t.TEXTURE0)},i.prototype.enableStencilTest=function(){var t=this.context;t.enable(t.STENCIL_TEST)},i.prototype.disableStencilTest=function(){var t=this.context;t.disable(t.STENCIL_TEST)},i.prototype.enableScissorTest=function(t){var e=this.context;e.enable(e.SCISSOR_TEST),e.scissor(t.x,t.y,t.width,t.height)},i.prototype.disableScissorTest=function(){var t=this.context;t.disable(t.SCISSOR_TEST)},i.prototype.getPixels=function(t,e,r,i,n){var o=this.context;o.readPixels(t,e,r,i,o.RGBA,o.UNSIGNED_BYTE,n)},i.prototype.createTexture=function(e){return t.sys.createTexture(this,e)},i.prototype.checkCompressedTextureInternalFormat=function(t,e){for(var r=0,i=t.length;i>r;++r)for(var n=t[r],o=n.supportedFormats,a=0,s=o.length;s>a;++a)if(o[a][1]===e)return!0;return!1},i.prototype.$debugLogCompressedTextureNotSupported=function(e,i){if(!r[i]){r[i]=!0,t.log("internalFormat = "+i+":0x"+i.toString(16)+", the current hardware does not support the corresponding compression format.");for(var n=0,o=e.length;o>n;++n){var a=e[n];if(a.supportedFormats.length>0){t.log("support = "+a.extensionName);for(var s=0,c=a.supportedFormats.length;c>s;++s){var h=a.supportedFormats[s];t.log(h[0]+" : "+h[1]+" : 0x"+h[1].toString(16))}}}}},i.prototype.createCompressedTexture=function(e,r,i,n,o){var a=this.checkCompressedTextureInternalFormat(this._supportedCompressedTextureInfo,o);if(!a)return this.$debugLogCompressedTextureNotSupported(this._supportedCompressedTextureInfo,o),this.defaultEmptyTexture;var s=this.context,c=s.createTexture();return c?(c[t.glContext]=s,c[t.is_compressed_texture]=!0,s.bindTexture(s.TEXTURE_2D,c),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),c[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,s.compressedTexImage2D(s.TEXTURE_2D,n,o,r,i,0,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.bindTexture(s.TEXTURE_2D,null),c):void(this.contextLost=!0)},i.prototype.updateTexture=function(t,e){var r=this.context;r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e)},Object.defineProperty(i.prototype,"defaultEmptyTexture",{get:function(){if(!this._defaultEmptyTexture){var e=16,r=t.sys.createCanvas(e,e),i=t.sys.getContext2d(r);i.fillStyle="white",i.fillRect(0,0,e,e),this._defaultEmptyTexture=this.createTexture(r),this._defaultEmptyTexture[t.engine_default_empty_texture]=!0}return this._defaultEmptyTexture},enumerable:!0,configurable:!0}),i.prototype.getWebGLTexture=function(e){if(!e.webGLTexture){if("image"!=e.format||e.hasCompressed2d()){if(e.hasCompressed2d()){var r=e.getCompressed2dTextureData();e.webGLTexture=this.createCompressedTexture(r.byteArray,r.width,r.height,r.level,r.glInternalFormat);var i=e.etcAlphaMask;if(i){var n=this.getWebGLTexture(i);n&&(e.webGLTexture[t.etc_alpha_mask]=n)}}}else e.webGLTexture=this.createTexture(e.source);e.$deleteSource&&e.webGLTexture&&(e.source&&(e.source.src="",e.source=null),e.clearCompressedTextureData()),e.webGLTexture&&(e.webGLTexture.smoothing=!0)}return e.webGLTexture},i.prototype.clearRect=function(t,e,r,i){if(0!=t||0!=e||r!=this.surface.width||i!=this.surface.height){var n=this.currentBuffer;if(n.$hasScissor)this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,r,i),this.setGlobalCompositeOperation("source-over");else{var o=n.globalMatrix;0==o.b&&0==o.c?(t=t*o.a+o.tx,e=e*o.d+o.ty,r*=o.a,i*=o.d,this.enableScissor(t,-e-i+n.height,r,i),this.clear(),this.disableScissor()):(this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,r,i),this.setGlobalCompositeOperation("source-over"))}}else this.clear()},i.prototype.setGlobalCompositeOperation=function(t){this.drawCmdManager.pushSetBlend(t)},i.prototype.drawImage=function(t,e,r,i,n,o,a,s,c,h,u,l,p){var d=this.currentBuffer;if(!this.contextLost&&t&&d){var f,g,v;if(t.texture||t.source&&t.source.texture)f=t.texture||t.source.texture,d.saveTransform(),g=d.$offsetX,v=d.$offsetY,d.useOffset(),d.transform(1,0,0,-1,0,c+2*a);else{if(!t.source&&!t.webGLTexture)return;f=this.getWebGLTexture(t)}f&&(this.drawTexture(f,e,r,i,n,o,a,s,c,h,u,void 0,void 0,void 0,void 0,l,p),t.source&&t.source.texture&&(d.$offsetX=g,d.$offsetY=v,d.restoreTransform()))}},i.prototype.drawMesh=function(t,e,r,i,n,o,a,s,c,h,u,l,p,d,f,g,v){var y=this.currentBuffer;if(!this.contextLost&&t&&y){var m,$,b;if(t.texture||t.source&&t.source.texture)m=t.texture||t.source.texture,y.saveTransform(),$=y.$offsetX,b=y.$offsetY,y.useOffset(),y.transform(1,0,0,-1,0,c+2*a);else{if(!t.source&&!t.webGLTexture)return;m=this.getWebGLTexture(t)}m&&(this.drawTexture(m,e,r,i,n,o,a,s,c,h,u,l,p,d,f,g,v),(t.texture||t.source&&t.source.texture)&&(y.$offsetX=$,y.$offsetY=b,y.restoreTransform()))}},i.prototype.drawTexture=function(t,e,r,i,n,o,a,s,c,h,u,l,p,d,f,g,v){var y=this.currentBuffer;if(!this.contextLost&&t&&y){p&&d?this.vao.reachMaxSize(p.length/2,d.length)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),void 0!=v&&t.smoothing!=v&&this.drawCmdManager.pushChangeSmoothing(t,v),l&&this.vao.changeToMeshIndices();var m=d?d.length/3:2;this.drawCmdManager.pushDrawTexture(t,m,this.$filter,h,u),y.currentTexture=t,this.vao.cacheArrays(y,e,r,i,n,o,a,s,c,h,u,l,p,d,g)}},i.prototype.drawRect=function(t,e,r,i){var n=this.currentBuffer;!this.contextLost&&n&&(this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushDrawRect(),n.currentTexture=null,this.vao.cacheArrays(n,0,0,r,i,t,e,r,i,r,i))},i.prototype.pushMask=function(t,e,r,i){var n=this.currentBuffer;!this.contextLost&&n&&(n.$stencilList.push({x:t,y:e,width:r,height:i}),this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPushMask(),n.currentTexture=null,this.vao.cacheArrays(n,0,0,r,i,t,e,r,i,r,i))},i.prototype.popMask=function(){var t=this.currentBuffer;if(!this.contextLost&&t){var e=t.$stencilList.pop();this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPopMask(),t.currentTexture=null,this.vao.cacheArrays(t,0,0,e.width,e.height,e.x,e.y,e.width,e.height,e.width,e.height)}},i.prototype.clear=function(){this.drawCmdManager.pushClearColor()},i.prototype.enableScissor=function(t,e,r,i){var n=this.currentBuffer;this.drawCmdManager.pushEnableScissor(t,e,r,i),n.$hasScissor=!0},i.prototype.disableScissor=function(){var t=this.currentBuffer;this.drawCmdManager.pushDisableScissor(),t.$hasScissor=!1},i.prototype.$drawWebGL=function(){if(0!=this.drawCmdManager.drawDataLen&&!this.contextLost){this.uploadVerticesArray(this.vao.getVertices()),this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getMeshIndices());for(var t=this.drawCmdManager.drawDataLen,e=0,r=0;t>r;r++){var i=this.drawCmdManager.drawData[r];e=this.drawData(i,e),7==i.type&&(this.activatedBuffer=i.buffer),(0==i.type||1==i.type||2==i.type||3==i.type)&&this.activatedBuffer&&this.activatedBuffer.$computeDrawCall&&this.activatedBuffer.$drawCalls++}this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getIndices()),this.drawCmdManager.clear(),this.vao.clear()}},i.prototype.drawData=function(r,i){if(r){var n,o=this.context,a=r.filter;switch(r.type){case 0:a?"custom"===a.type?n=e.EgretWebGLProgram.getProgram(o,a.$vertexSrc,a.$fragmentSrc,a.$shaderKey):"colorTransform"===a.type?r.texture[t.etc_alpha_mask]?(o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,r.texture[t.etc_alpha_mask]),n=e.EgretWebGLProgram.getProgram(o,e.EgretShaderLib.default_vert,e.EgretShaderLib.colorTransform_frag_etc_alphamask_frag,"colorTransform_frag_etc_alphamask_frag")):n=e.EgretWebGLProgram.getProgram(o,e.EgretShaderLib.default_vert,e.EgretShaderLib.colorTransform_frag,"colorTransform"):"blurX"===a.type?n=e.EgretWebGLProgram.getProgram(o,e.EgretShaderLib.default_vert,e.EgretShaderLib.blur_frag,"blur"):"blurY"===a.type?n=e.EgretWebGLProgram.getProgram(o,e.EgretShaderLib.default_vert,e.EgretShaderLib.blur_frag,"blur"):"glow"===a.type&&(n=e.EgretWebGLProgram.getProgram(o,e.EgretShaderLib.default_vert,e.EgretShaderLib.glow_frag,"glow")):r.texture[t.etc_alpha_mask]?(n=e.EgretWebGLProgram.getProgram(o,e.EgretShaderLib.default_vert,e.EgretShaderLib.texture_etc_alphamask_frag,t.etc_alpha_mask),o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,r.texture[t.etc_alpha_mask])):n=e.EgretWebGLProgram.getProgram(o,e.EgretShaderLib.default_vert,e.EgretShaderLib.texture_frag,"texture"),this.activeProgram(o,n),this.syncUniforms(n,a,r.textureWidth,r.textureHeight),i+=this.drawTextureElements(r,i);break;case 1:n=e.EgretWebGLProgram.getProgram(o,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(o,n),this.syncUniforms(n,a,r.textureWidth,r.textureHeight),i+=this.drawRectElements(r,i);break;case 2:n=e.EgretWebGLProgram.getProgram(o,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(o,n),this.syncUniforms(n,a,r.textureWidth,r.textureHeight),i+=this.drawPushMaskElements(r,i);break;case 3:n=e.EgretWebGLProgram.getProgram(o,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(o,n),this.syncUniforms(n,a,r.textureWidth,r.textureHeight),i+=this.drawPopMaskElements(r,i);break;case 4:this.setBlendMode(r.value);break;case 5:r.buffer.rootRenderTarget.resize(r.width,r.height),this.onResize(r.width,r.height);break;case 6:if(this.activatedBuffer){var s=this.activatedBuffer.rootRenderTarget;(0!=s.width||0!=s.height)&&s.clear(!0)}break;case 7:this.activateBuffer(r.buffer,r.width,r.height);break;case 8:var c=this.activatedBuffer;c&&(c.rootRenderTarget&&c.rootRenderTarget.enabledStencil(),c.enableScissor(r.x,r.y,r.width,r.height));break;case 9:c=this.activatedBuffer,c&&c.disableScissor();break;case 10:o.bindTexture(o.TEXTURE_2D,r.texture),r.smoothing?(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR)):(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST))}return i}},i.prototype.activeProgram=function(t,e){if(e!=this.currentProgram){t.useProgram(e.id);var r=e.attributes;for(var i in r)"aVertexPosition"===i?(t.vertexAttribPointer(r.aVertexPosition.location,2,t.FLOAT,!1,20,0),t.enableVertexAttribArray(r.aVertexPosition.location)):"aTextureCoord"===i?(t.vertexAttribPointer(r.aTextureCoord.location,2,t.FLOAT,!1,20,8),t.enableVertexAttribArray(r.aTextureCoord.location)):"aColor"===i&&(t.vertexAttribPointer(r.aColor.location,4,t.UNSIGNED_BYTE,!0,20,16),t.enableVertexAttribArray(r.aColor.location));this.currentProgram=e}},i.prototype.syncUniforms=function(t,e,r,i){var n=t.uniforms;e&&"custom"===e.type;for(var o in n)if("projectionVector"===o)n[o].setValue({x:this.projectionX,y:this.projectionY});else if("uTextureSize"===o)n[o].setValue({x:r,y:i});else if("uSampler"===o)n[o].setValue(0);else if("uSamplerAlphaMask"===o)n[o].setValue(1);else{var a=e.$uniforms[o];void 0!==a&&n[o].setValue(a)}},i.prototype.drawTextureElements=function(e,r){return t.sys.drawTextureElements(this,e,r)},i.prototype.drawRectElements=function(t,e){var r=this.context,i=3*t.count;return r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*e),i},i.prototype.drawPushMaskElements=function(t,e){var r=this.context,i=3*t.count,n=this.activatedBuffer;if(n){n.rootRenderTarget&&n.rootRenderTarget.enabledStencil(),0==n.stencilHandleCount&&(n.enableStencil(),r.clear(r.STENCIL_BUFFER_BIT));var o=n.stencilHandleCount;n.stencilHandleCount++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,o,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR),r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*e),r.stencilFunc(r.EQUAL,o+1,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return i},i.prototype.drawPopMaskElements=function(t,e){var r=this.context,i=3*t.count,n=this.activatedBuffer;if(n)if(n.stencilHandleCount--,0==n.stencilHandleCount)n.disableStencil();else{var o=n.stencilHandleCount;r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,o+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR),r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*e),r.stencilFunc(r.EQUAL,o,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return i},i.prototype.setBlendMode=function(t){var e=this.context,r=i.blendModesForGL[t];r&&e.blendFunc(r[0],r[1])},i.prototype.drawTargetWidthFilters=function(t,r){var i,n=r,o=t.length;if(o>1)for(var a=0;o-1>a;a++){var s=t[a],c=r.rootRenderTarget.width,h=r.rootRenderTarget.height;i=e.WebGLRenderBuffer.create(c,h),i.setTransform(1,0,0,1,0,0),i.globalAlpha=1,this.drawToRenderTarget(s,r,i),r!=n&&e.WebGLRenderBuffer.release(r),r=i}var u=t[o-1];this.drawToRenderTarget(u,r,this.currentBuffer),r!=n&&e.WebGLRenderBuffer.release(r)},i.prototype.drawToRenderTarget=function(t,r,i){if(!this.contextLost){this.vao.reachMaxSize()&&this.$drawWebGL(),this.pushBuffer(i);var n,o=r,a=r.rootRenderTarget.width,s=r.rootRenderTarget.height;if("blur"==t.type){var c=t.blurXFilter,h=t.blurYFilter;
0!=c.blurX&&0!=h.blurY?(n=e.WebGLRenderBuffer.create(a,s),n.setTransform(1,0,0,1,0,0),n.globalAlpha=1,this.drawToRenderTarget(t.blurXFilter,r,n),r!=o&&e.WebGLRenderBuffer.release(r),r=n,t=h):t=0===c.blurX?h:c}i.saveTransform(),i.transform(1,0,0,-1,0,s),i.currentTexture=r.rootRenderTarget.texture,this.vao.cacheArrays(i,0,0,a,s,0,0,a,s,a,s),i.restoreTransform(),this.drawCmdManager.pushDrawTexture(r.rootRenderTarget.texture,2,t,a,s),r!=o&&e.WebGLRenderBuffer.release(r),this.popBuffer()}},i.initBlendMode=function(){i.blendModesForGL={},i.blendModesForGL["source-over"]=[1,771],i.blendModesForGL.lighter=[1,1],i.blendModesForGL["lighter-in"]=[770,771],i.blendModesForGL["destination-out"]=[0,771],i.blendModesForGL["destination-in"]=[0,770]},i.glContextId=0,i.blendModesForGL=null,i}();e.WebGLRenderContext=i,__reflect(i.prototype,"egret.web.WebGLRenderContext",["egret.sys.RenderContext"]),i.initBlendMode()}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function n(i,n,o){var a=r.call(this)||this;if(a.currentTexture=null,a.globalAlpha=1,a.globalTintColor=16777215,a.stencilState=!1,a.$stencilList=[],a.stencilHandleCount=0,a.$scissorState=!1,a.scissorRect=new t.Rectangle,a.$hasScissor=!1,a.$drawCalls=0,a.$computeDrawCall=!1,a.globalMatrix=new t.Matrix,a.savedGlobalMatrix=new t.Matrix,a.$offsetX=0,a.$offsetY=0,a.context=e.WebGLRenderContext.getInstance(i,n),t.nativeRender)return o?a.surface=a.context.surface:a.surface=new egret_native.NativeRenderSurface(a,i,n,o),a.rootRenderTarget=null,a;if(a.rootRenderTarget=new e.WebGLRenderTarget(a.context.context,3,3),i&&n&&a.resize(i,n),a.root=o,a.root)a.context.pushBuffer(a),a.surface=a.context.surface,a.$computeDrawCall=!0;else{var s=a.context.activatedBuffer;s&&s.rootRenderTarget.activate(),a.rootRenderTarget.initFrameBuffer(),a.surface=a.rootRenderTarget}return a}return __extends(n,r),n.prototype.enableStencil=function(){this.stencilState||(this.context.enableStencilTest(),this.stencilState=!0)},n.prototype.disableStencil=function(){this.stencilState&&(this.context.disableStencilTest(),this.stencilState=!1)},n.prototype.restoreStencil=function(){this.stencilState?this.context.enableStencilTest():this.context.disableStencilTest()},n.prototype.enableScissor=function(t,e,r,i){this.$scissorState||(this.$scissorState=!0,this.scissorRect.setTo(t,e,r,i),this.context.enableScissorTest(this.scissorRect))},n.prototype.disableScissor=function(){this.$scissorState&&(this.$scissorState=!1,this.scissorRect.setEmpty(),this.context.disableScissorTest())},n.prototype.restoreScissor=function(){this.$scissorState?this.context.enableScissorTest(this.scissorRect):this.context.disableScissorTest()},Object.defineProperty(n.prototype,"width",{get:function(){return t.nativeRender?this.surface.width:this.rootRenderTarget.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return t.nativeRender?this.surface.height:this.rootRenderTarget.height},enumerable:!0,configurable:!0}),n.prototype.resize=function(e,r,i){return e=e||1,r=r||1,t.nativeRender?void this.surface.resize(e,r):(this.context.pushBuffer(this),(e!=this.rootRenderTarget.width||r!=this.rootRenderTarget.height)&&(this.context.drawCmdManager.pushResize(this,e,r),this.rootRenderTarget.width=e,this.rootRenderTarget.height=r),this.root&&this.context.resize(e,r,i),this.context.clear(),void this.context.popBuffer())},n.prototype.getPixels=function(e,r,i,n){void 0===i&&(i=1),void 0===n&&(n=1);var o=new Uint8Array(4*i*n);if(t.nativeRender)egret_native.activateBuffer(this),egret_native.nrGetPixels(e,r,i,n,o),egret_native.activateBuffer(null);else{var a=this.rootRenderTarget.useFrameBuffer;this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.getPixels(e,r,i,n,o),this.rootRenderTarget.useFrameBuffer=a,this.rootRenderTarget.activate()}for(var s=new Uint8Array(4*i*n),c=0;n>c;c++)for(var h=0;i>h;h++){var u=4*(i*(n-c-1)+h),l=4*(i*c+h),p=o[l+3];s[u]=Math.round(o[l]/p*255),s[u+1]=Math.round(o[l+1]/p*255),s[u+2]=Math.round(o[l+2]/p*255),s[u+3]=o[l+3]}return s},n.prototype.toDataURL=function(t,e){return this.context.surface.toDataURL(t,e)},n.prototype.destroy=function(){this.context.destroy()},n.prototype.onRenderFinish=function(){this.$drawCalls=0},n.prototype.drawFrameBufferToSurface=function(t,e,r,i,n,o,a,s,c){void 0===c&&(c=!1),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),c&&this.context.clear(),this.context.drawImage(this.rootRenderTarget,t,e,r,i,n,o,a,s,r,i,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.drawSurfaceToFrameBuffer=function(t,e,r,i,n,o,a,s,c){void 0===c&&(c=!1),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),c&&this.context.clear(),this.context.drawImage(this.context.surface,t,e,r,i,n,o,a,s,r,i,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.clear=function(){this.context.pushBuffer(this),this.context.clear(),this.context.popBuffer()},n.prototype.setTransform=function(t,e,r,i,n,o){var a=this.globalMatrix;a.a=t,a.b=e,a.c=r,a.d=i,a.tx=n,a.ty=o},n.prototype.transform=function(t,e,r,i,n,o){var a=this.globalMatrix,s=a.a,c=a.b,h=a.c,u=a.d;(1!=t||0!=e||0!=r||1!=i)&&(a.a=t*s+e*h,a.b=t*c+e*u,a.c=r*s+i*h,a.d=r*c+i*u),a.tx=n*s+o*h+a.tx,a.ty=n*c+o*u+a.ty},n.prototype.useOffset=function(){var t=this;(0!=t.$offsetX||0!=t.$offsetY)&&(t.globalMatrix.append(1,0,0,1,t.$offsetX,t.$offsetY),t.$offsetX=t.$offsetY=0)},n.prototype.saveTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=t.tx,e.ty=t.ty},n.prototype.restoreTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},n.create=function(t,e){var r=i.pop();if(r){r.resize(t,e);var o=r.globalMatrix;o.a=1,o.b=0,o.c=0,o.d=1,o.tx=0,o.ty=0,r.globalAlpha=1,r.$offsetX=0,r.$offsetY=0}else r=new n(t,e),r.$computeDrawCall=!1;return r},n.release=function(t){i.push(t)},n.autoClear=!0,n}(t.HashObject);e.WebGLRenderBuffer=r,__reflect(r.prototype,"egret.web.WebGLRenderBuffer",["egret.sys.RenderBuffer"]);var i=[]}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=["source-over","lighter","destination-out"],i="source-over",n=[],o=function(){function o(){this.wxiOS10=!1,this.nestLevel=0}return o.prototype.render=function(e,r,i,o){this.nestLevel++;var a=r,s=a.context;s.pushBuffer(a),a.transform(i.a,i.b,i.c,i.d,0,0),this.drawDisplayObject(e,a,i.tx,i.ty,!0),s.$drawWebGL();var c=a.$drawCalls;a.onRenderFinish(),s.popBuffer();var h=t.Matrix.create();if(i.$invertInto(h),a.transform(h.a,h.b,h.c,h.d,0,0),t.Matrix.release(h),this.nestLevel--,0===this.nestLevel){n.length>6&&(n.length=6);for(var u=n.length,l=0;u>l;l++)n[l].resize(0,0)}return c},o.prototype.drawDisplayObject=function(e,r,i,n,o){var a,s=0,c=e.$displayList;if(c&&!o?((e.$cacheDirty||e.$renderDirty||c.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||c.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(s+=c.drawToSurface()),a=c.$renderNode):a=e.$renderDirty?e.$getRenderNode():e.$renderNode,e.$cacheDirty=!1,a){switch(s++,r.$offsetX=i,r.$offsetY=n,a.type){case 1:this.renderBitmap(a,r);break;case 2:this.renderText(a,r);break;case 3:this.renderGraphics(a,r);break;case 4:this.renderGroup(a,r);break;case 5:this.renderMesh(a,r);break;case 6:this.renderNormalBitmap(a,r)}r.$offsetX=0,r.$offsetY=0}if(c&&!o)return s;var h=e.$children;if(h){e.sortableChildren&&e.$sortDirty&&e.sortChildren();for(var u=h.length,l=0;u>l;l++){var p=h[l],d=void 0,f=void 0,g=void 0,v=void 0;1!=p.$alpha&&(g=r.globalAlpha,r.globalAlpha*=p.$alpha),16777215!==p.tint&&(v=r.globalTintColor,r.globalTintColor=p.$tintRGB);var y=void 0;if(p.$useTranslate){var m=p.$getMatrix();d=i+p.$x,f=n+p.$y;var $=r.globalMatrix;y=t.Matrix.create(),y.a=$.a,y.b=$.b,y.c=$.c,y.d=$.d,y.tx=$.tx,y.ty=$.ty,r.transform(m.a,m.b,m.c,m.d,d,f),d=-p.$anchorOffsetX,f=-p.$anchorOffsetY}else d=i+p.$x-p.$anchorOffsetX,f=n+p.$y-p.$anchorOffsetY;switch(p.$renderMode){case 1:break;case 2:s+=this.drawWithFilter(p,r,d,f);break;case 3:s+=this.drawWithClip(p,r,d,f);break;case 4:s+=this.drawWithScrollRect(p,r,d,f);break;default:s+=this.drawDisplayObject(p,r,d,f)}if(g&&(r.globalAlpha=g),v&&(r.globalTintColor=v),y){var m=r.globalMatrix;m.a=y.a,m.b=y.b,m.c=y.c,m.d=y.d,m.tx=y.tx,m.ty=y.ty,t.Matrix.release(y)}}}return s},o.prototype.drawWithFilter=function(e,o,a,s){var c=0;if(e.$children&&0==e.$children.length&&(!e.$renderNode||0==e.$renderNode.$getRenderCount()))return c;var h,u=e.$filters,l=0!==e.$blendMode;l&&(h=r[e.$blendMode],h||(h=i));var p=e.$getOriginalBounds(),d=p.x,f=p.y,g=p.width,v=p.height;if(0>=g||0>=v)return c;if(!e.mask&&1==u.length&&("colorTransform"==u[0].type||"custom"===u[0].type&&0===u[0].padding)){var y=this.getRenderCount(e);if(!e.$children||1==y)return l&&o.context.setGlobalCompositeOperation(h),o.context.$filter=u[0],c+=e.$mask?this.drawWithClip(e,o,a,s):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,o,a,s):this.drawDisplayObject(e,o,a,s),o.context.$filter=null,l&&o.context.setGlobalCompositeOperation(i),c}var m=this.createRenderBuffer(g,v);if(m.context.pushBuffer(m),c+=e.$mask?this.drawWithClip(e,m,-d,-f):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,m,-d,-f):this.drawDisplayObject(e,m,-d,-f),m.context.popBuffer(),c>0){l&&o.context.setGlobalCompositeOperation(h),c++,o.$offsetX=a+d,o.$offsetY=s+f;var $=t.Matrix.create(),b=o.globalMatrix;$.a=b.a,$.b=b.b,$.c=b.c,$.d=b.d,$.tx=b.tx,$.ty=b.ty,o.useOffset(),o.context.drawTargetWidthFilters(u,m),b.a=$.a,b.b=$.b,b.c=$.c,b.d=$.d,b.tx=$.tx,b.ty=$.ty,t.Matrix.release($),l&&o.context.setGlobalCompositeOperation(i)}return n.push(m),c},o.prototype.getRenderCount=function(t){var e=0,r=t.$getRenderNode();if(r&&(e+=r.$getRenderCount()),t.$children)for(var i=0,n=t.$children;i<n.length;i++){var o=n[i],a=o.$filters;if(a&&a.length>0)return 2;if(o.$children)e+=this.getRenderCount(o);else{var s=o.$getRenderNode();s&&(e+=s.$getRenderCount())}}return e},o.prototype.drawWithClip=function(e,o,a,s){var c,h=0,u=0!==e.$blendMode;u&&(c=r[e.$blendMode],c||(c=i));var l=e.$scrollRect?e.$scrollRect:e.$maskRect,p=e.$mask;if(p){var d=p.$getMatrix();if(0==d.a&&0==d.b||0==d.c&&0==d.d)return h}if(p||e.$children&&0!=e.$children.length){var f=e.$getOriginalBounds(),g=f.x,v=f.y,y=f.width,m=f.height;if(0>=y||0>=m)return h;var $=this.createRenderBuffer(y,m);if($.context.pushBuffer($),h+=this.drawDisplayObject(e,$,-g,-v),p){var b=this.createRenderBuffer(y,m);b.context.pushBuffer(b);var _=t.Matrix.create();_.copyFrom(p.$getConcatenatedMatrix()),p.$getConcatenatedMatrixAt(e,_),_.translate(-g,-v),b.setTransform(_.a,_.b,_.c,_.d,_.tx,_.ty),t.Matrix.release(_),h+=this.drawDisplayObject(p,b,0,0),b.context.popBuffer(),$.context.setGlobalCompositeOperation("destination-in"),$.setTransform(1,0,0,-1,0,b.height);var x=b.rootRenderTarget.width,T=b.rootRenderTarget.height;$.context.drawTexture(b.rootRenderTarget.texture,0,0,x,T,0,0,x,T,x,T),$.setTransform(1,0,0,1,0,0),$.context.setGlobalCompositeOperation("source-over"),b.setTransform(1,0,0,1,0,0),n.push(b)}if($.context.setGlobalCompositeOperation(i),$.context.popBuffer(),h>0){h++,u&&o.context.setGlobalCompositeOperation(c),l&&o.context.pushMask(l.x+a,l.y+s,l.width,l.height);var E=t.Matrix.create(),w=o.globalMatrix;E.a=w.a,E.b=w.b,E.c=w.c,E.d=w.d,E.tx=w.tx,E.ty=w.ty,w.append(1,0,0,-1,a+g,s+v+$.height);var S=$.rootRenderTarget.width,D=$.rootRenderTarget.height;o.context.drawTexture($.rootRenderTarget.texture,0,0,S,D,0,0,S,D,S,D),l&&$.context.popMask(),u&&o.context.setGlobalCompositeOperation(i);var R=o.globalMatrix;R.a=E.a,R.b=E.b,R.c=E.c,R.d=E.d,R.tx=E.tx,R.ty=E.ty,t.Matrix.release(E)}return n.push($),h}return l&&o.context.pushMask(l.x+a,l.y+s,l.width,l.height),u&&o.context.setGlobalCompositeOperation(c),h+=this.drawDisplayObject(e,o,a,s),u&&o.context.setGlobalCompositeOperation(i),l&&o.context.popMask(),h},o.prototype.drawWithScrollRect=function(t,e,r,i){var n=0,o=t.$scrollRect?t.$scrollRect:t.$maskRect;if(o.isEmpty())return n;t.$scrollRect&&(r-=o.x,i-=o.y);var a=e.globalMatrix,s=e.context,c=!1;if(e.$hasScissor||0!=a.b||0!=a.c)e.context.pushMask(o.x+r,o.y+i,o.width,o.height);else{var h=a.a,u=a.d,l=a.tx,p=a.ty,d=o.x+r,f=o.y+i,g=d+o.width,v=f+o.height,y=void 0,m=void 0,$=void 0,b=void 0;if(1==h&&1==u)y=d+l,m=f+p,$=g+l,b=v+p;else{var _=h*d+l,x=u*f+p,T=h*g+l,E=u*f+p,w=h*g+l,S=u*v+p,D=h*d+l,R=u*v+p,C=0;_>T&&(C=_,_=T,T=C),w>D&&(C=w,w=D,D=C),y=w>_?_:w,$=T>D?T:D,x>E&&(C=x,x=E,E=C),S>R&&(C=S,S=R,R=C),m=S>x?x:S,b=E>R?E:R}s.enableScissor(y,-b+e.height,$-y,b-m),c=!0}return n+=this.drawDisplayObject(t,e,r,i),c?s.disableScissor():s.popMask(),n},o.prototype.drawNodeToBuffer=function(t,e,r,i){var n=e;n.context.pushBuffer(n),n.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),this.renderNode(t,e,0,0,i),n.context.$drawWebGL(),n.onRenderFinish(),n.context.popBuffer()},o.prototype.drawDisplayToBuffer=function(t,e,r){e.context.pushBuffer(e),r&&e.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty);var i;i=t.$renderDirty?t.$getRenderNode():t.$renderNode;var n=0;if(i)switch(n++,i.type){case 1:this.renderBitmap(i,e);break;case 2:this.renderText(i,e);break;case 3:this.renderGraphics(i,e);break;case 4:this.renderGroup(i,e);break;case 5:this.renderMesh(i,e);break;case 6:this.renderNormalBitmap(i,e)}var o=t.$children;if(o)for(var a=o.length,s=0;a>s;s++){var c=o[s];switch(c.$renderMode){case 1:break;case 2:n+=this.drawWithFilter(c,e,0,0);break;case 3:n+=this.drawWithClip(c,e,0,0);break;case 4:n+=this.drawWithScrollRect(c,e,0,0);break;default:n+=this.drawDisplayObject(c,e,0,0)}}return e.context.$drawWebGL(),e.onRenderFinish(),e.context.popBuffer(),n},o.prototype.renderNode=function(t,e,r,i,n){switch(e.$offsetX=r,e.$offsetY=i,t.type){case 1:this.renderBitmap(t,e);break;case 2:this.renderText(t,e);break;case 3:this.renderGraphics(t,e,n);break;case 4:this.renderGroup(t,e);break;case 5:this.renderMesh(t,e);break;case 6:this.renderNormalBitmap(t,e)}},o.prototype.renderNormalBitmap=function(t,e){var r=t.image;r&&e.context.drawImage(r,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX,t.drawY,t.drawW,t.drawH,t.imageWidth,t.imageHeight,t.rotated,t.smoothing)},o.prototype.renderBitmap=function(e,n){var o=e.image;if(o){var a,s,c,h=e.drawData,u=h.length,l=0,p=e.matrix,d=e.blendMode,f=e.alpha;if(p){a=t.Matrix.create();var g=n.globalMatrix;a.a=g.a,a.b=g.b,a.c=g.c,a.d=g.d,a.tx=g.tx,a.ty=g.ty,s=n.$offsetX,c=n.$offsetY,n.useOffset(),n.transform(p.a,p.b,p.c,p.d,p.tx,p.ty)}d&&n.context.setGlobalCompositeOperation(r[d]);var v;if(f==f&&(v=n.globalAlpha,n.globalAlpha*=f),e.filter){for(n.context.$filter=e.filter;u>l;)n.context.drawImage(o,h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);n.context.$filter=null}else for(;u>l;)n.context.drawImage(o,h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);if(d&&n.context.setGlobalCompositeOperation(i),f==f&&(n.globalAlpha=v),p){var y=n.globalMatrix;y.a=a.a,y.b=a.b,y.c=a.c,y.d=a.d,y.tx=a.tx,y.ty=a.ty,n.$offsetX=s,n.$offsetY=c,t.Matrix.release(a)}}},o.prototype.renderMesh=function(e,n){var o,a,s,c=e.image,h=e.drawData,u=h.length,l=0,p=e.matrix,d=e.blendMode,f=e.alpha;if(p){o=t.Matrix.create();var g=n.globalMatrix;o.a=g.a,o.b=g.b,o.c=g.c,o.d=g.d,o.tx=g.tx,o.ty=g.ty,a=n.$offsetX,s=n.$offsetY,n.useOffset(),n.transform(p.a,p.b,p.c,p.d,p.tx,p.ty)}d&&n.context.setGlobalCompositeOperation(r[d]);var v;if(f==f&&(v=n.globalAlpha,n.globalAlpha*=f),e.filter){for(n.context.$filter=e.filter;u>l;)n.context.drawMesh(c,h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);n.context.$filter=null}else for(;u>l;)n.context.drawMesh(c,h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],h[l++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);if(d&&n.context.setGlobalCompositeOperation(i),f==f&&(n.globalAlpha=v),p){var y=n.globalMatrix;y.a=o.a,y.b=o.b,y.c=o.c,y.d=o.d,y.tx=o.tx,y.ty=o.ty,n.$offsetX=a,n.$offsetY=s,t.Matrix.release(o)}},o.prototype.___renderText____=function(r,i){var n=r.width-r.x,o=r.height-r.y;if(!(0>=n||0>=o)&&n&&o&&0!==r.drawData.length){var a=t.sys.DisplayList.$canvasScaleX,s=t.sys.DisplayList.$canvasScaleY,c=i.context.$maxTextureSize;n*a>c&&(a*=c/(n*a)),o*s>c&&(s*=c/(o*s)),n*=a,o*=s;var h=r.x*a,u=r.y*s;(r.$canvasScaleX!==a||r.$canvasScaleY!==s)&&(r.$canvasScaleX=a,r.$canvasScaleY=s,r.dirtyRender=!0),(h||u)&&i.transform(1,0,0,1,h/a,u/s),r.dirtyRender&&e.TextAtlasRender.analysisTextNodeAndFlushDrawLabel(r);var l=r[e.property_drawLabel];if(l&&l.length>0){for(var p=i.$offsetX,d=i.$offsetY,f=null,g=0,v=0,y=null,m=null,$=null,b=0,_=l.length;_>b;++b){f=l[b],g=f.anchorX,v=f.anchorY,y=f.textBlocks,i.$offsetX=p+g;for(var x=0,T=y.length;T>x;++x)m=y[x],x>0&&(i.$offsetX-=m.canvasWidthOffset),i.$offsetY=d+v-(m.measureHeight+(m.stroke2?m.canvasHeightOffset:0))/2,$=m.line.page,i.context.drawTexture($.webGLTexture,m.u,m.v,m.contentWidth,m.contentHeight,0,0,m.contentWidth,m.contentHeight,$.pageWidth,$.pageHeight),i.$offsetX+=m.contentWidth-m.canvasWidthOffset}i.$offsetX=p,i.$offsetY=d}(h||u)&&i.transform(1,0,0,1,-h/a,-u/s),r.dirtyRender=!1}},o.prototype.renderText=function(r,i){if(e.textAtlasRenderEnable)return void this.___renderText____(r,i);var n=r.width-r.x,o=r.height-r.y;if(!(0>=n||0>=o)&&n&&o&&0!=r.drawData.length){var a=t.sys.DisplayList.$canvasScaleX,s=t.sys.DisplayList.$canvasScaleY,c=i.context.$maxTextureSize;n*a>c&&(a*=c/(n*a)),o*s>c&&(s*=c/(o*s)),n*=a,o*=s;var h=r.x*a,u=r.y*s;if((r.$canvasScaleX!=a||r.$canvasScaleY!=s)&&(r.$canvasScaleX=a,r.$canvasScaleY=s,r.dirtyRender=!0),this.wxiOS10?(this.canvasRenderer||(this.canvasRenderer=new t.CanvasRenderer),r.dirtyRender&&(this.canvasRenderBuffer=new e.CanvasRenderBuffer(n,o))):this.canvasRenderBuffer&&this.canvasRenderBuffer.context?r.dirtyRender&&this.canvasRenderBuffer.resize(n,o):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(n,o)),this.canvasRenderBuffer.context){if((1!=a||1!=s)&&this.canvasRenderBuffer.context.setTransform(a,0,0,s,0,0),h||u?(r.dirtyRender&&this.canvasRenderBuffer.context.setTransform(a,0,0,s,-h,-u),i.transform(1,0,0,1,h/a,u/s)):(1!=a||1!=s)&&this.canvasRenderBuffer.context.setTransform(a,0,0,s,0,0),r.dirtyRender){var l=this.canvasRenderBuffer.surface;if(this.canvasRenderer.renderText(r,this.canvasRenderBuffer.context),this.wxiOS10)l.isCanvas=!0,r.$texture=l;else{var p=r.$texture;p?i.context.updateTexture(p,l):(p=i.context.createTexture(l),r.$texture=p)}r.$textureWidth=l.width,r.$textureHeight=l.height}var d=r.$textureWidth,f=r.$textureHeight;i.context.drawTexture(r.$texture,0,0,d,f,0,0,d/a,f/s,d,f),(h||u)&&(r.dirtyRender&&this.canvasRenderBuffer.context.setTransform(a,0,0,s,0,0),i.transform(1,0,0,1,-h/a,-u/s)),r.dirtyRender=!1}}},o.prototype.renderGraphics=function(r,i,n){var o=r.width,a=r.height;if(!(0>=o||0>=a)&&o&&a&&0!=r.drawData.length){var s=t.sys.DisplayList.$canvasScaleX,c=t.sys.DisplayList.$canvasScaleY;(1>o*s||1>a*c)&&(s=c=1),(r.$canvasScaleX!=s||r.$canvasScaleY!=c)&&(r.$canvasScaleX=s,r.$canvasScaleY=c,r.dirtyRender=!0),o*=s,a*=c;var h=Math.ceil(o),u=Math.ceil(a);if(s*=h/o,c*=u/a,o=h,a=u,this.wxiOS10?(this.canvasRenderer||(this.canvasRenderer=new t.CanvasRenderer),r.dirtyRender&&(this.canvasRenderBuffer=new e.CanvasRenderBuffer(o,a))):this.canvasRenderBuffer&&this.canvasRenderBuffer.context?r.dirtyRender&&this.canvasRenderBuffer.resize(o,a):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(o,a)),this.canvasRenderBuffer.context){(1!=s||1!=c)&&this.canvasRenderBuffer.context.setTransform(s,0,0,c,0,0),(r.x||r.y)&&((r.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(-r.x,-r.y),i.transform(1,0,0,1,r.x,r.y));var l=this.canvasRenderBuffer.surface;if(n){this.canvasRenderer.renderGraphics(r,this.canvasRenderBuffer.context,!0);var p=void 0;this.wxiOS10?(l.isCanvas=!0,p=l):(t.WebGLUtils.deleteWebGLTexture(l),p=i.context.getWebGLTexture(l)),i.context.drawTexture(p,0,0,o,a,0,0,o,a,l.width,l.height)}else{if(r.dirtyRender){if(this.canvasRenderer.renderGraphics(r,this.canvasRenderBuffer.context),this.wxiOS10)l.isCanvas=!0,r.$texture=l;else{var p=r.$texture;p?i.context.updateTexture(p,l):(p=i.context.createTexture(l),r.$texture=p)}r.$textureWidth=l.width,r.$textureHeight=l.height}var d=r.$textureWidth,f=r.$textureHeight;i.context.drawTexture(r.$texture,0,0,d,f,0,0,d/s,f/c,d,f)}(r.x||r.y)&&((r.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(r.x,r.y),i.transform(1,0,0,1,-r.x,-r.y)),n||(r.dirtyRender=!1)}}},o.prototype.renderGroup=function(e,r){var i,n,o,a=e.matrix;if(a){i=t.Matrix.create();var s=r.globalMatrix;i.a=s.a,i.b=s.b,i.c=s.c,i.d=s.d,i.tx=s.tx,i.ty=s.ty,n=r.$offsetX,o=r.$offsetY,r.useOffset(),r.transform(a.a,a.b,a.c,a.d,a.tx,a.ty)}for(var c=e.drawData,h=c.length,u=0;h>u;u++){var l=c[u];this.renderNode(l,r,r.$offsetX,r.$offsetY)}if(a){var p=r.globalMatrix;p.a=i.a,p.b=i.b,p.c=i.c,p.d=i.d,p.tx=i.tx,p.ty=i.ty,r.$offsetX=n,r.$offsetY=o,t.Matrix.release(i)}},o.prototype.createRenderBuffer=function(t,r){var i=n.pop();return i?i.resize(t,r):(i=new e.WebGLRenderBuffer(t,r),i.$computeDrawCall=!1),i},o}();e.WebGLRenderer=o,__reflect(o.prototype,"egret.web.WebGLRenderer",["egret.sys.SystemRenderer"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(t){function e(e,r,i,n,o,a,s,c){var h=t.call(this)||this;return h._width=0,h._height=0,h._border=0,h.line=null,h.x=0,h.y=0,h.u=0,h.v=0,h.tag="",h.measureWidth=0,h.measureHeight=0,h.canvasWidthOffset=0,h.canvasHeightOffset=0,h.stroke2=0,h._width=e,h._height=r,h._border=c,h.measureWidth=i,h.measureHeight=n,h.canvasWidthOffset=o,h.canvasHeightOffset=a,h.stroke2=s,h}return __extends(e,t),Object.defineProperty(e.prototype,"border",{get:function(){return this._border},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width+2*this.border},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height+2*this.border},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentWidth",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"page",{get:function(){return this.line?this.line.page:null},enumerable:!0,configurable:!0}),e.prototype.updateUV=function(){var t=this.line;return t?(this.u=t.x+this.x+1*this.border,this.v=t.y+this.y+1*this.border,!0):!1},Object.defineProperty(e.prototype,"subImageOffsetX",{get:function(){var t=this.line;return t?t.x+this.x+this.border:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subImageOffsetY",{get:function(){var t=this.line;return t?t.y+this.y+this.border:0},enumerable:!0,configurable:!0}),e}(t.HashObject);e.TextBlock=r,__reflect(r.prototype,"egret.web.TextBlock");var i=function(t){function e(e){var r=t.call(this)||this;return r.page=null,r.textBlocks=[],r.dynamicMaxHeight=0,r.maxWidth=0,r.x=0,r.y=0,r.maxWidth=e,r}return __extends(e,t),e.prototype.isCapacityOf=function(t){if(!t)return!1;var e=0,r=0,i=this.lastTextBlock();return i&&(e=i.x+i.width,r=i.y),e+t.width>this.maxWidth?!1:this.dynamicMaxHeight>0&&(t.height>this.dynamicMaxHeight||t.height/this.dynamicMaxHeight<.5)?!1:!0},e.prototype.lastTextBlock=function(){var t=this.textBlocks;return t.length>0?t[t.length-1]:null},e.prototype.addTextBlock=function(t,e){if(!t)return!1;if(e&&!this.isCapacityOf(t))return!1;var r=0,i=0,n=this.lastTextBlock();return n&&(r=n.x+n.width,i=n.y),t.x=r,t.y=i,t.line=this,this.textBlocks.push(t),this.dynamicMaxHeight=Math.max(this.dynamicMaxHeight,t.height),!0},e}(t.HashObject);e.Line=i,__reflect(i.prototype,"egret.web.Line");var n=function(t){function e(e,r){var i=t.call(this)||this;return i.lines=[],i.pageWidth=0,i.pageHeight=0,i.webGLTexture=null,i.pageWidth=e,i.pageHeight=r,i}return __extends(e,t),e.prototype.addLine=function(t){if(!t)return!1;var e=0,r=0,i=this.lines;if(i.length>0){var n=i[i.length-1];e=n.x,r=n.y+n.dynamicMaxHeight}return t.maxWidth>this.pageWidth?(console.error("line.maxWidth = "+t.maxWidth+", this.pageWidth = "+this.pageWidth),!1):r+t.dynamicMaxHeight>this.pageHeight?!1:(t.x=e,t.y=r,t.page=this,this.lines.push(t),!0)},e}(t.HashObject);e.Page=n,__reflect(n.prototype,"egret.web.Page");var o=function(t){function e(e,r){var i=t.call(this)||this;return i._pages=[],i._sortLines=[],i._maxSize=1024,i._border=1,i._maxSize=e,i._border=r,i}return __extends(e,t),e.prototype.addTextBlock=function(t){var e=this._addTextBlock(t);if(!e)return!1;t.updateUV();for(var r=!1,i=e,n=this._sortLines,o=0,a=n;o<a.length;o++){var s=a[o];if(s===i[1]){r=!0;break}}return r||n.push(i[1]),this.sort(),!0},e.prototype._addTextBlock=function(t){if(!t)return null;if(t.width>this._maxSize||t.height>this._maxSize)return null;for(var e=this._sortLines,r=0,n=e.length;n>r;++r){var o=e[r];if(o.isCapacityOf(t)&&o.addTextBlock(t,!1))return[o.page,o]}var a=new i(this._maxSize);if(!a.addTextBlock(t,!0))return console.error("_addTextBlock !newLine.addTextBlock(textBlock, true)"),null;for(var s=this._pages,r=0,c=s.length;c>r;++r){var h=s[r];if(h.addLine(a))return[h,a]}var u=this.createPage(this._maxSize,this._maxSize);return u.addLine(a)?[u,a]:(console.error("_addText newPage.addLine failed"),null)},e.prototype.createPage=function(t,e){var r=new n(t,e);return this._pages.push(r),r},e.prototype.sort=function(){if(!(this._sortLines.length<=1)){var t=function(t,e){return t.dynamicMaxHeight<e.dynamicMaxHeight?-1:1};this._sortLines=this._sortLines.sort(t)}},e.prototype.createTextBlock=function(t,e,i,n,o,a,s,c){var h=new r(e,i,n,o,a,s,c,this._border);return this.addTextBlock(h)?(h.tag=t,h):null},e}(t.HashObject);e.Book=o,__reflect(o.prototype,"egret.web.Book")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){e.textAtlasRenderEnable=!1,e.__textAtlasRender__=null,e.property_drawLabel="DrawLabel";var r=!1,i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anchorX=0,e.anchorY=0,e.textBlocks=[],e}return __extends(e,t),e.prototype.clear=function(){this.anchorX=0,this.anchorY=0,this.textBlocks.length=0},e.create=function(){var t=e.pool;return 0===t.length&&t.push(new e),t.pop()},e.back=function(t,r){if(t){var i=e.pool;if(r&&i.indexOf(t)>=0)return void console.error("DrawLabel.back repeat");t.clear(),i.push(t)}},e.pool=[],e}(t.HashObject);e.DrawLabel=i,__reflect(i.prototype,"egret.web.DrawLabel");var n=function(e){function i(i,n){var o=e.call(this)||this;o.format=null;var a=0;r&&(a=i.textColor,i.textColor=16711680),o.textColor=i.textColor,o.strokeColor=i.strokeColor,o.size=i.size,o.stroke=i.stroke,o.bold=i.bold,o.italic=i.italic,o.fontFamily=i.fontFamily,o.format=n,o.font=t.getFontString(i,o.format);var s=n.textColor?n.textColor:i.textColor,c=n.strokeColor?n.strokeColor:i.strokeColor,h=n.stroke?n.stroke:i.stroke,u=n.size?n.size:i.size;return o.description=""+o.font+"-"+u,o.description+="-"+t.toColorString(s),o.description+="-"+t.toColorString(c),h&&(o.description+="-"+2*h),r&&(i.textColor=a),o}return __extends(i,e),i}(t.HashObject);__reflect(n.prototype,"StyleInfo");var o=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t["char"]="",t.styleInfo=null,t.hashCodeString="",t.charWithStyleHashCode=0,t.measureWidth=0,t.measureHeight=0,t.canvasWidthOffset=0,t.canvasHeightOffset=0,t.stroke2=0,t}return __extends(r,e),r.prototype.reset=function(e,r){return this["char"]=e,this.styleInfo=r,this.hashCodeString=e+":"+r.description,this.charWithStyleHashCode=t.NumberUtils.convertStringToHashCode(this.hashCodeString),this.canvasWidthOffset=0,this.canvasHeightOffset=0,this.stroke2=0,this},r.prototype.measureAndDraw=function(e){var r=e;if(r){var i=this["char"],n=this.styleInfo.format,o=n.textColor?n.textColor:this.styleInfo.textColor,a=n.strokeColor?n.strokeColor:this.styleInfo.strokeColor,s=n.stroke?n.stroke:this.styleInfo.stroke,c=n.size?n.size:this.styleInfo.size;this.measureWidth=this.measure(i,this.styleInfo,c),this.measureHeight=c;var h=this.measureWidth,u=this.measureHeight,l=2*s;l>0&&(h+=2*l,u+=2*l),this.stroke2=l,r.width=h=Math.ceil(h)+4,r.height=u=Math.ceil(u)+4,this.canvasWidthOffset=(r.width-this.measureWidth)/2,this.canvasHeightOffset=(r.height-this.measureHeight)/2;var p=3,d=Math.pow(10,p);this.canvasWidthOffset=Math.floor(this.canvasWidthOffset*d)/d,this.canvasHeightOffset=Math.floor(this.canvasHeightOffset*d)/d;var f=t.sys.getContext2d(r);f.save(),f.textAlign="center",f.textBaseline="middle",f.lineJoin="round",f.font=this.styleInfo.font,f.fillStyle=t.toColorString(o),f.strokeStyle=t.toColorString(a),f.clearRect(0,0,r.width,r.height),s&&(f.lineWidth=2*s,f.strokeText(i,r.width/2,r.height/2)),f.fillText(i,r.width/2,r.height/2),f.restore()}},r.prototype.measure=function(e,i,n){var o=r.chineseCharactersRegExp.test(e);if(o&&r.chineseCharacterMeasureFastMap[i.font])return r.chineseCharacterMeasureFastMap[i.font];var a=t.sys.measureText(e,i.fontFamily,n||i.size,i.bold,i.italic);return o&&(r.chineseCharacterMeasureFastMap[i.font]=a),a},r.chineseCharactersRegExp=new RegExp("^[-]$"),r.chineseCharacterMeasureFastMap={},r}(t.HashObject);__reflect(o.prototype,"CharImageRender");var a=function(a){function s(t,r,i){var n=a.call(this)||this;return n.book=null,n.charImageRender=new o,n.textBlockMap={},n._canvas=null,n.textAtlasTextureCache=[],n.webglRenderContext=null,n.webglRenderContext=t,n.book=new e.Book(r,i),n}return __extends(s,a),s.analysisTextNodeAndFlushDrawLabel=function(o){if(o){if(!e.__textAtlasRender__){var a=t.web.WebGLRenderContext.getInstance(0,0);e.__textAtlasRender__=new s(a,512,r?12:1)}o[e.property_drawLabel]=o[e.property_drawLabel]||[];for(var c=o[e.property_drawLabel],h=0,u=c;h<u.length;h++){var l=u[h];i.back(l,!1)}c.length=0;for(var p=4,d=o.drawData,f=0,g=0,v="",y={},m=[],$=0,b=d.length;b>$;$+=p){f=d[$+0],g=d[$+1],v=d[$+2],y=d[$+3]||{},m.length=0,e.__textAtlasRender__.convertLabelStringToTextAtlas(v,new n(o,y),m);var l=i.create();l.anchorX=f,l.anchorY=g,l.textBlocks=[].concat(m),c.push(l)}}},s.prototype.convertLabelStringToTextAtlas=function(e,i,n){for(var o=this.canvas,a=this.charImageRender,s=this.textBlockMap,c=0,h=e;c<h.length;c++){var u=h[c];if(a.reset(u,i),s[a.charWithStyleHashCode])n.push(s[a.charWithStyleHashCode]);else{a.measureAndDraw(o);var l=this.book.createTextBlock(u,o.width,o.height,a.measureWidth,a.measureHeight,a.canvasWidthOffset,a.canvasHeightOffset,a.stroke2);if(l){n.push(l),s[a.charWithStyleHashCode]=l;var p=l.page;p.webGLTexture||(p.webGLTexture=this.createTextTextureAtlas(p.pageWidth,p.pageHeight,r));var d=this.webglRenderContext.context;p.webGLTexture[t.glContext]=d,d.bindTexture(d.TEXTURE_2D,p.webGLTexture),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),p.webGLTexture[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,d.texSubImage2D(d.TEXTURE_2D,0,l.subImageOffsetX,l.subImageOffsetY,d.RGBA,d.UNSIGNED_BYTE,o),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1)}}}},s.prototype.createTextTextureAtlas=function(e,r,i){var n=null;if(i){var o=t.sys.createCanvas(e,e),a=t.sys.getContext2d(o);a.fillStyle="black",a.fillRect(0,0,e,e),n=t.sys.createTexture(this.webglRenderContext,o)}else n=t.sys._createTexture(this.webglRenderContext,e,r,null);return n&&this.textAtlasTextureCache.push(n),n
},Object.defineProperty(s.prototype,"canvas",{get:function(){return this._canvas||(this._canvas=t.sys.createCanvas(24,24)),this._canvas},enumerable:!0,configurable:!0}),s}(t.HashObject);e.TextAtlasRender=a,__reflect(a.prototype,"egret.web.TextAtlasRender")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(t,e,r){this.gl=t,this.name=r.name,this.type=r.type,this.size=r.size,this.location=t.getAttribLocation(e,this.name),this.count=0,this.initCount(t),this.format=t.FLOAT,this.initFormat(t)}return t.prototype.initCount=function(t){var e=this.type;switch(e){case 5126:case 5120:case 5121:case 5123:this.count=1;break;case 35664:this.count=2;break;case 35665:this.count=3;break;case 35666:this.count=4}},t.prototype.initFormat=function(t){var e=this.type;switch(e){case 5126:case 35664:case 35665:case 35666:this.format=t.FLOAT;break;case 5121:this.format=t.UNSIGNED_BYTE;break;case 5123:this.format=t.UNSIGNED_SHORT;break;case 5120:this.format=t.BYTE}},t}();t.EgretWebGLAttribute=e,__reflect(e.prototype,"egret.web.EgretWebGLAttribute")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e,r){var i=t.createShader(e);t.shaderSource(i,r),t.compileShader(i);var n=t.getShaderParameter(i,t.COMPILE_STATUS);return n||(console.log("shader not compiled!"),console.log(t.getShaderInfoLog(i))),i}function r(t,e,r){var i=t.createProgram();return t.attachShader(i,e),t.attachShader(i,r),t.linkProgram(i),i}function i(e,r){for(var i={},n=e.getProgramParameter(r,e.ACTIVE_ATTRIBUTES),o=0;n>o;o++){var a=e.getActiveAttrib(r,o),s=a.name,c=new t.EgretWebGLAttribute(e,r,a);i[s]=c}return i}function n(e,r){for(var i={},n=e.getProgramParameter(r,e.ACTIVE_UNIFORMS),o=0;n>o;o++){var a=e.getActiveUniform(r,o),s=a.name,c=new t.EgretWebGLUniform(e,r,a);i[s]=c}return i}var o=function(){function t(t,o,a){this.vshaderSource=o,this.fshaderSource=a,this.vertexShader=e(t,t.VERTEX_SHADER,this.vshaderSource),this.fragmentShader=e(t,t.FRAGMENT_SHADER,this.fshaderSource),this.id=r(t,this.vertexShader,this.fragmentShader),this.uniforms=n(t,this.id),this.attributes=i(t,this.id)}return t.getProgram=function(e,r,i,n){return this.programCache[n]||(this.programCache[n]=new t(e,r,i)),this.programCache[n]},t.deleteProgram=function(t,e,r,i){},t.programCache={},t}();t.EgretWebGLProgram=o,__reflect(o.prototype,"egret.web.EgretWebGLProgram")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(t,e,r){this.gl=t,this.name=r.name,this.type=r.type,this.size=r.size,this.location=t.getUniformLocation(e,this.name),this.setDefaultValue(),this.generateSetValue(),this.generateUpload()}return t.prototype.setDefaultValue=function(){var t=this.type;switch(t){case 5126:case 35678:case 35680:case 35670:case 5124:this.value=0;break;case 35664:case 35671:case 35667:this.value=[0,0];break;case 35665:case 35672:case 35668:this.value=[0,0,0];break;case 35666:case 35673:case 35669:this.value=[0,0,0,0];break;case 35674:this.value=new Float32Array([1,0,0,1]);break;case 35675:this.value=new Float32Array([1,0,0,0,1,0,0,0,1]);break;case 35676:this.value=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},t.prototype.generateSetValue=function(){var t=this.type;switch(t){case 5126:case 35678:case 35680:case 35670:case 5124:this.setValue=function(t){var e=this.value!==t;this.value=t,e&&this.upload()};break;case 35664:case 35671:case 35667:this.setValue=function(t){var e=this.value[0]!==t.x||this.value[1]!==t.y;this.value[0]=t.x,this.value[1]=t.y,e&&this.upload()};break;case 35665:case 35672:case 35668:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.upload()};break;case 35666:case 35673:case 35669:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.value[3]=t.w,this.upload()};break;case 35674:case 35675:case 35676:this.setValue=function(t){this.value.set(t),this.upload()}}},t.prototype.generateUpload=function(){var t=this.gl,e=this.type,r=this.location;switch(e){case 5126:this.upload=function(){var e=this.value;t.uniform1f(r,e)};break;case 35664:this.upload=function(){var e=this.value;t.uniform2f(r,e[0],e[1])};break;case 35665:this.upload=function(){var e=this.value;t.uniform3f(r,e[0],e[1],e[2])};break;case 35666:this.upload=function(){var e=this.value;t.uniform4f(r,e[0],e[1],e[2],e[3])};break;case 35678:case 35680:case 35670:case 5124:this.upload=function(){var e=this.value;t.uniform1i(r,e)};break;case 35671:case 35667:this.upload=function(){var e=this.value;t.uniform2i(r,e[0],e[1])};break;case 35672:case 35668:this.upload=function(){var e=this.value;t.uniform3i(r,e[0],e[1],e[2])};break;case 35673:case 35669:this.upload=function(){var e=this.value;t.uniform4i(r,e[0],e[1],e[2],e[3])};break;case 35674:this.upload=function(){var e=this.value;t.uniformMatrix2fv(r,!1,e)};break;case 35675:this.upload=function(){var e=this.value;t.uniformMatrix3fv(r,!1,e)};break;case 35676:this.upload=function(){var e=this.value;t.uniformMatrix4fv(r,!1,e)}}},t}();t.EgretWebGLUniform=e,__reflect(e.prototype,"egret.web.EgretWebGLUniform")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){}return t.blur_frag="precision mediump float;\r\nuniform vec2 blur;\r\nuniform sampler2D uSampler;\r\nvarying vec2 vTextureCoord;\r\nuniform vec2 uTextureSize;\r\nvoid main()\r\n{\r\n    const int sampleRadius = 5;\r\n    const int samples = sampleRadius * 2 + 1;\r\n    vec2 blurUv = blur / uTextureSize;\r\n    vec4 color = vec4(0, 0, 0, 0);\r\n    vec2 uv = vec2(0.0, 0.0);\r\n    blurUv /= float(sampleRadius);\r\n\r\n    for (int i = -sampleRadius; i <= sampleRadius; i++) {\r\n        uv.x = vTextureCoord.x + float(i) * blurUv.x;\r\n        uv.y = vTextureCoord.y + float(i) * blurUv.y;\r\n        color += texture2D(uSampler, uv);\r\n    }\r\n\r\n    color /= float(samples);\r\n    gl_FragColor = color;\r\n}",t.colorTransform_frag="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform mat4 matrix;\r\nuniform vec4 colorAdd;\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(void) {\r\n    vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n    if(texColor.a > 0.) {\r\n        // alpha\r\n        texColor = vec4(texColor.rgb / texColor.a, texColor.a);\r\n    }\r\n    vec4 locColor = clamp(texColor * matrix + colorAdd, 0., 1.);\r\n    gl_FragColor = vColor * vec4(locColor.rgb * locColor.a, locColor.a);\r\n}",t.default_vert="attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nattribute vec4 aColor;\r\n\r\nuniform vec2 projectionVector;\r\n// uniform vec2 offsetVector;\r\n\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\n\r\nconst vec2 center = vec2(-1.0, 1.0);\r\n\r\nvoid main(void) {\r\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\r\n   vTextureCoord = aTextureCoord;\r\n   vColor = aColor;\r\n}",t.glow_frag="precision highp float;\r\nvarying vec2 vTextureCoord;\r\n\r\nuniform sampler2D uSampler;\r\n\r\nuniform float dist;\r\nuniform float angle;\r\nuniform vec4 color;\r\nuniform float alpha;\r\nuniform float blurX;\r\nuniform float blurY;\r\n// uniform vec4 quality;\r\nuniform float strength;\r\nuniform float inner;\r\nuniform float knockout;\r\nuniform float hideObject;\r\n\r\nuniform vec2 uTextureSize;\r\n\r\nfloat random(vec2 scale)\r\n{\r\n    return fract(sin(dot(gl_FragCoord.xy, scale)) * 43758.5453);\r\n}\r\n\r\nvoid main(void) {\r\n    vec2 px = vec2(1.0 / uTextureSize.x, 1.0 / uTextureSize.y);\r\n    // TODO \r\n    const float linearSamplingTimes = 7.0;\r\n    const float circleSamplingTimes = 12.0;\r\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\r\n    vec4 curColor;\r\n    float totalAlpha = 0.0;\r\n    float maxTotalAlpha = 0.0;\r\n    float curDistanceX = 0.0;\r\n    float curDistanceY = 0.0;\r\n    float offsetX = dist * cos(angle) * px.x;\r\n    float offsetY = dist * sin(angle) * px.y;\r\n\r\n    const float PI = 3.14159265358979323846264;\r\n    float cosAngle;\r\n    float sinAngle;\r\n    float offset = PI * 2.0 / circleSamplingTimes * random(vec2(12.9898, 78.233));\r\n    float stepX = blurX * px.x / linearSamplingTimes;\r\n    float stepY = blurY * px.y / linearSamplingTimes;\r\n    for (float a = 0.0; a <= PI * 2.0; a += PI * 2.0 / circleSamplingTimes) {\r\n        cosAngle = cos(a + offset);\r\n        sinAngle = sin(a + offset);\r\n        for (float i = 1.0; i <= linearSamplingTimes; i++) {\r\n            curDistanceX = i * stepX * cosAngle;\r\n            curDistanceY = i * stepY * sinAngle;\r\n            if (vTextureCoord.x + curDistanceX - offsetX >= 0.0 && vTextureCoord.y + curDistanceY + offsetY <= 1.0){\r\n                curColor = texture2D(uSampler, vec2(vTextureCoord.x + curDistanceX - offsetX, vTextureCoord.y + curDistanceY + offsetY));\r\n                totalAlpha += (linearSamplingTimes - i) * curColor.a;\r\n            }\r\n            maxTotalAlpha += (linearSamplingTimes - i);\r\n        }\r\n    }\r\n\r\n    ownColor.a = max(ownColor.a, 0.0001);\r\n    ownColor.rgb = ownColor.rgb / ownColor.a;\r\n\r\n    float outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * max(min(hideObject, knockout), 1. - ownColor.a);\r\n    float innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * ownColor.a;\r\n\r\n    ownColor.a = max(ownColor.a * knockout * (1. - hideObject), 0.0001);\r\n    vec3 mix1 = mix(ownColor.rgb, color.rgb, innerGlowAlpha / (innerGlowAlpha + ownColor.a));\r\n    vec3 mix2 = mix(mix1, color.rgb, outerGlowAlpha / (innerGlowAlpha + ownColor.a + outerGlowAlpha));\r\n    float resultAlpha = min(ownColor.a + outerGlowAlpha + innerGlowAlpha, 1.);\r\n    gl_FragColor = vec4(mix2 * resultAlpha, resultAlpha);\r\n}",t.primitive_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = vColor;\r\n}",t.texture_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;\r\n}",t.texture_etc_alphamask_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uSamplerAlphaMask;\r\nvoid main(void) {\r\nfloat alpha = texture2D(uSamplerAlphaMask, vTextureCoord).r;\r\nif (alpha < 0.0039) { discard; }\r\nvec4 v4Color = texture2D(uSampler, vTextureCoord);\r\nv4Color.rgb = v4Color.rgb * alpha;\r\nv4Color.a = alpha;\r\ngl_FragColor = v4Color * vColor;\r\n}",t.colorTransform_frag_etc_alphamask_frag="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform mat4 matrix;\r\nuniform vec4 colorAdd;\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uSamplerAlphaMask;\r\n\r\nvoid main(void){\r\nfloat alpha = texture2D(uSamplerAlphaMask, vTextureCoord).r;\r\nif (alpha < 0.0039) { discard; }\r\nvec4 texColor = texture2D(uSampler, vTextureCoord);\r\nif(texColor.a > 0.0) {\r\n // alpha\r\ntexColor = vec4(texColor.rgb / texColor.a, texColor.a);\r\n}\r\nvec4 v4Color = clamp(texColor * matrix + colorAdd, 0.0, 1.0);\r\nv4Color.rgb = v4Color.rgb * alpha;\r\nv4Color.a = alpha;\r\ngl_FragColor = v4Color * vColor;\r\n}",t}();t.EgretShaderLib=e,__reflect(e.prototype,"egret.web.EgretShaderLib")}(e=t.web||(t.web={}))}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r},__decorate=this&&this.__decorate||function(t,e,r,i){var n,o=arguments.length,a=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(3>o?n(a):o>3?n(e,r,a):n(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a},RES;!function(t){}(RES||(RES={}));var RES;!function(t){var e=function(){function e(){this.groupTotalDic={},this.numLoadedDic={},this.groupErrorDic={},this.retryTimesDic={},this.maxRetryTimes=3,this.reporterDic={},this.dispatcherDic={},this.failedList=new Array,this.loadItemErrorDic={},this.errorDic={},this.itemListPriorityDic={},this.itemLoadDic={},this.promiseHash={},this.lazyLoadList=new Array,this.loadingCount=0,this.thread=4}return e.prototype.pushResItem=function(t){if(this.promiseHash[t.root+t.name])return this.promiseHash[t.root+t.name];this.lazyLoadList.push(t),this.itemListPriorityDic[Number.NEGATIVE_INFINITY]=this.lazyLoadList,this.updatelistPriority(this.lazyLoadList,Number.NEGATIVE_INFINITY);var e=new egret.EventDispatcher;this.dispatcherDic[t.root+t.name]=e;var r=new Promise(function(t,r){e.addEventListener("complete",function(e){t(e.data)},null),e.addEventListener("error",function(t){r(t.data)},null)});return this.promiseHash[t.root+t.name]=r,this.loadNextResource(),r},e.prototype.pushResGroup=function(t,e,r,i){if(this.promiseHash[e])return this.promiseHash[e];for(var n=t.length,o=0;n>o;o++){var a=t[o];a.groupNames||(a.groupNames=[]),a.groupNames.push(e)}this.groupTotalDic[e]=t.length,this.numLoadedDic[e]=0,this.updatelistPriority(t,r),this.reporterDic[e]=i;var s=new egret.EventDispatcher;this.dispatcherDic[e]=s;var c=new Promise(function(t,e){s.addEventListener("complete",t,null),s.addEventListener("error",function(t){e(t.data)},null)});return this.promiseHash[e]=c,this.loadNextResource(),c},e.prototype.updatelistPriority=function(t,e){void 0==this.itemListPriorityDic[e]&&(this.itemListPriorityDic[e]=[]);for(var r=0,i=t;r<i.length;r++){var n=i[r];if(1!=this.itemLoadDic[n.root+n.name]){var o=this.findPriorityInDic(n);if(void 0==o)this.itemListPriorityDic[e].push(n);else if(e>o){this.itemListPriorityDic[e].push(n);var a=this.itemListPriorityDic[o].indexOf(n);this.itemListPriorityDic[o].splice(a,1)}}}},e.prototype.findPriorityInDic=function(t){for(var e in this.itemListPriorityDic)if(this.itemListPriorityDic[e].indexOf(t)>-1)return parseInt(e)},e.prototype.loadNextResource=function(){for(;this.loadingCount<this.thread;){var t=this.loadSingleResource();if(!t)break}},e.prototype.loadSingleResource=function(){var e=this,r=this.getOneResourceInfoInGroup();return r?(this.itemLoadDic[r.root+r.name]=1,this.loadingCount++,this.loadResource(r).then(function(i){if(e.loadingCount--,delete e.itemLoadDic[r.root+r.name],t.host.save(r,i),e.promiseHash[r.root+r.name]){var n=e.deleteDispatcher(r.root+r.name);n.dispatchEventWith("complete",!1,i)}var o=r.groupNames;if(o){delete r.groupNames;for(var a=0,s=o;a<s.length;a++){var c=s[a];e.setGroupProgress(c,r)&&e.loadGroupEnd(c)}}e.loadNextResource()})["catch"](function(i){if(!i)throw r.name+" load fail";if(!i.__resource_manager_error__)throw i;delete e.itemLoadDic[r.root+r.name],e.loadingCount--,delete t.host.state[r.root+r.name];var n=e.retryTimesDic[r.name]||1;if(!(n>e.maxRetryTimes))return e.retryTimesDic[r.name]=n+1,e.failedList.push(r),void e.loadNextResource();if(delete e.retryTimesDic[r.name],e.promiseHash[r.root+r.name]){var o=e.deleteDispatcher(r.root+r.name);o.dispatchEventWith("error",!1,{r:r,error:i})}var a=r.groupNames;if(a){delete r.groupNames;for(var s=0,c=a;s<c.length;s++){var h=c[s];e.loadItemErrorDic[h]||(e.loadItemErrorDic[h]=[]),-1==e.loadItemErrorDic[h].indexOf(r)&&e.loadItemErrorDic[h].push(r),e.groupErrorDic[h]=!0,e.setGroupProgress(h,r)?e.loadGroupEnd(h,i):e.errorDic[h]=i}}e.loadNextResource()}),!0):!1},e.prototype.getOneResourceInfoInGroup=function(){if(this.failedList.length>0)return this.failedList.shift();var t=Number.NEGATIVE_INFINITY;for(var e in this.itemListPriorityDic)t=Math.max(t,e);var r=this.itemListPriorityDic[t];return r?0==r.length?(delete this.itemListPriorityDic[t],this.getOneResourceInfoInGroup()):r.shift():void 0},e.prototype.setGroupProgress=function(t,e){var r=this.reporterDic[t];this.numLoadedDic[t]++;var i=this.numLoadedDic[t],n=this.groupTotalDic[t];return r&&r.onProgress&&r.onProgress(i,n,e),i==n},e.prototype.loadGroupEnd=function(t,e){delete this.groupTotalDic[t],delete this.numLoadedDic[t],delete this.reporterDic[t];var r=this.deleteDispatcher(t);if(e){delete this.groupErrorDic[t];var i=this.loadItemErrorDic[t];delete this.loadItemErrorDic[t],r.dispatchEventWith("error",!1,{itemList:i,lastError:e})}else{var n=this.groupErrorDic[t];if(delete this.groupErrorDic[t],n){var i=this.loadItemErrorDic[t];delete this.loadItemErrorDic[t];var o=this.errorDic[t];delete this.errorDic[t],r.dispatchEventWith("error",!1,{itemList:i,error:o})}else r.dispatchEventWith("complete")}},e.prototype.deleteDispatcher=function(t){delete this.promiseHash[t];var e=this.dispatcherDic[t];return delete this.dispatcherDic[t],e},e.prototype.loadResource=function(e,r){if(!r){if(1==t.FEATURE_FLAG.FIX_DUPLICATE_LOAD){var i=t.host.state[e.root+e.name];if(2==i)return Promise.resolve(t.host.get(e));if(1==i)return e.promise}r=t.processor.isSupport(e)}if(!r)throw new t.ResourceManagerError(2001,e.name,e.type);t.host.state[e.root+e.name]=1;var n=r.onLoadStart(t.host,e);return e.promise=n,n},e.prototype.unloadResource=function(e){var r=t.host.get(e);if(!r)return console.warn(":",e.name),!1;var i=t.processor.isSupport(e);return i?(i.onRemoveStart(t.host,e),t.host.remove(e),1==e.extra&&t.config.removeResourceData(e),!0):!0},e}();t.ResourceLoader=e,__reflect(e.prototype,"RES.ResourceLoader")}(RES||(RES={}));var RES;!function(t){t.checkNull=function(t,e,r){var i=r.value;r.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t[0]?i.apply(this,t):(console.warn(""+e+"null"),null)}},t.FEATURE_FLAG={FIX_DUPLICATE_LOAD:1};var e;!function(t){function e(t){r=t}var r="warning";t.setUpgradeGuideLevel=e}(e=t.upgrade||(t.upgrade={}))}(RES||(RES={}));var RES;!function(t){function e(e){var r=t.config.config.fileSystem.getFile(e);return r||(e=t.resourceNameSelector(e),r=t.config.config.fileSystem.getFile(e)),r}function r(t,e){var r;r=t.indexOf(".json")>=0?"legacyResourceConfig":"resourceConfig",i={type:r,root:e,url:t,name:t}}t.resourceNameSelector=function(t){return t},t.getResourceInfo=e;var i;t.setConfigURL=r;var n=function(){function r(){}return r.prototype.init=function(){return this.config||(this.config={alias:{},groups:{},resourceRoot:i.root,mergeSelector:null,fileSystem:null,loadGroup:[]}),t.queue.pushResItem(i)["catch"](function(e){return t.isCompatible||e.__resource_manager_error__||(e.error?console.error(e.error.stack):console.error(e.stack),e=new t.ResourceManagerError(1002)),t.host.remove(i),Promise.reject(e)})},r.prototype.getGroupByName=function(e){var r=this.config.groups[e],i=[];if(!r)return i;for(var n=0,o=r;n<o.length;n++){var a=o[n],s=void 0;if(s=t.config.getResourceWithSubkey(a),null!=s){var c=s.r,h=s.key;if(null==c)throw new t.ResourceManagerError(2005,h);-1==i.indexOf(c)&&i.push(c)}}return i},r.prototype.__temp__get__type__via__url=function(e){var r=this.config.alias[e];if(r||(r=e),t.typeSelector){var i=t.typeSelector(r);if(!i)throw new t.ResourceManagerError(2004,r);return i}return console.warn("RES.mapConfig  typeSelector"),"unknown"},r.prototype.getResourceWithSubkey=function(t){t=this.getKeyByAlias(t);var e=t.indexOf("#"),r="";e>=0&&(r=t.substr(e+1),t=t.substr(0,e));var i=this.getResource(t);return i?{r:i,key:t,subkey:r}:null},r.prototype.getKeyByAlias=function(t){return this.config.alias[t]?this.config.alias[t]:t},r.prototype.getResource=function(t){var r=this.config.alias[t];r||(r=t);var i=e(r);return i?i:null},r.prototype.createGroup=function(t,e,r){if(void 0===r&&(r=!1),!r&&this.config.groups[t]||!e||0==e.length)return!1;for(var i=[],n=0,o=e;n<o.length;n++){var a=o[n];if(this.config.groups[a]){var s=this.config.groups[a];i=i.concat(s)}else i.push(a)}return this.config.groups[t]=i,!0},r.prototype.addSubkey=function(t,e){this.addAlias(t,e+"#"+t)},r.prototype.addAlias=function(t,e){this.config.alias[e]&&(e=this.config.alias[e]),this.config.alias[t]=e},r.prototype.addResourceData=function(e){t.hasRes(e.name)||(e.type||(e.type=this.__temp__get__type__via__url(e.url)),t.config.config.fileSystem.addFile(e))},r.prototype.removeResourceData=function(e){t.hasRes(e.name)&&(t.config.config.fileSystem.removeFile(e.url),this.config.alias[e.name]&&delete this.config.alias[e.name])},r}();t.ResourceConfig=n,__reflect(n.prototype,"RES.ResourceConfig")}(RES||(RES={}));var RES;!function(t){function e(e){return t.path.basename(e).split(".").join("_")}function r(e){var r,i=e.substr(e.lastIndexOf(".")+1);switch(i){case t.ResourceItem.TYPE_XML:case t.ResourceItem.TYPE_JSON:case t.ResourceItem.TYPE_SHEET:r=i;break;case"png":case"jpg":case"gif":case"jpeg":case"bmp":r=t.ResourceItem.TYPE_IMAGE;break;case"fnt":r=t.ResourceItem.TYPE_FONT;break;case"txt":r=t.ResourceItem.TYPE_TEXT;break;case"mp3":case"ogg":case"mpeg":case"wav":case"m4a":case"mp4":case"aiff":case"wma":case"mid":r=t.ResourceItem.TYPE_SOUND;break;case"mergeJson":case"zip":case"pvr":r=i;break;default:r=t.ResourceItem.TYPE_BIN}return r}function i(e,r){throw new t.ResourceManagerError(2002)}function n(e){t.isCompatible=e}function o(e,r){if(r.indexOf("://")>=0){var i=r.split("://");r=i[0]+"://"+t.path.normalize(i[1]+"/"),e=e.replace(r,"")}else r=t.path.normalize(r+"/"),e=e.replace(r,"");return t.setConfigURL(e,r),w||(w=new E),a(w.loadConfig())}function a(e){return t.isCompatible?void e["catch"](function(t){}).then():e}function s(t,e,r){return void 0===e&&(e=0),a(w.loadGroup(t,e,r))}function c(t){return w.isGroupLoaded(t)}function h(e){return w.getGroupByName(e).map(function(e){return t.ResourceItem.convertToResItem(e)})}function u(t,e,r){return void 0===r&&(r=!1),w.createGroup(t,e,r)}function l(t){return w.hasRes(t)}function p(t){return w.getRes(t)}function d(t,e,r){return a(w.getResAsync.apply(w,arguments))}function f(t,e,r,i){if(void 0===i&&(i=""),!w){var n=egret.sys.tr(3200);return egret.warn(n),Promise.reject(n)}return a(w.getResByUrl(t,e,r,i))}function g(t,e){return w.destroyRes(t,e)}function v(t){w||(w=new E),w.setMaxLoadingThread(t)}function y(t){w.setMaxRetryTimes(t)}function m(t,e,r,i,n){void 0===i&&(i=!1),void 0===n&&(n=0),w||(w=new E),w.addEventListener(t,e,r,i,n)}function $(t,e,r,i){void 0===i&&(i=!1),w.removeEventListener(t,e,r,i)}function b(t){w.addResourceData(t)}function _(){return w||(w=new E),w.vcs}function x(t){w||(w=new E),w.registerVersionController(t)}function T(t){return w.vcs?w.vcs.getVirtualUrl(t):t}t.nameSelector=e,t.typeSelector=r,t.registerAnalyzer=i,t.setIsCompatible=n,t.isCompatible=!1,t.loadConfig=o,t.loadGroup=s,t.isGroupLoaded=c,t.getGroupByName=h,t.createGroup=u,t.hasRes=l,t.getRes=p,t.getResAsync=d,t.getResByUrl=f,t.destroyRes=g,t.setMaxLoadingThread=v,t.setMaxRetryTimes=y,t.addEventListener=m,t.removeEventListener=$,t.$addResourceData=b,t.getVersionController=_,t.registerVersionController=x,t.getVirtualUrl=T;var E=function(e){function r(){var r=e.call(this)||this;return r.isVcsInit=!1,r.normalLoadConfig=function(){return t.config.init().then(function(e){t.ResourceEvent.dispatchResourceEvent(r,t.ResourceEvent.CONFIG_COMPLETE)},function(e){return t.ResourceEvent.dispatchResourceEvent(r,t.ResourceEvent.CONFIG_LOAD_ERROR),Promise.reject(e)})},t.VersionController&&(r.vcs=new t.VersionController),r}return __extends(r,e),r.prototype.registerVersionController=function(t){this.vcs=t,this.isVcsInit=!1},r.prototype.loadConfig=function(){var t=this;return!this.isVcsInit&&this.vcs?(this.isVcsInit=!0,this.vcs.init().then(function(){return t.normalLoadConfig()})):this.normalLoadConfig()},r.prototype.isGroupLoaded=function(e){var r=t.config.getGroupByName(e);return r.every(function(e){return null!=t.host.get(e)})},r.prototype.getGroupByName=function(e){return t.config.getGroupByName(e)},r.prototype.loadGroup=function(e,r,i){var n=this;void 0===r&&(r=0);var o={onProgress:function(r,o,a){i&&i.onProgress&&i.onProgress(r,o,a),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_PROGRESS,e,a,r,o)}};return this._loadGroup(e,r,o).then(function(r){-1==t.config.config.loadGroup.indexOf(e)&&t.config.config.loadGroup.push(e),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_COMPLETE,e)},function(r){if(-1==t.config.config.loadGroup.indexOf(e)&&t.config.config.loadGroup.push(e),r.itemList)for(var i=r.itemList,o=i.length,a=0;o>a;a++){var s=i[a];delete s.promise,t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.ITEM_LOAD_ERROR,e,s)}return t.isCompatible&&console.warn(r.error.message),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_LOAD_ERROR,e),Promise.reject(r.error)})},r.prototype._loadGroup=function(e,r,i){void 0===r&&(r=0);var n=t.config.getGroupByName(e);return 0==n.length?new Promise(function(r,i){i({error:new t.ResourceManagerError(2005,e)})}):t.queue.pushResGroup(n,e,r,i)},r.prototype.createGroup=function(e,r,i){return void 0===i&&(i=!1),t.config.createGroup(e,r,i)},r.prototype.hasRes=function(e){return null!=t.config.getResourceWithSubkey(e)},r.prototype.getRes=function(e){var r=t.config.getResourceWithSubkey(e);if(r){var i=r.r,n=r.key,o=r.subkey,a=t.processor.isSupport(i);return a&&a.getData&&o?a.getData(t.host,i,n,o):t.host.get(i)}return null},r.prototype.getResAsync=function(e,r,i){var n=this,o=e,a=t.config.getResourceWithSubkey(e);if(null==a)return r&&r.call(i,null,o),Promise.reject(new t.ResourceManagerError(2006,e));var s=this.getRes(e);if(s)return r&&egret.callLater(function(){r.call(i,s,o)},this),Promise.resolve(s);var c=a.r,h=a.subkey;return t.queue.pushResItem(c).then(function(n){t.host.save(c,n);var a=t.processor.isSupport(c);return a&&a.getData&&h&&(n=a.getData(t.host,c,e,h)),r&&r.call(i,n,o),n},function(e){return t.host.remove(c),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.ITEM_LOAD_ERROR,"",c),r?(r.call(i,null,o),Promise.reject(null)):Promise.reject(e)})},r.prototype.getResByUrl=function(e,r,i,n){var o=this;void 0===n&&(n="");var a=t.config.getResource(e);if(!a&&(n||(n=t.config.__temp__get__type__via__url(e)),a={name:e,url:e,type:n,root:"",extra:1},t.config.addResourceData(a),a=t.config.getResource(e),!a))throw"never";return t.queue.pushResItem(a).then(function(e){return t.host.save(a,e),r&&a&&r.call(i,e,a.url),e},function(n){return t.host.remove(a),t.ResourceEvent.dispatchResourceEvent(o,t.ResourceEvent.ITEM_LOAD_ERROR,"",a),r?(r.call(i,null,e),Promise.reject(null)):Promise.reject(n)})},r.prototype.destroyRes=function(e,r){void 0===r&&(r=!0);var i=t.config.getGroupByName(e);if(i&&i.length>0){var n=t.config.config.loadGroup.indexOf(e);if(-1==n)return!1;if(r||1==t.config.config.loadGroup.length&&t.config.config.loadGroup[0]==e){for(var o=0,a=i;o<a.length;o++){var s=a[o];t.queue.unloadResource(s)}t.config.config.loadGroup.splice(n,1)}else{for(var c={},h=0,u=t.config.config.loadGroup;h<u.length;h++){var l=u[h];for(var p in t.config.config.groups[l]){var d=t.config.config.groups[l][p];c[d]?c[d]++:c[d]=1}}for(var f=0,g=i;f<g.length;f++){var s=g[f];c[s.name]&&1==c[s.name]&&t.queue.unloadResource(s)}t.config.config.loadGroup.splice(n,1)}return!0}var s=t.config.getResource(e);return s?t.queue.unloadResource(s):(console.warn(""+e+""),!1)},r.prototype.setMaxLoadingThread=function(e){1>e&&(e=1),t.queue.thread=e},r.prototype.setMaxRetryTimes=function(e){e=Math.max(e,0),t.queue.maxRetryTimes=e},r.prototype.addResourceData=function(e){e.root="",t.config.addResourceData(e)},__decorate([t.checkNull],r.prototype,"hasRes",null),__decorate([t.checkNull],r.prototype,"getRes",null),__decorate([t.checkNull],r.prototype,"getResAsync",null),__decorate([t.checkNull],r.prototype,"getResByUrl",null),r}(egret.EventDispatcher);t.Resource=E,__reflect(E.prototype,"RES.Resource");var w}(RES||(RES={}));var RES;!function(t){var e;!function(t){function e(t){var e=t.split("/");return e.filter(function(t,r){return!!t||r==e.length-1}).join("/")}function r(t){return t.substr(t.lastIndexOf("/")+1)}function i(t){return t.substr(0,t.lastIndexOf("/"))}t.normalize=e,t.basename=r,t.dirname=i}(e=t.path||(t.path={}))}(RES||(RES={}));var RES;!function(t){function e(){t.config.config.fileSystem.profile(),console.log(r);var e=0;for(var i in r){var n=r[i];n instanceof egret.Texture&&(e+=n.$bitmapWidth*n.$bitmapHeight*4)}console.log("gpu size : "+(e/1024).toFixed(3)+"kb")}var r={};t.profile=e,t.host={state:{},get resourceConfig(){return t.config},load:function(e,r){var i="string"==typeof r?t.processor._map[r]:r;return t.queue.loadResource(e,i)},unload:function(e){return t.queue.unloadResource(e)},save:function(e,i){t.host.state[e.root+e.name]=2,delete e.promise,r[e.root+e.name]=i},get:function(t){return r[t.root+t.name]},remove:function(e){delete t.host.state[e.root+e.name],delete r[e.root+e.name]}},t.config=new t.ResourceConfig,t.queue=new t.ResourceLoader;var i=function(t){function e(r,i,n){var o=t.call(this)||this;return o.__resource_manager_error__=!0,o.name=r.toString(),o.message=e.errorMessage[r].replace("{0}",i).replace("{1}",n),o}return __extends(e,t),e.errorMessage={1001:":{0}",1002:"ResourceManager ",2001:"{0},:'{1}' Processor  https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2002:"Analyzer API  ResourceManager  Processor  https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2003:"{0},:{1}",2004:":{0}",2005:'RES:"{0}"',2006:":{0}"},e}(Error);t.ResourceManagerError=i,__reflect(i.prototype,"RES.ResourceManagerError")}(RES||(RES={}));var RES;!function(t){var e;!function(e){function r(t){return e._map[t.type]}function i(t,r){e._map[t]=r}function n(e,r){var i=this;return new Promise(function(n,o){var a=function(){var t=e.data?e.data:e.response;n(t)},s=function(){var e=new t.ResourceManagerError(1001,r.url);o(e)};e.addEventListener(egret.Event.COMPLETE,a,i),e.addEventListener(egret.IOErrorEvent.IO_ERROR,s,i)})}function o(t,e){if(-1!=e.indexOf("://"))return e;t=t.split("\\").join("/");var r=t.match(/#.*|\?.*/),i="";r&&(i=r[0]);var n=t.lastIndexOf("/");return t=-1!=n?t.substring(0,n+1)+e:e,t+i}function a(t){return{name:t.name+"_alpha",url:t.etc1_alpha_url,type:"ktx",root:t.root}}e.isSupport=r,e.map=i,e.getRelativePath=o,e.ImageProcessor={onLoadStart:function(e,r){var i=new egret.ImageLoader;return i.load(t.getVirtualUrl(r.root+r.url)),n(i,r).then(function(t){var i=new egret.Texture;i._setBitmapData(t);var n=e.resourceConfig.getResource(r.name);if(n&&n.scale9grid){var o=n.scale9grid.split(",");i.scale9Grid=new egret.Rectangle(parseInt(o[0]),parseInt(o[1]),parseInt(o[2]),parseInt(o[3]))}return i})},onRemoveStart:function(t,e){var r=t.get(e);r.dispose()}},e.KTXTextureProcessor={onLoadStart:function(t,e){return t.load(e,"bin").then(function(r){if(!r)return console.error("ktx:"+e.root+e.url+" is null"),null;var i=new egret.KTXContainer(r,1);if(i.isInvalid)return console.error("ktx:"+e.root+e.url+" is invalid"),null;var n=new egret.BitmapData(r);n.debugCompressedTextureURL=e.root+e.url,n.format="ktx",i.uploadLevels(n,!1);var o=new egret.Texture;o._setBitmapData(n);var a=t.resourceConfig.getResource(e.name);if(a&&a.scale9grid){var s=a.scale9grid.split(",");o.scale9Grid=new egret.Rectangle(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]),parseInt(s[3]))}return t.save(e,o),o},function(r){throw t.remove(e),r})},onRemoveStart:function(t,e){var r=t.get(e);r&&r.dispose()}},e.makeEtc1SeperatedAlphaResourceInfo=a,e.ETC1KTXProcessor={onLoadStart:function(t,e){return t.load(e,"ktx").then(function(r){if(!r)return null;if(e.etc1_alpha_url){var i=a(e);return t.load(i,"ktx").then(function(e){return r&&r.$bitmapData&&e.$bitmapData?(r.$bitmapData.etcAlphaMask=e.$bitmapData,t.save(i,e)):t.remove(i),r},function(e){throw t.remove(i),e})}return r},function(r){throw t.remove(e),r})},onRemoveStart:function(t,e){var r=t.get(e);
if(r&&r.dispose(),e.etc1_alpha_url){var i=a(e),n=t.get(i);n&&n.dispose(),t.unload(i)}}},e.BinaryProcessor={onLoadStart:function(e,r){var i=new egret.HttpRequest;return i.responseType=egret.HttpResponseType.ARRAY_BUFFER,i.open(t.getVirtualUrl(r.root+r.url),"get"),i.send(),n(i,r)},onRemoveStart:function(t,e){}},e.TextProcessor={onLoadStart:function(e,r){var i=new egret.HttpRequest;return i.responseType=egret.HttpResponseType.TEXT,i.open(t.getVirtualUrl(r.root+r.url),"get"),i.send(),n(i,r)},onRemoveStart:function(t,e){return!0}},e.JsonProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(t){var e=JSON.parse(t);return e})},onRemoveStart:function(t,e){}},e.XMLProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(t){var e=egret.XML.parse(t);return e})},onRemoveStart:function(t,e){return!0}},e.CommonJSProcessor={onLoadStart:function(e,r){return e.load(r,"text").then(function(e){var i=new Function("require","exports",e),n=function(){},o={};try{i(n,o)}catch(a){throw new t.ResourceManagerError(2003,r.name,a.message)}return o})},onRemoveStart:function(t,e){}},e.SheetProcessor={onLoadStart:function(e,r){return e.load(r,"json").then(function(i){var n=e.resourceConfig.getResource(t.nameSelector(i.file));if(!n){var a=o(r.url,i.file);n={name:a,url:a,type:"image",root:r.root}}return e.load(n).then(function(t){if(!t)return null;var r=i.frames,o=new egret.SpriteSheet(t);o.$resourceInfo=n;for(var a in r){var s=r[a],c=o.createTexture(a,s.x,s.y,s.w,s.h,s.offX,s.offY,s.sourceW,s.sourceH);if(s.scale9grid){var h=s.scale9grid,u=h.split(",");c.scale9Grid=new egret.Rectangle(parseInt(u[0]),parseInt(u[1]),parseInt(u[2]),parseInt(u[3]))}}return e.save(n,t),o},function(t){throw e.remove(n),t})})},getData:function(t,e,r,i){var n=t.get(e);return n?n.getTexture(i):null},onRemoveStart:function(t,e){var r=t.get(e),i=r.$resourceInfo;r.dispose(),t.unload(i)}};var s=function(t,e){var r="",i=e.split("\n"),n=i[2],o=n.indexOf('file="');-1!=o&&(n=n.substring(o+6),o=n.indexOf('"'),r=n.substring(0,o)),t=t.split("\\").join("/");var o=t.lastIndexOf("/");return t=-1!=o?t.substring(0,o+1)+r:r};e.FontProcessor={onLoadStart:function(e,r){return e.load(r,"text").then(function(i){var n;try{n=JSON.parse(i)}catch(a){n=i}var c;c="string"==typeof n?s(r.url,n):o(r.url,n.file);var h=e.resourceConfig.getResource(t.nameSelector(c));return h||(h={name:c,url:c,type:"image",root:r.root}),e.load(h).then(function(t){var r=new egret.BitmapFont(t,n);return r.$resourceInfo=h,e.save(h,t),r},function(t){throw e.remove(h),t})})},onRemoveStart:function(t,e){var r=t.get(e),i=r.$resourceInfo;t.unload(i)}},e.SoundProcessor={onLoadStart:function(e,r){var i=new egret.Sound;return i.load(t.getVirtualUrl(r.root+r.url)),n(i,r).then(function(){return i})},onRemoveStart:function(t,e){var r=t.get(e);r.close()}},e.MovieClipProcessor={onLoadStart:function(e,r){var i,n;return e.load(r,"json").then(function(o){i=o;var a=r.name,s=a.substring(0,a.lastIndexOf("."))+".png";if(n=e.resourceConfig.getResource(s),!n)throw new t.ResourceManagerError(1001,s);return e.load(n)}).then(function(t){e.save(n,t);var r=t,o=new egret.MovieClipDataFactory(i,r);return o})},onRemoveStart:function(t,e){var r=t.get(e);r.clearCache(),r.$spriteSheet.dispose();var i=e.name,n=i.substring(0,i.lastIndexOf("."))+".png",o=t.resourceConfig.getResource(n);o&&t.unload(o)}},e.MergeJSONProcessor={onLoadStart:function(e,r){return e.load(r,"json").then(function(e){for(var i in e)t.config.addSubkey(i,r.name);return e})},getData:function(t,e,r,i){var n=t.get(e);return n?n[i]:(console.error("missing resource :"+e.name),null)},onRemoveStart:function(t,e){}},e.LegacyResourceConfigProcessor={onLoadStart:function(e,r){return e.load(r,"json").then(function(i){var n=t.config.config,o=r.root,a=n.fileSystem;a||(a={fsData:{},getFile:function(t){return p[t]},addFile:function(t){t.type||(t.type=""),void 0==o&&(t.root=""),p[t.name]=t},profile:function(){console.log(p)},removeFile:function(t){delete p[t]}},n.fileSystem=a);for(var s=n.groups,c=0,h=i.groups;c<h.length;c++){var u=h[c];""==u.keys?s[u.name]=[]:s[u.name]=u.keys.split(",")}for(var l=n.alias,p=a.fsData,d=function(t){p[t.name]=t,p[t.name].root=o,t.subkeys&&t.subkeys.split(",").forEach(function(e){l[e]=t.name+"#"+e,l[t.name+"."+e]=t.name+"#"+e})},f=0,g=i.resources;f<g.length;f++){var v=g[f];d(v)}return e.save(r,i),i})},onRemoveStart:function(){}},e._map={image:e.ImageProcessor,json:e.JsonProcessor,text:e.TextProcessor,xml:e.XMLProcessor,sheet:e.SheetProcessor,font:e.FontProcessor,bin:e.BinaryProcessor,commonjs:e.CommonJSProcessor,sound:e.SoundProcessor,movieclip:e.MovieClipProcessor,mergeJson:e.MergeJSONProcessor,legacyResourceConfig:e.LegacyResourceConfigProcessor,ktx:e.KTXTextureProcessor,"etc1.ktx":e.ETC1KTXProcessor,"pvrtc.ktx":e.KTXTextureProcessor}}(e=t.processor||(t.processor={}))}(RES||(RES={}));var RES;!function(t){var e=function(e){function r(t,r,i){void 0===r&&(r=!1),void 0===i&&(i=!1);var n=e.call(this,t,r,i)||this;return n.itemsLoaded=0,n.itemsTotal=0,n.groupName="",n}return __extends(r,e),r.dispatchResourceEvent=function(e,i,n,o,a,s){void 0===n&&(n=""),void 0===o&&(o=void 0),void 0===a&&(a=0),void 0===s&&(s=0);var c=egret.Event.create(r,i);c.groupName=n,o&&(c.resItem=t.ResourceItem.convertToResItem(o)),c.itemsLoaded=a,c.itemsTotal=s;var h=e.dispatchEvent(c);return egret.Event.release(c),h},r.ITEM_LOAD_ERROR="itemLoadError",r.CONFIG_COMPLETE="configComplete",r.CONFIG_LOAD_ERROR="configLoadError",r.GROUP_PROGRESS="groupProgress",r.GROUP_COMPLETE="groupComplete",r.GROUP_LOAD_ERROR="groupLoadError",r}(egret.Event);t.ResourceEvent=e,__reflect(e.prototype,"RES.ResourceEvent")}(RES||(RES={}));var RES;!function(t){var e;!function(e){function r(e){var r=e.name;if(t.config.config)for(var i in t.config.config.alias)t.config.config.alias[i]==e.url&&(r=i);else r=e.url;var n={name:r,url:e.url,type:e.type,data:e,root:e.root};return n}e.TYPE_XML="xml",e.TYPE_IMAGE="image",e.TYPE_BIN="bin",e.TYPE_TEXT="text",e.TYPE_JSON="json",e.TYPE_SHEET="sheet",e.TYPE_FONT="font",e.TYPE_SOUND="sound",e.convertToResItem=r}(e=t.ResourceItem||(t.ResourceItem={}))}(RES||(RES={}));var RES;!function(t){var e=function(){function e(t){this.data=t}return e.prototype.profile=function(){console.log(this.data)},e.prototype.addFile=function(e,r){r||(r=""),e=t.path.normalize(e);var i=t.path.basename(e),n=t.path.dirname(e);this.exists(n)||this.mkdir(n);var o=this.resolve(n);o[i]={url:e,type:r}},e.prototype.getFile=function(t){var e=this.resolve(t);return e&&(e.name=t),e},e.prototype.resolve=function(e){if(""==e)return this.data;e=t.path.normalize(e);for(var r=e.split("/"),i=this.data,n=0,o=r;n<o.length;n++){var a=o[n];if(!i)return i;i=i[a]}return i},e.prototype.mkdir=function(e){e=t.path.normalize(e);for(var r=e.split("/"),i=this.data,n=0,o=r;n<o.length;n++){var a=o[n];i[a]||(i[a]={}),i=i[a]}},e.prototype.exists=function(e){if(""==e)return!0;e=t.path.normalize(e);for(var r=e.split("/"),i=this.data,n=0,o=r;n<o.length;n++){var a=o[n];if(!i[a])return!1;i=i[a]}return!0},e}();t.NewFileSystem=e,__reflect(e.prototype,"RES.NewFileSystem")}(RES||(RES={}));var RES;!function(t){var e=function(){function t(){}return t.prototype.init=function(){return this.versionInfo=this.getLocalData("all.manifest"),Promise.resolve()},t.prototype.getVirtualUrl=function(t){return t},t.prototype.getLocalData=function(t){if(egret_native.readUpdateFileSync&&egret_native.readResourceFileSync){var e=egret_native.readUpdateFileSync(t);if(null!=e)return JSON.parse(e);if(e=egret_native.readResourceFileSync(t),null!=e)return JSON.parse(e)}return null},t}();t.NativeVersionController=e,__reflect(e.prototype,"RES.NativeVersionController",["RES.IVersionController"]),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&(t.VersionController=e)}(RES||(RES={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r},egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowIn=function(t){return function(e){return Math.pow(e,t)}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.getPowInOut=function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}},e.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},e.sineOut=function(t){return Math.sin(t*Math.PI/2)},e.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},e.getBackIn=function(t){return function(e){return e*e*((t+1)*e-t)}},e.getBackOut=function(t){return function(e){return--e*e*((t+1)*e+t)+1}},e.getBackInOut=function(t){return t*=1.525,function(e){return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}},e.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},e.circOut=function(t){return Math.sqrt(1- --t*t)},e.circInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},e.bounceIn=function(t){return 1-e.bounceOut(1-t)},e.bounceOut=function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},e.bounceInOut=function(t){return.5>t?.5*e.bounceIn(2*t):.5*e.bounceOut(2*t-1)+.5},e.getElasticIn=function(t,e){var r=2*Math.PI;return function(i){if(0==i||1==i)return i;var n=e/r*Math.asin(1/t);return-(t*Math.pow(2,10*(i-=1))*Math.sin((i-n)*r/e))}},e.getElasticOut=function(t,e){var r=2*Math.PI;return function(i){if(0==i||1==i)return i;var n=e/r*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-n)*r/e)+1}},e.getElasticInOut=function(t,e){var r=2*Math.PI;return function(i){var n=e/r*Math.asin(1/t);return(i*=2)<1?-.5*(t*Math.pow(2,10*(i-=1))*Math.sin((i-n)*r/e)):t*Math.pow(2,-10*(i-=1))*Math.sin((i-n)*r/e)*.5+1}},e.quadIn=e.getPowIn(2),e.quadOut=e.getPowOut(2),e.quadInOut=e.getPowInOut(2),e.cubicIn=e.getPowIn(3),e.cubicOut=e.getPowOut(3),e.cubicInOut=e.getPowInOut(3),e.quartIn=e.getPowIn(4),e.quartOut=e.getPowOut(4),e.quartInOut=e.getPowInOut(4),e.quintIn=e.getPowIn(5),e.quintOut=e.getPowOut(5),e.quintInOut=e.getPowInOut(5),e.backIn=e.getBackIn(1.7),e.backOut=e.getBackOut(1.7),e.backInOut=e.getBackInOut(1.7),e.elasticIn=e.getElasticIn(1,.3),e.elasticOut=e.getElasticOut(1,.3),e.elasticInOut=e.getElasticInOut(1,.3*1.5),e}();t.Ease=e,__reflect(e.prototype,"egret.Ease")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){var n=e.call(this)||this;return n._target=null,n._useTicks=!1,n.ignoreGlobalPause=!1,n.loop=!1,n.pluginData=null,n._steps=null,n.paused=!1,n.duration=0,n._prevPos=-1,n.position=null,n._prevPosition=0,n._stepPosition=0,n.passive=!1,n.initialize(t,r,i),n}return __extends(r,e),r.get=function(t,e,i,n){return void 0===i&&(i=null),void 0===n&&(n=!1),n&&r.removeTweens(t),new r(t,e,i)},r.removeTweens=function(t){if(t.tween_count){for(var e=r._tweens,i=e.length-1;i>=0;i--)e[i]._target==t&&(e[i].paused=!0,e.splice(i,1));t.tween_count=0}},r.pauseTweens=function(e){if(e.tween_count)for(var r=t.Tween._tweens,i=r.length-1;i>=0;i--)r[i]._target==e&&(r[i].paused=!0)},r.resumeTweens=function(e){if(e.tween_count)for(var r=t.Tween._tweens,i=r.length-1;i>=0;i--)r[i]._target==e&&(r[i].paused=!1)},r.tick=function(t,e){void 0===e&&(e=!1);var i=t-r._lastTime;r._lastTime=t;for(var n=r._tweens.concat(),o=n.length-1;o>=0;o--){var a=n[o];e&&!a.ignoreGlobalPause||a.paused||a.$tick(a._useTicks?1:i)}return!1},r._register=function(e,i){var n=e._target,o=r._tweens;if(i)n&&(n.tween_count=n.tween_count>0?n.tween_count+1:1),o.push(e),r._inited||(r._lastTime=t.getTimer(),t.ticker.$startTick(r.tick,null),r._inited=!0);else{n&&n.tween_count--;for(var a=o.length;a--;)if(o[a]==e)return void o.splice(a,1)}},r.removeAllTweens=function(){for(var t=r._tweens,e=0,i=t.length;i>e;e++){var n=t[e];n.paused=!0,n._target.tween_count=0}t.length=0},r.prototype.initialize=function(t,e,i){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&r.removeTweens(t)),this.pluginData=i||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],e&&e.paused?this.paused=!0:r._register(this,!0),e&&null!=e.position&&this.setPosition(e.position,r.NONE)},r.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var r=t,i=!1;if(r>=this.duration)if(this.loop){var n=r%this.duration;r=r>0&&0===n?this.duration:n}else r=this.duration,i=!0;if(r==this._prevPos)return i;i&&this.setPaused(!0);var o=this._prevPos;if(this.position=this._prevPos=r,this._prevPosition=t,this._target&&this._steps.length>0){for(var a=this._steps.length,s=-1,c=0;a>c&&!("step"==this._steps[c].type&&(s=c,this._steps[c].t<=r&&this._steps[c].t+this._steps[c].d>=r));c++);for(var c=0;a>c;c++)if("action"==this._steps[c].type)0!=e&&(this._useTicks?this._runAction(this._steps[c],r,r):1==e&&o>r?(o!=this.duration&&this._runAction(this._steps[c],o,this.duration),this._runAction(this._steps[c],0,r,!0)):this._runAction(this._steps[c],o,r));else if("step"==this._steps[c].type&&s==c){var h=this._steps[s];this._updateTargetProps(h,Math.min((this._stepPosition=r-h.t)/h.d,1))}}return this.dispatchEventWith("change"),i},r.prototype._runAction=function(t,e,r,i){void 0===i&&(i=!1);var n=e,o=r;e>r&&(n=r,o=e);var a=t.t;(a==o||a>n&&o>a||i&&a==e)&&t.f.apply(t.o,t.p)},r.prototype._updateTargetProps=function(t,e){var i,n,o,a,s,c;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),i=t.p0,n=t.p1}else this.passive=!1,i=n=this._curQueueProps;for(var h in this._initQueueProps){null==(a=i[h])&&(i[h]=a=this._initQueueProps[h]),null==(s=n[h])&&(n[h]=s=a),o=a==s||0==e||1==e||"number"!=typeof a?1==e?s:a:a+(s-a)*e;var u=!1;if(c=r._plugins[h])for(var l=0,p=c.length;p>l;l++){var d=c[l].tween(this,h,o,i,n,e,!!t&&i==n,!t);d==r.IGNORE?u=!0:o=d}u||(this._target[h]=o)}},r.prototype.setPaused=function(t){return this.paused==t?this:(this.paused=t,r._register(this,!t),this)},r.prototype._cloneProps=function(t){var e={};for(var r in t)e[r]=t[r];return e},r.prototype._addStep=function(t){return t.d>0&&(t.type="step",this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},r.prototype._appendQueueProps=function(t){var e,i,n,o,a;for(var s in t)if(void 0===this._initQueueProps[s]){if(i=this._target[s],e=r._plugins[s])for(n=0,o=e.length;o>n;n++)i=e[n].init(this,s,i);this._initQueueProps[s]=this._curQueueProps[s]=void 0===i?null:i}else i=this._curQueueProps[s];for(var s in t){if(i=this._curQueueProps[s],e=r._plugins[s])for(a=a||{},n=0,o=e.length;o>n;n++)e[n].step&&e[n].step(this,s,i,t[s],a);this._curQueueProps[s]=t[s]}return a&&this._appendQueueProps(a),this._curQueueProps},r.prototype._addAction=function(t){return t.t=this.duration,t.type="action",this._steps.push(t),this},r.prototype._set=function(t,e){for(var r in t)e[r]=t[r]},r.prototype.wait=function(t,e){if(null==t||0>=t)return this;var r=this._cloneProps(this._curQueueProps);return this._addStep({d:t,p0:r,p1:r,v:e})},r.prototype.to=function(t,e,r){return void 0===r&&(r=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:r,p1:this._cloneProps(this._appendQueueProps(t))}),this.set(t)},r.prototype.call=function(t,e,r){return void 0===e&&(e=void 0),void 0===r&&(r=void 0),this._addAction({f:t,p:r?r:[],o:e?e:this._target})},r.prototype.set=function(t,e){return void 0===e&&(e=null),this._appendQueueProps(t),this._addAction({f:this._set,o:this,p:[t,e?e:this._target]})},r.prototype.play=function(t){return t||(t=this),this.call(t.setPaused,t,[!1])},r.prototype.pause=function(t){return t||(t=this),this.call(t.setPaused,t,[!0])},r.prototype.$tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},r.NONE=0,r.LOOP=1,r.REVERSE=2,r._tweens=[],r.IGNORE={},r._plugins={},r._inited=!1,r._lastTime=0,r}(t.EventDispatcher);t.Tween=e,__reflect(e.prototype,"egret.Tween")}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(e){if("function"==typeof e)return e;var r=t.Ease[e];return"function"==typeof r?r:null}function i(t,e,r,i){var n=t.prototype;n.__meta__=n.__meta__||{},n.__meta__[e]=r,i&&(n.__defaultProperty__=e)}var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="",e}return __extends(e,t),e}(t.EventDispatcher);e.BasePath=n,__reflect(n.prototype,"egret.tween.BasePath");var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.props=void 0,e.duration=500,e.ease=void 0,e}return __extends(e,t),e}(n);e.To=o,__reflect(o.prototype,"egret.tween.To");var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.duration=500,e.passive=void 0,e}return __extends(e,t),e}(n);e.Wait=a,__reflect(a.prototype,"egret.tween.Wait");var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.props=void 0,e}return __extends(e,t),e}(n);e.Set=s,__reflect(s.prototype,"egret.tween.Set");var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delta=0,e}return __extends(e,t),e}(n);e.Tick=c,__reflect(c.prototype,"egret.tween.Tick");var h=function(e){function i(){var t=e.call(this)||this;return t.isStop=!1,t}return __extends(i,e),Object.defineProperty(i.prototype,"props",{get:function(){return this._props},set:function(t){this._props=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"paths",{get:function(){return this._paths},set:function(t){this._paths=t||[]},enumerable:!0,configurable:!0}),i.prototype.play=function(t){this.tween?(this.tween.setPaused(!1),this.isStop&&void 0==t&&(t=0,this.isStop=!1),void 0!==t&&null!==t&&this.tween.setPosition(t)):this.createTween(t)},i.prototype.pause=function(){this.tween&&this.tween.setPaused(!0)},i.prototype.stop=function(){this.pause(),this.isStop=!0},i.prototype.createTween=function(e){this.tween=t.Tween.get(this._target,this._props),this._paths&&this.applyPaths(),void 0!==e&&null!==e&&this.tween.setPosition(e)},i.prototype.applyPaths=function(){for(var t=0;t<this._paths.length;t++){var e=this._paths[t];this.applyPath(e)}},i.prototype.applyPath=function(t){var e=this;t instanceof o?this.tween.to(t.props,t.duration,r(t.ease)):t instanceof a?this.tween.wait(t.duration,t.passive):t instanceof s?this.tween.set(t.props):t instanceof c&&this.tween.$tick(t.delta),this.tween.call(function(){return e.pathComplete(t)})},i.prototype.pathComplete=function(t){t.dispatchEventWith("complete"),this.dispatchEventWith("pathComplete",!1,t);var e=this._paths.indexOf(t);e>=0&&e===this._paths.length-1&&this.dispatchEventWith("complete")},i}(t.EventDispatcher);e.TweenItem=h,__reflect(h.prototype,"egret.tween.TweenItem"),i(h,"paths","Array",!0);var u=function(t){function e(){var e=t.call(this)||this;return e.completeCount=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},set:function(t){this.completeCount=0,this.registerEvent(!1),this._items=t,this.registerEvent(!0)},enumerable:!0,configurable:!0}),e.prototype.registerEvent=function(t){var e=this;this._items&&this._items.forEach(function(r){t?r.addEventListener("complete",e.itemComplete,e):r.removeEventListener("complete",e.itemComplete,e)})},e.prototype.play=function(t){if(this._items)for(var e=0;e<this._items.length;e++){var r=this._items[e];r.play(t)}},e.prototype.pause=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.pause()}},e.prototype.stop=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.stop()}},e.prototype.itemComplete=function(t){var e=t.currentTarget;this.completeCount++,this.dispatchEventWith("itemComplete",!1,e),this.completeCount===this.items.length&&(this.dispatchEventWith("complete"),this.completeCount=0)},e}(t.EventDispatcher);e.TweenGroup=u,__reflect(u.prototype,"egret.tween.TweenGroup"),i(u,"items","Array",!0)}(e=t.tween||(t.tween={}))}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r},egret;!function(t){var e=function(){function t(){}return t.BINARY="binary",t.TEXT="text",t.VARIABLES="variables",t.TEXTURE="texture",t.SOUND="sound",t}();t.URLLoaderDataFormat=e,__reflect(e.prototype,"egret.URLLoaderDataFormat")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i){var n=t.call(this)||this;return n._name=e,n._frame=0|r,i&&(n._end=0|i),n}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._name,this._frame,this._end)},e}(t.EventDispatcher);t.FrameLabel=e,__reflect(e.prototype,"egret.FrameLabel")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t.$mcData=null,t.numFrames=1,t.frames=[],t.labels=null,t.events=[],t.frameRate=0,t.textureData=null,t.spriteSheet=null,t}return __extends(r,e),r.prototype.$init=function(t,e,r){this.textureData=e,this.spriteSheet=r,this.setMCData(t)},r.prototype.getKeyFrameData=function(t){var e=this.frames[t-1];return e.frame&&(e=this.frames[e.frame-1]),e},r.prototype.getTextureByFrame=function(t){var e=this.getKeyFrameData(t);if(e.res){var r=this.getTextureByResName(e.res);return r}return null},r.prototype.$getOffsetByFrame=function(t,e){var r=this.getKeyFrameData(t);r.res&&e.setTo(0|r.x,0|r.y)},r.prototype.getTextureByResName=function(t){if(null==this.spriteSheet)return null;var e=this.spriteSheet.getTexture(t);if(!e){var r=this.textureData[t];e=this.spriteSheet.createTexture(t,r.x,r.y,r.w,r.h)}return e},r.prototype.$isDataValid=function(){return this.frames.length>0},r.prototype.$isTextureValid=function(){return null!=this.textureData&&null!=this.spriteSheet},r.prototype.$fillMCData=function(t){this.frameRate=t.frameRate||24,this.fillFramesData(t.frames),this.fillFrameLabelsData(t.labels),this.fillFrameEventsData(t.events)},r.prototype.fillFramesData=function(t){for(var e,r=this.frames,i=t?t.length:0,n=0;i>n;n++){var o=t[n];if(r.push(o),o.duration){var a=parseInt(o.duration);if(a>1){e=r.length;for(var s=1;a>s;s++)r.push({frame:e})}}}this.numFrames=r.length},r.prototype.fillFrameLabelsData=function(e){if(e){var r=e.length;if(r>0){this.labels=[];for(var i=0;r>i;i++){var n=e[i];this.labels.push(new t.FrameLabel(n.name,n.frame,n.end))}}}},r.prototype.fillFrameEventsData=function(t){if(t){var e=t.length;if(e>0){this.events=[];for(var r=0;e>r;r++){var i=t[r];this.events[i.frame]=i.name}}}},Object.defineProperty(r.prototype,"mcData",{get:function(){return this.$mcData},set:function(t){this.setMCData(t)},enumerable:!0,configurable:!0}),r.prototype.setMCData=function(t){this.$mcData!=t&&(this.$mcData=t,t&&this.$fillMCData(t))},r}(t.HashObject);t.MovieClipData=e,__reflect(e.prototype,"egret.MovieClipData")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r){var i=e.call(this)||this;return i.enableCache=!0,i.$mcDataCache={},i.$mcDataSet=t,i.setTexture(r),i}return __extends(r,e),r.prototype.clearCache=function(){this.$mcDataCache={}},r.prototype.generateMovieClipData=function(e){if(void 0===e&&(e=""),""==e&&this.$mcDataSet)for(e in this.$mcDataSet.mc)break;if(""==e)return null;var r=this.findFromCache(e,this.$mcDataCache);return r||(r=new t.MovieClipData,this.fillData(e,r,this.$mcDataCache)),r},r.prototype.findFromCache=function(t,e){return this.enableCache&&e[t]?e[t]:null},r.prototype.fillData=function(t,e,r){if(this.$mcDataSet){var i=this.$mcDataSet.mc[t];i&&(e.$init(i,this.$mcDataSet.res,this.$spriteSheet),this.enableCache&&(r[t]=e))}},Object.defineProperty(r.prototype,"mcDataSet",{get:function(){return this.$mcDataSet},set:function(t){this.$mcDataSet=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"texture",{set:function(t){this.setTexture(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"spriteSheet",{get:function(){return this.$spriteSheet},enumerable:!0,configurable:!0}),r.prototype.setTexture=function(e){this.$spriteSheet=e?new t.SpriteSheet(e):null},r}(t.EventDispatcher);t.MovieClipDataFactory=e,__reflect(e.prototype,"egret.MovieClipDataFactory")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,n){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===n&&(n=null);var o=e.call(this,t,r,i)||this;return o.frameLabel=null,o.frameLabel=n,o}return __extends(r,e),r.dispatchMovieClipEvent=function(e,i,n){void 0===n&&(n=null);var o=t.Event.create(r,i);o.frameLabel=n;var a=e.dispatchEvent(o);return t.Event.release(o),a},r.FRAME_LABEL="frame_label",r}(t.Event);t.MovieClipEvent=e,__reflect(e.prototype,"egret.MovieClipEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.quintOut=e.getPowOut(5),e.quartOut=e.getPowOut(4),e}();t.ScrollEase=e,__reflect(e.prototype,"egret.ScrollEase");var r=function(e){function r(t,r,i){var n=e.call(this)||this;return n._target=null,n._useTicks=!1,n.ignoreGlobalPause=!1,n.loop=!1,n.pluginData=null,n._steps=null,n._actions=null,n.paused=!1,n.duration=0,n._prevPos=-1,n.position=null,n._prevPosition=0,n._stepPosition=0,n.passive=!1,n.initialize(t,r,i),n}return __extends(r,e),r.get=function(t,e,i,n){return void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),n&&r.removeTweens(t),new r(t,e,i)},r.removeTweens=function(t){if(t.tween_count){for(var e=r._tweens,i=e.length-1;i>=0;i--)e[i]._target==t&&(e[i].paused=!0,e.splice(i,1));t.tween_count=0}},r.tick=function(t,e){void 0===e&&(e=!1);var i=t-r._lastTime;r._lastTime=t;for(var n=r._tweens.concat(),o=n.length-1;o>=0;o--){var a=n[o];e&&!a.ignoreGlobalPause||a.paused||a.tick(a._useTicks?1:i)}return!1},r._register=function(e,i){var n=e._target,o=r._tweens;if(i)n&&(n.tween_count=n.tween_count>0?n.tween_count+1:1),o.push(e),r._inited||(r._lastTime=t.getTimer(),t.ticker.$startTick(r.tick,null),r._inited=!0);else{n&&n.tween_count--;for(var a=o.length;a--;)if(o[a]==e)return void o.splice(a,1)}},r.prototype.initialize=function(t,e,i){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&r.removeTweens(t)),this.pluginData=i||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],this._actions=[],e&&e.paused?this.paused=!0:r._register(this,!0),e&&null!=e.position&&this.setPosition(e.position)},r.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var r=t,i=!1;if(r>=this.duration&&(this.loop?r%=this.duration:(r=this.duration,i=!0)),r==this._prevPos)return i;var n=this._prevPos;if(this.position=this._prevPos=r,this._prevPosition=t,this._target)if(i)this._updateTargetProps(null,1);else if(this._steps.length>0){var o=void 0,a=this._steps.length;for(o=0;a>o&&!(this._steps[o].t>r);o++);var s=this._steps[o-1];this._updateTargetProps(s,(this._stepPosition=r-s.t)/s.d)}return i&&this.setPaused(!0),0!=e&&this._actions.length>0&&(this._useTicks?this._runActions(r,r):1==e&&n>r?(n!=this.duration&&this._runActions(n,this.duration),this._runActions(0,r,!0)):this._runActions(n,r)),this.dispatchEventWith("change"),i},r.prototype._runActions=function(t,e,r){void 0===r&&(r=!1);var i=t,n=e,o=-1,a=this._actions.length,s=1;for(t>e&&(i=e,n=t,o=a,a=s=-1);(o+=s)!=a;){var c=this._actions[o],h=c.t;(h==n||h>i&&n>h||r&&h==t)&&c.f.apply(c.o,c.p)}},r.prototype._updateTargetProps=function(t,e){var i,n,o,a,s,c;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),i=t.p0,n=t.p1}else this.passive=!1,i=n=this._curQueueProps;for(var h in this._initQueueProps){null==(a=i[h])&&(i[h]=a=this._initQueueProps[h]),null==(s=n[h])&&(n[h]=s=a),o=a==s||0==e||1==e||"number"!=typeof a?1==e?s:a:a+(s-a)*e;var u=!1;if(c=r._plugins[h])for(var l=0,p=c.length;p>l;l++){var d=c[l].tween(this,h,o,i,n,e,!!t&&i==n,!t);d==r.IGNORE?u=!0:o=d}u||(this._target[h]=o)}},r.prototype.setPaused=function(t){return this.paused=t,r._register(this,!t),this},r.prototype._cloneProps=function(t){var e={};for(var r in t)e[r]=t[r];return e},r.prototype._addStep=function(t){return t.d>0&&(this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},r.prototype._appendQueueProps=function(t){var e,i,n,o,a;for(var s in t)if(void 0===this._initQueueProps[s]){if(i=this._target[s],e=r._plugins[s])for(n=0,o=e.length;o>n;n++)i=e[n].init(this,s,i);this._initQueueProps[s]=this._curQueueProps[s]=void 0===i?null:i}else i=this._curQueueProps[s];for(var s in t){if(i=this._curQueueProps[s],e=r._plugins[s])for(a=a||{},n=0,o=e.length;o>n;n++)e[n].step&&e[n].step(this,s,i,t[s],a);this._curQueueProps[s]=t[s]}return a&&this._appendQueueProps(a),this._curQueueProps},r.prototype._addAction=function(t){return t.t=this.duration,this._actions.push(t),this},r.prototype.to=function(t,e,r){return void 0===r&&(r=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:r,p1:this._cloneProps(this._appendQueueProps(t))})},r.prototype.call=function(t,e,r){return void 0===e&&(e=void 0),void 0===r&&(r=void 0),this._addAction({f:t,p:r?r:[],o:e?e:this._target})},r.prototype.tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},r._tweens=[],r.IGNORE={},r._plugins={},r._inited=!1,r._lastTime=0,r}(t.EventDispatcher);t.ScrollTween=r,__reflect(r.prototype,"egret.ScrollTween")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){void 0===r&&(r=null);var i=e.call(this)||this;return i.scrollBeginThreshold=10,i.scrollSpeed=1,i._content=null,i.delayTouchBeginEvent=null,i.touchBeginTimer=null,i.touchEnabled=!0,i._ScrV_Props_=new t.ScrollViewProperties,r&&i.setContent(r),i}return __extends(r,e),Object.defineProperty(r.prototype,"bounces",{get:function(){return this._ScrV_Props_._bounces},set:function(t){this._ScrV_Props_._bounces=!!t},enumerable:!0,configurable:!0}),r.prototype.setContent=function(t){this._content!==t&&(this.removeContent(),t&&(this._content=t,e.prototype.addChild.call(this,t),this._addEvents()))},r.prototype.removeContent=function(){this._content&&(this._removeEvents(),e.prototype.removeChildAt.call(this,0)),this._content=null},Object.defineProperty(r.prototype,"verticalScrollPolicy",{get:function(){return this._ScrV_Props_._verticalScrollPolicy},set:function(t){t!=this._ScrV_Props_._verticalScrollPolicy&&(this._ScrV_Props_._verticalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"horizontalScrollPolicy",{get:function(){return this._ScrV_Props_._horizontalScrollPolicy},set:function(t){t!=this._ScrV_Props_._horizontalScrollPolicy&&(this._ScrV_Props_._horizontalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scrollLeft",{get:function(){return this._ScrV_Props_._scrollLeft},set:function(t){t!=this._ScrV_Props_._scrollLeft&&(this._ScrV_Props_._scrollLeft=t,this._validatePosition(!1,!0),this._updateContentPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scrollTop",{get:function(){return this._ScrV_Props_._scrollTop},set:function(t){t!=this._ScrV_Props_._scrollTop&&(this._ScrV_Props_._scrollTop=t,this._validatePosition(!0,!1),this._updateContentPosition())
},enumerable:!0,configurable:!0}),r.prototype.setScrollPosition=function(t,e,r){if(void 0===r&&(r=!1),(!r||0!=t||0!=e)&&(r||this._ScrV_Props_._scrollTop!=t||this._ScrV_Props_._scrollLeft!=e)){var i=this._ScrV_Props_._scrollTop,n=this._ScrV_Props_._scrollLeft;if(r){var o=this.getMaxScrollLeft(),a=this.getMaxScrollTop();(0>=i||i>=a)&&(t/=2),(0>=n||n>=o)&&(e/=2);var s=i+t,c=n+e,h=this._ScrV_Props_._bounces;h||((0>=s||s>=a)&&(s=Math.max(0,Math.min(s,a))),(0>=c||c>=o)&&(c=Math.max(0,Math.min(c,o)))),this._ScrV_Props_._scrollTop=s,this._ScrV_Props_._scrollLeft=c}else this._ScrV_Props_._scrollTop=t,this._ScrV_Props_._scrollLeft=e;this._validatePosition(!0,!0),this._updateContentPosition()}},r.prototype._validatePosition=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),t){var r=this.height,i=this._getContentHeight();this._ScrV_Props_._scrollTop=Math.max(this._ScrV_Props_._scrollTop,(0-r)/2),this._ScrV_Props_._scrollTop=Math.min(this._ScrV_Props_._scrollTop,i>r?i-r/2:r/2)}if(e){var n=this.width,o=this._getContentWidth();this._ScrV_Props_._scrollLeft=Math.max(this._ScrV_Props_._scrollLeft,(0-n)/2),this._ScrV_Props_._scrollLeft=Math.min(this._ScrV_Props_._scrollLeft,o>n?o-n/2:n/2)}},r.prototype.$setWidth=function(t){this.$explicitWidth!=t&&(e.prototype.$setWidth.call(this,t),this._updateContentPosition())},r.prototype.$setHeight=function(t){this.$explicitHeight!=t&&(e.prototype.$setHeight.call(this,t),this._updateContentPosition())},r.prototype._updateContentPosition=function(){var e=this.height,r=this.width;this.scrollRect=new t.Rectangle(Math.round(this._ScrV_Props_._scrollLeft),Math.round(this._ScrV_Props_._scrollTop),r,e),this.dispatchEvent(new t.Event(t.Event.CHANGE))},r.prototype._checkScrollPolicy=function(){var t=this._ScrV_Props_._horizontalScrollPolicy,e=this.__checkScrollPolicy(t,this._getContentWidth(),this.width);this._ScrV_Props_._hCanScroll=e;var r=this._ScrV_Props_._verticalScrollPolicy,i=this.__checkScrollPolicy(r,this._getContentHeight(),this.height);return this._ScrV_Props_._vCanScroll=i,e||i},r.prototype.__checkScrollPolicy=function(t,e,r){return"on"==t?!0:"off"==t?!1:e>r},r.prototype._addEvents=function(){this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},r.prototype._removeEvents=function(){this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},r.prototype._onTouchBegin=function(e){if(!e.$isDefaultPrevented){var r=this._checkScrollPolicy();r&&(this._ScrV_Props_._touchStartPosition.x=e.stageX,this._ScrV_Props_._touchStartPosition.y=e.stageY,(this._ScrV_Props_._isHTweenPlaying||this._ScrV_Props_._isVTweenPlaying)&&this._onScrollFinished(),this._tempStage=this.stage,this._tempStage.addEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.addEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.addEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._logTouchEvent(e),e.preventDefault())}},r.prototype._onTouchBeginCapture=function(e){var r=this._checkScrollPolicy();if(r){for(var i=e.target;i!=this;){if("_checkScrollPolicy"in i&&(r=i._checkScrollPolicy()))return;i=i.parent}e.stopPropagation();var n=this.cloneTouchEvent(e);this.delayTouchBeginEvent=n,this.touchBeginTimer||(this.touchBeginTimer=new t.Timer(100,1),this.touchBeginTimer.addEventListener(t.TimerEvent.TIMER_COMPLETE,this._onTouchBeginTimer,this)),this.touchBeginTimer.start(),this._onTouchBegin(e)}},r.prototype._onTouchEndCapture=function(e){var r=this;if(this.delayTouchBeginEvent){this._onTouchBeginTimer(),e.stopPropagation();var i=this.cloneTouchEvent(e);t.callLater(function(){r.stage&&r.dispatchPropagationEvent(i)},this)}},r.prototype._onTouchBeginTimer=function(){this.touchBeginTimer.stop();var t=this.delayTouchBeginEvent;this.delayTouchBeginEvent=null,this.stage&&this.dispatchPropagationEvent(t)},r.prototype.dispatchPropagationEvent=function(e){for(var r=e.$target,i=this.$getPropagationList(r),n=i.length,o=.5*i.length,a=-1,s=0;n>s;s++)if(i[s]===this._content){a=s;break}i.splice(0,a+1),o-=a+1,this.$dispatchPropagationEvent(e,i,o),t.Event.release(e)},r.prototype._onTouchMove=function(t){if(this._ScrV_Props_._lastTouchPosition.x!=t.stageX||this._ScrV_Props_._lastTouchPosition.y!=t.stageY){if(!this._ScrV_Props_._scrollStarted){var e=t.stageX-this._ScrV_Props_._touchStartPosition.x,r=t.stageY-this._ScrV_Props_._touchStartPosition.y,i=Math.sqrt(e*e+r*r);if(i<this.scrollBeginThreshold)return void this._logTouchEvent(t)}this._ScrV_Props_._scrollStarted=!0,this.delayTouchBeginEvent&&(this.delayTouchBeginEvent=null,this.touchBeginTimer.stop()),this.touchChildren=!1;var n=this._getPointChange(t);this.setScrollPosition(n.y,n.x,!0),this._calcVelocitys(t),this._logTouchEvent(t)}},r.prototype._onTouchEnd=function(e){this.touchChildren=!0,this._ScrV_Props_._scrollStarted=!1,this._tempStage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.removeEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.removeEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._moveAfterTouchEnd()},r.prototype._onEnterFrame=function(e){var r=t.getTimer();r-this._ScrV_Props_._lastTouchTime>100&&r-this._ScrV_Props_._lastTouchTime<300&&this._calcVelocitys(this._ScrV_Props_._lastTouchEvent)},r.prototype._logTouchEvent=function(e){this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY,this._ScrV_Props_._lastTouchEvent=this.cloneTouchEvent(e),this._ScrV_Props_._lastTouchTime=t.getTimer()},r.prototype._getPointChange=function(t){return{x:this._ScrV_Props_._hCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.x-t.stageX,y:this._ScrV_Props_._vCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.y-t.stageY}},r.prototype._calcVelocitys=function(e){var r=t.getTimer();if(0==this._ScrV_Props_._lastTouchTime)return void(this._ScrV_Props_._lastTouchTime=r);var i=this._getPointChange(e),n=r-this._ScrV_Props_._lastTouchTime;i.x/=n,i.y/=n,this._ScrV_Props_._velocitys.push(i),this._ScrV_Props_._velocitys.length>5&&this._ScrV_Props_._velocitys.shift(),this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY},r.prototype._getContentWidth=function(){return this._content.$explicitWidth||this._content.width},r.prototype._getContentHeight=function(){return this._content.$explicitHeight||this._content.height},r.prototype.getMaxScrollLeft=function(){var t=this._getContentWidth()-this.width;return Math.max(0,t)},r.prototype.getMaxScrollTop=function(){var t=this._getContentHeight()-this.height;return Math.max(0,t)},r.prototype._moveAfterTouchEnd=function(){if(0!=this._ScrV_Props_._velocitys.length){for(var t={x:0,y:0},e=0,i=0;i<this._ScrV_Props_._velocitys.length;i++){var n=this._ScrV_Props_._velocitys[i],o=r.weight[i];t.x+=n.x*o,t.y+=n.y*o,e+=o}this._ScrV_Props_._velocitys.length=0,this.scrollSpeed<=0&&(this.scrollSpeed=1);var a=t.x/e*this.scrollSpeed,s=t.y/e*this.scrollSpeed,c=Math.abs(a),h=Math.abs(s),u=this.getMaxScrollLeft(),l=this.getMaxScrollTop(),p=c>.02?this.getAnimationDatas(a,this._ScrV_Props_._scrollLeft,u):{position:this._ScrV_Props_._scrollLeft,duration:1},d=h>.02?this.getAnimationDatas(s,this._ScrV_Props_._scrollTop,l):{position:this._ScrV_Props_._scrollTop,duration:1};this.setScrollLeft(p.position,p.duration),this.setScrollTop(d.position,d.duration)}},r.prototype.onTweenFinished=function(t){t==this._ScrV_Props_._vScrollTween&&(this._ScrV_Props_._isVTweenPlaying=!1),t==this._ScrV_Props_._hScrollTween&&(this._ScrV_Props_._isHTweenPlaying=!1),0==this._ScrV_Props_._isHTweenPlaying&&0==this._ScrV_Props_._isVTweenPlaying&&this._onScrollFinished()},r.prototype._onScrollStarted=function(){},r.prototype._onScrollFinished=function(){t.ScrollTween.removeTweens(this),this._ScrV_Props_._hScrollTween=null,this._ScrV_Props_._vScrollTween=null,this._ScrV_Props_._isHTweenPlaying=!1,this._ScrV_Props_._isVTweenPlaying=!1,this.dispatchEvent(new t.Event(t.Event.COMPLETE))},r.prototype.setScrollTop=function(e,r){void 0===r&&(r=0);var i=Math.min(this.getMaxScrollTop(),Math.max(e,0));if(0==r)return void(this.scrollTop=i);0==this._ScrV_Props_._bounces&&(e=i);var n=t.ScrollTween.get(this).to({scrollTop:e},r,t.ScrollEase.quartOut);i!=e&&n.to({scrollTop:i},300,t.ScrollEase.quintOut),this._ScrV_Props_._isVTweenPlaying=!0,this._ScrV_Props_._vScrollTween=n,n.call(this.onTweenFinished,this,[n]),this._ScrV_Props_._isHTweenPlaying||this._onScrollStarted()},r.prototype.setScrollLeft=function(e,r){void 0===r&&(r=0);var i=Math.min(this.getMaxScrollLeft(),Math.max(e,0));if(0==r)return void(this.scrollLeft=i);0==this._ScrV_Props_._bounces&&(e=i);var n=t.ScrollTween.get(this).to({scrollLeft:e},r,t.ScrollEase.quartOut);i!=e&&n.to({scrollLeft:i},300,t.ScrollEase.quintOut),this._ScrV_Props_._isHTweenPlaying=!0,this._ScrV_Props_._hScrollTween=n,n.call(this.onTweenFinished,this,[n]),this._ScrV_Props_._isVTweenPlaying||this._onScrollStarted()},r.prototype.getAnimationDatas=function(t,e,r){var i=Math.abs(t),n=.95,o=0,a=.998,s=.02,c=e+500*t;if(0>c||c>r)for(c=e;Math.abs(t)!=1/0&&Math.abs(t)>s;)c+=t,t*=0>c||c>r?a*n:a,o++;else o=500*-Math.log(s/i);var h={position:Math.min(r+50,Math.max(c,-50)),duration:o};return h},r.prototype.cloneTouchEvent=function(e){var r=new t.TouchEvent(e.type,e.bubbles,e.cancelable);return r.touchPointID=e.touchPointID,r.$stageX=e.stageX,r.$stageY=e.stageY,r.touchDown=e.touchDown,r.$isDefaultPrevented=!1,r.$target=e.target,r},r.prototype.throwNotSupportedError=function(){t.$error(1023)},r.prototype.addChild=function(t){return this.throwNotSupportedError(),null},r.prototype.addChildAt=function(t,e){return this.throwNotSupportedError(),null},r.prototype.removeChild=function(t){return this.throwNotSupportedError(),null},r.prototype.removeChildAt=function(t){return this.throwNotSupportedError(),null},r.prototype.setChildIndex=function(t,e){this.throwNotSupportedError()},r.prototype.swapChildren=function(t,e){this.throwNotSupportedError()},r.prototype.swapChildrenAt=function(t,e){this.throwNotSupportedError()},r.weight=[1,1.33,1.66,2,2.33],r}(t.DisplayObjectContainer);t.ScrollView=e,__reflect(e.prototype,"egret.ScrollView")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this._verticalScrollPolicy="auto",this._horizontalScrollPolicy="auto",this._scrollLeft=0,this._scrollTop=0,this._hCanScroll=!1,this._vCanScroll=!1,this._lastTouchPosition=new t.Point(0,0),this._touchStartPosition=new t.Point(0,0),this._scrollStarted=!1,this._lastTouchTime=0,this._lastTouchEvent=null,this._velocitys=[],this._isHTweenPlaying=!1,this._isVTweenPlaying=!1,this._hScrollTween=null,this._vScrollTween=null,this._bounces=!0}return e}();t.ScrollViewProperties=e,__reflect(e.prototype,"egret.ScrollViewProperties")}(egret||(egret={}));var egret;!function(t){function e(e){var r=e.url;return-1==r.indexOf("?")&&e.method==t.URLRequestMethod.GET&&e.data&&e.data instanceof t.URLVariables&&(r=r+"?"+e.data.toString()),r}var r=function(r){function i(e){void 0===e&&(e=null);var i=r.call(this)||this;return i.dataFormat=t.URLLoaderDataFormat.TEXT,i.data=null,i._request=null,i._status=-1,e&&i.load(e),i}return __extends(i,r),i.prototype.load=function(r){this._request=r,this.data=null;var i=this;if(i.dataFormat==t.URLLoaderDataFormat.TEXTURE)return void this.loadTexture(i);if(i.dataFormat==t.URLLoaderDataFormat.SOUND)return void this.loadSound(i);var n=e(r),o=new t.HttpRequest;o.open(n,r.method==t.URLRequestMethod.POST?t.HttpMethod.POST:t.HttpMethod.GET);var a;if(r.method!=t.URLRequestMethod.GET&&r.data)if(r.data instanceof t.URLVariables){o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var s=r.data;a=s.toString()}else o.setRequestHeader("Content-Type","multipart/form-data"),a=r.data;for(var c=r.requestHeaders.length,h=0;c>h;h++){var u=r.requestHeaders[h];o.setRequestHeader(u.name,u.value)}o.addEventListener(t.Event.COMPLETE,function(){i.data=o.response,t.Event.dispatchEvent(i,t.Event.COMPLETE)},this),o.addEventListener(t.IOErrorEvent.IO_ERROR,function(){t.IOErrorEvent.dispatchIOErrorEvent(i)},this),o.responseType=i.dataFormat==t.URLLoaderDataFormat.BINARY?t.HttpResponseType.ARRAY_BUFFER:t.HttpResponseType.TEXT,o.send(a)},i.prototype.getResponseType=function(e){switch(e){case t.URLLoaderDataFormat.TEXT:case t.URLLoaderDataFormat.VARIABLES:return t.URLLoaderDataFormat.TEXT;case t.URLLoaderDataFormat.BINARY:return"arraybuffer";default:return e}},i.prototype.loadSound=function(e){var r=e._request.url,i=new t.Sound;this.sound=i,i.addEventListener(t.Event.COMPLETE,this.onSoundoadComplete,this),i.addEventListener(t.IOErrorEvent.IO_ERROR,this.onSoundLoaderError,this),i.addEventListener(t.ProgressEvent.PROGRESS,this.onSoundLoaderPostProgress,this),i.load(r)},i.prototype.onSoundoadComplete=function(e){var r=this;this.removeSoundLoaderListeners(),this.data=this.sound,window.setTimeout(function(){r.dispatchEventWith(t.Event.COMPLETE)},0)},i.prototype.onSoundLoaderPostProgress=function(t){this.dispatchEvent(t)},i.prototype.onSoundLoaderError=function(t){this.dispatchEvent(t)},i.prototype.removeSoundLoaderListeners=function(){this.sound.removeEventListener(t.Event.COMPLETE,this.onSoundoadComplete,this),this.sound.removeEventListener(t.IOErrorEvent.IO_ERROR,this.onSoundLoaderError,this),this.sound.removeEventListener(t.ProgressEvent.PROGRESS,this.onSoundLoaderPostProgress,this)},i.prototype.loadTexture=function(e){this.virtualUrl=e._request.url;var r=new t.ImageLoader;this.imageLoader=r,r.addEventListener(t.Event.COMPLETE,this.onImageLoadComplete,this),r.addEventListener(t.IOErrorEvent.IO_ERROR,this.onImageLoaderError,this),r.addEventListener(t.ProgressEvent.PROGRESS,this.onImageLoaderPostProgress,this),r.load(this.virtualUrl)},i.prototype.onImageLoadComplete=function(e){var r=this;this.removeImageLoaderListeners();var i=new t.Texture,n=this.imageLoader.data;n.source.setAttribute&&n.source.setAttribute("bitmapSrc",this.virtualUrl),i._setBitmapData(n),this.data=i,window.setTimeout(function(){r.dispatchEventWith(t.Event.COMPLETE)},0)},i.prototype.onImageLoaderPostProgress=function(t){this.dispatchEvent(t)},i.prototype.onImageLoaderError=function(t){this.dispatchEvent(t)},i.prototype.removeImageLoaderListeners=function(){this.imageLoader.removeEventListener(t.Event.COMPLETE,this.onImageLoadComplete,this),this.imageLoader.removeEventListener(t.IOErrorEvent.IO_ERROR,this.onImageLoaderError,this),this.imageLoader.removeEventListener(t.ProgressEvent.PROGRESS,this.onImageLoaderPostProgress,this)},i.prototype.__recycle=function(){this._request=null,this.data=null},i}(t.EventDispatcher);t.URLLoader=r,__reflect(r.prototype,"egret.URLLoader")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){var i=e.call(this)||this;return i.$texture=null,i.offsetPoint=t.Point.create(0,0),i.$movieClipData=null,i.frames=null,i.$totalFrames=0,i.frameLabels=null,i.$frameLabelStart=0,i.$frameLabelEnd=0,i.frameEvents=null,i.frameIntervalTime=0,i.$eventPool=null,i.$isPlaying=!1,i.isStopped=!0,i.playTimes=0,i.$currentFrameNum=0,i.$nextFrameNum=1,i.displayedKeyFrameNum=0,i.passedTime=0,i.$frameRate=0/0,i.lastTime=0,i.$smoothing=t.Bitmap.defaultSmoothing,i.setMovieClipData(r),t.nativeRender||(i.$renderNode=new t.sys.NormalBitmapNode),i}return __extends(r,e),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(11)},Object.defineProperty(r.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t!=this.$smoothing&&(this.$smoothing=t)},enumerable:!0,configurable:!0}),r.prototype.$init=function(){this.$reset();var t=this.$movieClipData;t&&t.$isDataValid()&&(this.frames=t.frames,this.$totalFrames=t.numFrames,this.frameLabels=t.labels,this.frameEvents=t.events,this.$frameRate=t.frameRate,this.frameIntervalTime=1e3/this.$frameRate,this._initFrame())},r.prototype.$reset=function(){this.frames=null,this.playTimes=0,this.$isPlaying=!1,this.setIsStopped(!0),this.$currentFrameNum=0,this.$nextFrameNum=1,this.displayedKeyFrameNum=0,this.passedTime=0,this.$eventPool=[]},r.prototype._initFrame=function(){this.$movieClipData.$isTextureValid()&&(this.advanceFrame(),this.constructFrame())},r.prototype.$updateRenderNode=function(){var e=this.$texture;if(e){var r=Math.round(this.offsetPoint.x),i=Math.round(this.offsetPoint.y),n=e.$bitmapWidth,o=e.$bitmapHeight,a=e.$getTextureWidth(),s=e.$getTextureHeight(),c=Math.round(e.$getScaleBitmapWidth()),h=Math.round(e.$getScaleBitmapHeight()),u=e.$sourceWidth,l=e.$sourceHeight;t.sys.BitmapNode.$updateTextureData(this.$renderNode,e.$bitmapData,e.$bitmapX,e.$bitmapY,n,o,r,i,a,s,c,h,u,l,t.BitmapFillMode.SCALE,this.$smoothing)}},r.prototype.$measureContentBounds=function(t){var e=this.$texture;if(e){var r=this.offsetPoint.x,i=this.offsetPoint.y,n=e.$getTextureWidth(),o=e.$getTextureHeight();t.setTo(r,i,n,o)}else t.setEmpty()},r.prototype.$onAddToStage=function(t,r){e.prototype.$onAddToStage.call(this,t,r),this.$isPlaying&&this.$totalFrames>1&&this.setIsStopped(!1)},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.setIsStopped(!0)},r.prototype.getFrameLabelByName=function(t,e){void 0===e&&(e=!1),e&&(t=t.toLowerCase());var r=this.frameLabels;if(r)for(var i=null,n=0;n<r.length;n++)if(i=r[n],e?i.name.toLowerCase()==t:i.name==t)return i;return null},r.prototype.getFrameStartEnd=function(t){var e=this.frameLabels;if(e)for(var r=null,i=0;i<e.length;i++)if(r=e[i],t==r.name){this.$frameLabelStart=r.frame,this.$frameLabelEnd=r.end;break}},r.prototype.getFrameLabelByFrame=function(t){var e=this.frameLabels;if(e)for(var r=null,i=0;i<e.length;i++)if(r=e[i],r.frame==t)return r;return null},r.prototype.getFrameLabelForFrame=function(t){var e=null,r=null,i=this.frameLabels;if(i)for(var n=0;n<i.length;n++){if(r=i[n],r.frame>t)return e;e=r}return e},r.prototype.play=function(e){void 0===e&&(e=0),this.lastTime=t.getTimer(),this.passedTime=0,this.$isPlaying=!0,this.setPlayTimes(e),this.$totalFrames>1&&this.$stage&&this.setIsStopped(!1)},r.prototype.stop=function(){this.$isPlaying=!1,this.setIsStopped(!0)},r.prototype.prevFrame=function(){this.gotoAndStop(this.$currentFrameNum-1)},r.prototype.nextFrame=function(){this.gotoAndStop(this.$currentFrameNum+1)},r.prototype.gotoAndPlay=function(e,r){void 0===r&&(r=0),(0==arguments.length||arguments.length>2)&&t.$error(1022,"MovieClip.gotoAndPlay()"),"string"==typeof e?this.getFrameStartEnd(e):(this.$frameLabelStart=0,this.$frameLabelEnd=0),this.play(r),this.gotoFrame(e)},r.prototype.gotoAndStop=function(e){1!=arguments.length&&t.$error(1022,"MovieClip.gotoAndStop()"),this.stop(),this.gotoFrame(e)},r.prototype.gotoFrame=function(e){var r;"string"==typeof e?r=this.getFrameLabelByName(e).frame:(r=parseInt(e+"",10),r!=e&&t.$error(1022,"Frame Label Not Found")),1>r?r=1:r>this.$totalFrames&&(r=this.$totalFrames),r!=this.$nextFrameNum&&(this.$nextFrameNum=r,this.advanceFrame(),this.constructFrame(),this.handlePendingEvent())},r.prototype.advanceTime=function(e){var r=this,i=e-r.lastTime;r.lastTime=e;var n=r.frameIntervalTime,o=r.passedTime+i;r.passedTime=o%n;var a=o/n;if(1>a)return!1;for(;a>=1;){if(a--,r.$nextFrameNum++,r.$nextFrameNum>r.$totalFrames||r.$frameLabelStart>0&&r.$nextFrameNum>r.$frameLabelEnd)if(-1==r.playTimes)r.$eventPool.push(t.Event.LOOP_COMPLETE),r.$nextFrameNum=1;else{if(r.playTimes--,!(r.playTimes>0)){r.$nextFrameNum=r.$totalFrames,r.$eventPool.push(t.Event.COMPLETE),r.stop();break}r.$eventPool.push(t.Event.LOOP_COMPLETE),r.$nextFrameNum=1}r.$currentFrameNum==r.$frameLabelEnd&&(r.$nextFrameNum=r.$frameLabelStart),r.advanceFrame()}return r.constructFrame(),r.handlePendingEvent(),!1},r.prototype.advanceFrame=function(){this.$currentFrameNum=this.$nextFrameNum;var e=this.frameEvents[this.$nextFrameNum];e&&""!=e&&t.MovieClipEvent.dispatchMovieClipEvent(this,t.MovieClipEvent.FRAME_LABEL,e)},r.prototype.constructFrame=function(){var e=this,r=e.$currentFrameNum;if(e.displayedKeyFrameNum!=r){var i=e.$movieClipData.getTextureByFrame(r);if(e.$texture=i,e.$movieClipData.$getOffsetByFrame(r,e.offsetPoint),e.displayedKeyFrameNum=r,e.$renderDirty=!0,t.nativeRender)e.$nativeDisplayObject.setDataToBitmapNode(e.$nativeDisplayObject.id,i,[i.$bitmapX,i.$bitmapY,i.$bitmapWidth,i.$bitmapHeight,e.offsetPoint.x,e.offsetPoint.y,i.$getScaleBitmapWidth(),i.$getScaleBitmapHeight(),i.$sourceWidth,i.$sourceHeight]),e.$nativeDisplayObject.setWidth(i.$getTextureWidth()+e.offsetPoint.x),e.$nativeDisplayObject.setHeight(i.$getTextureHeight()+e.offsetPoint.y);else{var n=e.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var o=e.$maskedObject;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp())}}},r.prototype.$renderFrame=function(){var t=this;t.$texture=t.$movieClipData.getTextureByFrame(t.$currentFrameNum),t.$renderDirty=!0;var e=t.$parent;e&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp());var r=t.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())},r.prototype.handlePendingEvent=function(){if(0!=this.$eventPool.length){this.$eventPool.reverse();for(var e=this.$eventPool,r=e.length,i=!1,n=!1,o=0;r>o;o++){var a=e.pop();a==t.Event.LOOP_COMPLETE?n=!0:a==t.Event.COMPLETE?i=!0:this.dispatchEventWith(a)}n&&this.dispatchEventWith(t.Event.LOOP_COMPLETE),i&&this.dispatchEventWith(t.Event.COMPLETE)}},Object.defineProperty(r.prototype,"totalFrames",{get:function(){return this.$totalFrames},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentFrame",{get:function(){return this.$currentFrameNum},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentFrameLabel",{get:function(){var t=this.getFrameLabelByFrame(this.$currentFrameNum);return t&&t.name},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentLabel",{get:function(){var t=this.getFrameLabelForFrame(this.$currentFrameNum);return t?t.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"frameRate",{get:function(){return this.$frameRate},set:function(t){t!=this.$frameRate&&(this.$frameRate=t,this.frameIntervalTime=1e3/this.$frameRate)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isPlaying",{get:function(){return this.$isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"movieClipData",{get:function(){return this.$movieClipData},set:function(t){this.setMovieClipData(t)},enumerable:!0,configurable:!0}),r.prototype.setMovieClipData=function(t){this.$movieClipData!=t&&(this.$movieClipData=t,this.$init())},r.prototype.setPlayTimes=function(t){(0>t||t>=1)&&(this.playTimes=0>t?-1:Math.floor(t))},r.prototype.setIsStopped=function(e){this.isStopped!=e&&(this.isStopped=e,e?t.ticker.$stopTick(this.advanceTime,this):(this.playTimes=0==this.playTimes?1:this.playTimes,this.lastTime=t.getTimer(),t.ticker.$startTick(this.advanceTime,this)))},r}(t.DisplayObject);t.MovieClip=e,__reflect(e.prototype,"egret.MovieClip")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){void 0===r&&(r=null);var i=e.call(this)||this;return i.data=null,i.method=t.URLRequestMethod.GET,i.url="",i.requestHeaders=[],i.url=r,i}return __extends(r,e),r}(t.HashObject);t.URLRequest=e,__reflect(e.prototype,"egret.URLRequest")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(t,e){this.name="",this.value="",this.name=t,this.value=e}return t}();t.URLRequestHeader=e,__reflect(e.prototype,"egret.URLRequestHeader")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.GET="get",t.POST="post",t}();t.URLRequestMethod=e,__reflect(e.prototype,"egret.URLRequestMethod")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.variables=null,null!==e&&r.decode(e),r}return __extends(e,t),e.prototype.decode=function(t){this.variables||(this.variables={}),t=t.split("+").join(" ");for(var e,r=/[?&]?([^=]+)=([^&]*)/g;e=r.exec(t);){var i=decodeURIComponent(e[1]),n=decodeURIComponent(e[2]);if(i in this.variables!=0){var o=this.variables[i];o instanceof Array?o.push(n):this.variables[i]=[o,n]}else this.variables[i]=n}},e.prototype.toString=function(){if(!this.variables)return"";var t=this.variables,e=[];for(var r in t)e.push(this.encodeValue(r,t[r]));return e.join("&")},e.prototype.encodeValue=function(t,e){return e instanceof Array?this.encodeArray(t,e):encodeURIComponent(t)+"="+encodeURIComponent(e)},e.prototype.encodeArray=function(t,e){return t?0==e.length?encodeURIComponent(t)+"=":e.map(function(e){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&"):""},e}(t.HashObject);t.URLVariables=e,__reflect(e.prototype,"egret.URLVariables")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var i=e.call(this)||this;return i._timeScale=1,i._paused=!1,i._callIndex=-1,i._lastTime=0,i.callBackList=[],null!=r.instance,t.ticker.$startTick(i.update,i),i._lastTime=t.getTimer(),i}return __extends(r,e),r.prototype.update=function(t){var e=t-this._lastTime;if(this._lastTime=t,this._paused)return!1;var r=e*this._timeScale;for(this._callList=this.callBackList.concat(),this._callIndex=0;this._callIndex<this._callList.length;this._callIndex++){var i=this._callList[this._callIndex];i.listener.call(i.thisObject,r)}return this._callIndex=-1,this._callList=null,!1},r.prototype.register=function(t,e,r){void 0===r&&(r=0),this.$insertEventBin(this.callBackList,"",t,e,!1,r,!1)},r.prototype.unregister=function(t,e){this.$removeEventBin(this.callBackList,t,e)},r.prototype.setTimeScale=function(t){this._timeScale=t},r.prototype.getTimeScale=function(){return this._timeScale},r.prototype.pause=function(){this._paused=!0},r.prototype.resume=function(){this._paused=!1},r.getInstance=function(){return null==r.instance&&(r.instance=new r),r.instance},r}(t.EventDispatcher);t.Ticker=e,__reflect(e.prototype,"egret.Ticker")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){return e.call(this)||this}return __extends(r,e),Object.defineProperty(r.prototype,"stage",{get:function(){return t.sys.$TempStage},enumerable:!0,configurable:!0}),Object.defineProperty(r,"instance",{get:function(){return null==r._instance&&(r._instance=new r),r._instance},enumerable:!0,configurable:!0}),r.deviceType=null,r.DEVICE_PC="web",r.DEVICE_MOBILE="native",r}(t.EventDispatcher);t.MainContext=e,__reflect(e.prototype,"egret.MainContext")}(egret||(egret={})),egret.testDeviceType1=function(){if(!window.navigator||!navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")},egret.MainContext.deviceType=egret.testDeviceType1()?egret.MainContext.DEVICE_MOBILE:egret.MainContext.DEVICE_PC,delete egret.testDeviceType1;var egret;!function(t){var e=function(e){function r(t){void 0===t&&(t=300);var r=e.call(this)||this;return r.objectPool=[],r._length=0,1>t&&(t=1),r.autoDisposeTime=t,r.frameCount=0,r}return __extends(r,e),r.$init=function(){t.ticker.$startTick(r.onUpdate,r)},r.onUpdate=function(t){for(var e=r._callBackList,i=e.length-1;i>=0;i--)e[i].$checkFrame();return!1},r.prototype.$checkFrame=function(){this.frameCount--,this.frameCount<=0&&this.dispose()},Object.defineProperty(r.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),r.prototype.push=function(t){var e=this.objectPool;-1==e.indexOf(t)&&(e.push(t),t.__recycle&&t.__recycle(),this._length++,0==this.frameCount&&(this.frameCount=this.autoDisposeTime,r._callBackList.push(this)))},r.prototype.pop=function(){return 0==this._length?null:(this._length--,this.objectPool.pop())},r.prototype.dispose=function(){this._length>0&&(this.objectPool=[],this._length=0),this.frameCount=0;var t=r._callBackList,e=t.indexOf(this);-1!=e&&t.splice(e,1)},r._callBackList=[],r}(t.HashObject);t.Recycler=e,__reflect(e.prototype,"egret.Recycler"),e.$init()}(egret||(egret={}));var egret;!function(t){function e(e,r,c){for(var h=[],u=3;u<arguments.length;u++)h[u-3]=arguments[u];var l={listener:e,thisObject:r,delay:c,originDelay:c,params:h};return a++,1==a&&(s=t.getTimer(),t.ticker.$startTick(i,null)),o++,n[o]=l,o}function r(e){n[e]&&(a--,delete n[e],0==a&&t.ticker.$stopTick(i,null))}function i(t){var e=t-s;s=t;for(var r in n){var i=n[r];i.delay-=e,i.delay<=0&&(i.delay=i.originDelay,i.listener.apply(i.thisObject,i.params))}return!1}var n={},o=0,a=0,s=0;t.setInterval=e,t.clearInterval=r}(egret||(egret={}));var egret;!function(t){function e(e,r,c){for(var h=[],u=3;u<arguments.length;u++)h[u-3]=arguments[u];var l={listener:e,thisObject:r,delay:c,params:h};return a++,1==a&&t.ticker&&(s=t.getTimer(),t.ticker.$startTick(i,null)),o++,n[o]=l,o}function r(e){n[e]&&(a--,delete n[e],0==a&&t.ticker&&t.ticker.$stopTick(i,null))}function i(t){var e=t-s;s=t;for(var i in n){var o=i,a=n[o];a.delay-=e,a.delay<=0&&(r(o),a.listener.apply(a.thisObject,a.params))}return!1}var n={},o=0,a=0,s=0;t.setTimeout=e,t.clearTimeout=r}(egret||(egret={})),!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ES6Promise=e()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function r(t){Y=t}function i(t){V=t}function n(){return function(){return process.nextTick(h)}}function o(){return"undefined"!=typeof X?function(){X(h)}:c()}function a(){var t=0,e=new K(h),r=document.createTextNode("");return e.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}function s(){var t=new MessageChannel;return t.port1.onmessage=h,function(){return t.port2.postMessage(0)}}function c(){var t=setTimeout;return function(){return t(h,1)}}function h(){for(var t=0;G>t;t+=2){var e=Z[t],r=Z[t+1];e(r),Z[t]=void 0,Z[t+1]=void 0}G=0}function u(){try{var t=require,e=t("vertx");return X=e.runOnLoop||e.runOnContext,o()}catch(r){return c()}}function l(t,e){var r=arguments,i=this,n=new this.constructor(d);void 0===n[ee]&&L(n);var o=i._state;return o?!function(){var t=r[o-1];V(function(){return C(o,n,t,i._result)})}():w(i,n,t,e),n}function p(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var r=new e(d);return _(r,t),r}function d(){}function f(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function v(t){try{return t.then}catch(e){return oe.error=e,oe}}function y(t,e,r,i){try{t.call(e,r,i)}catch(n){return n}}function m(t,e,r){V(function(t){var i=!1,n=y(r,e,function(r){i||(i=!0,e!==r?_(t,r):T(t,r))},function(e){i||(i=!0,E(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&n&&(i=!0,E(t,n))},t)}function $(t,e){e._state===ie?T(t,e._result):e._state===ne?E(t,e._result):w(e,void 0,function(e){return _(t,e)},function(e){return E(t,e)})}function b(t,r,i){r.constructor===t.constructor&&i===l&&r.constructor.resolve===p?$(t,r):i===oe?E(t,oe.error):void 0===i?T(t,r):e(i)?m(t,r,i):T(t,r)}function _(e,r){e===r?E(e,f()):t(r)?b(e,r,v(r)):T(e,r)}function x(t){t._onerror&&t._onerror(t._result),S(t)}function T(t,e){t._state===re&&(t._result=e,t._state=ie,0!==t._subscribers.length&&V(S,t))}function E(t,e){t._state===re&&(t._state=ne,t._result=e,V(x,t))}function w(t,e,r,i){var n=t._subscribers,o=n.length;t._onerror=null,n[o]=e,n[o+ie]=r,n[o+ne]=i,0===o&&t._state&&V(S,t)}function S(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var i=void 0,n=void 0,o=t._result,a=0;a<e.length;a+=3)i=e[a],n=e[a+r],i?C(r,i,n,o):n(o);t._subscribers.length=0}}function D(){this.error=null
}function R(t,e){try{return t(e)}catch(r){return ae.error=r,ae}}function C(t,r,i,n){var o=e(i),a=void 0,s=void 0,c=void 0,h=void 0;if(o){if(a=R(i,n),a===ae?(h=!0,s=a.error,a=null):c=!0,r===a)return void E(r,g())}else a=n,c=!0;r._state!==re||(o&&c?_(r,a):h?E(r,s):t===ie?T(r,a):t===ne&&E(r,a))}function P(t,e){try{e(function(e){_(t,e)},function(e){E(t,e)})}catch(r){E(t,r)}}function O(){return se++}function L(t){t[ee]=se++,t._state=void 0,t._result=void 0,t._subscribers=[]}function M(t,e){this._instanceConstructor=t,this.promise=new t(d),this.promise[ee]||L(this.promise),W(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?T(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&T(this.promise,this._result))):E(this.promise,A())}function A(){return new Error("Array Methods must be provided an Array")}function I(t){return new M(this,t).promise}function F(t){var e=this;return new e(W(t)?function(r,i){for(var n=t.length,o=0;n>o;o++)e.resolve(t[o]).then(r,i)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function B(t){var e=this,r=new e(d);return E(r,t),r}function k(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function N(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function j(t){this[ee]=O(),this._result=this._state=void 0,this._subscribers=[],d!==t&&("function"!=typeof t&&k(),this instanceof j?P(this,t):N())}function U(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var r=t.Promise;if("undefined"!=typeof egret_native&&egret_native.capability&&!egret_native.capability("Promise")&&(r=void 0),r){var i=null;try{i=Object.prototype.toString.call(r.resolve())}catch(e){}if("[object Promise]"===i&&!r.cast)return}t.Promise=j}var H=void 0;H=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var W=H,G=0,X=void 0,Y=void 0,V=function(t,e){Z[G]=t,Z[G+1]=e,G+=2,2===G&&(Y?Y(h):te())},z="undefined"!=typeof window?window:void 0,q=z||{},K=q.MutationObserver||q.WebKitMutationObserver,Q="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),J="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Z=new Array(1e3),te=void 0;te=Q?n():K?a():J?s():void 0===z&&"function"==typeof require?u():c();var ee=Math.random().toString(36).substring(16),re=void 0,ie=1,ne=2,oe=new D,ae=new D,se=0;return M.prototype._enumerate=function(){for(var t=this.length,e=this._input,r=0;this._state===re&&t>r;r++)this._eachEntry(e[r],r)},M.prototype._eachEntry=function(t,e){var r=this._instanceConstructor,i=r.resolve;if(i===p){var n=v(t);if(n===l&&t._state!==re)this._settledAt(t._state,e,t._result);else if("function"!=typeof n)this._remaining--,this._result[e]=t;else if(r===j){var o=new r(d);b(o,t,n),this._willSettleAt(o,e)}else this._willSettleAt(new r(function(e){return e(t)}),e)}else this._willSettleAt(i(t),e)},M.prototype._settledAt=function(t,e,r){var i=this.promise;i._state===re&&(this._remaining--,t===ne?E(i,r):this._result[e]=r),0===this._remaining&&T(i,this._result)},M.prototype._willSettleAt=function(t,e){var r=this;w(t,void 0,function(t){return r._settledAt(ie,e,t)},function(t){return r._settledAt(ne,e,t)})},j.all=I,j.race=F,j.resolve=p,j.reject=B,j._setScheduler=r,j._setAsap=i,j._asap=V,j.prototype={constructor:j,then:l,"catch":function(t){return this.then(null,t)}},j.polyfill=U,j.Promise=j,j}),ES6Promise.polyfill();