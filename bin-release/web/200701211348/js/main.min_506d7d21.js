var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,s)}c((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return o([t,e])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(o){n=[6,o],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},ys;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setContent=function(t,e,n){var o=new egret.ScrollView(t);o.width=e,o.height=n,o.horizontalScrollPolicy="off",this.sv=o,this.addChild(o),o.addEventListener(egret.TouchEvent.CHANGE,this.moveBar,this),this.sv=o,this.scrollW=e,this.scrollH=n,this.content=t,this.rec=new egret.Rectangle,t.height&&this.updateBar()},e.prototype.enableBar=function(t,e){this._enableBar=!0,this.size=e,this.barColor=t,this.bar||(this.bar=new egret.Shape,this.addChild(this.bar),this.content.height&&this.updateBar())},e.prototype.moveBar=function(){if(this._enableBar){var t=this.scrollH,e=t*this.sv.scrollTop/this.contentH,n=this.size,o=.5*n,r=this.rec;r.x=-o,r.y=-e-o,r.width=2*n,r.height=t,this.bar.scrollRect=r}this.onScroll()},e.prototype.onScroll=function(){},e.prototype.updateBar=function(){if(this.contentH=this.content.height,!(this.contentH<=0)){if(this._enableBar){var t=this.size,e=this.scrollH,n=this.scrollW,o=e*e/this.contentH-t,r=this.bar;r.visible=this.contentH>this.scrollH,r.graphics.lineStyle(t,this.barColor),r.graphics.moveTo(0,0),r.graphics.lineTo(0,o),this.addChild(r),r.x=n-t;var i=this.rec;i.x=.5*-t,i.y=.5*-t,i.width=2*t,i.height=e-t,r.scrollRect=i,r.cacheAsBitmap=!0}this.onScroll()}},e}(egret.DisplayObjectContainer);t.VScrollBar=e,__reflect(e.prototype,"ys.VScrollBar")}(ys||(ys={}));var ys;!function(t){var e=function(){function e(){}return e.prototype.getProxy=function(e){return t.MVC.GET.getProxy(e)},e.prototype.sendNotice=function(e,n){t.MVC.GET.sendNotice(e,n)},e.prototype.execute=function(t){},e}();t.NoticeCMD=e,__reflect(e.prototype,"ys.NoticeCMD")}(ys||(ys={}));var ys;!function(t){var e=function(){function e(e){this.name="Mediator",this._view=e,t.MVC.GET.evt.addEventListener(t.MVC.MVC_NOTICE,this._onNotice,this)}return e.prototype.getView=function(){return this._view},e.prototype._onNotice=function(e){var n=e.data.name;if(n){if("resize"==n){var o=this.getView();return void o.resize()}var r=this.listenNotice();if(-1!=r.indexOf(n)){var i=e.data.data,a=new t.Notice;a.name=n,a.data=i,console.log("["+this.name+"]:处理通知->",n,i),this.onNotice(a)}}},e.prototype.sendNotice=function(e,n){console.log("["+this.name+"]:发送通知->",e,n),t.MVC.GET.sendNotice(e,n)},e.prototype.getProxy=function(e){return t.MVC.GET.getProxy(e)},e.prototype.registerProxy=function(e){t.MVC.GET.registerProxy(e)},e.prototype.registerCommand=function(e){t.MVC.GET.registerCommand(e)},e.prototype.$addLogic=function(){this.addLogic()},e.prototype.addLogic=function(){},e.prototype.listenNotice=function(){return[]},e.prototype.onNotice=function(t){},e}();t.Mediator=e,__reflect(e.prototype,"ys.Mediator")}(ys||(ys={}));var ys;!function(t){var e=function(e){function n(t,n,o){void 0===n&&(n="");var r=e.call(this)||this;return""!=n?RES.isGroupLoaded(n)?r.resReady(t):!function(){return __awaiter(r,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,RES.loadGroup(n,1,o)];case 1:return e.sent(),this.resReady(t),[2]}})})}():r.resReady(t),r}return __extends(n,e),n.newBitmap=function(t){var e=new egret.Bitmap;return e.texture=RES.getRes(t),e},n.newContainer=function(){var t=new egret.DisplayObjectContainer;return t},n.newShape=function(){var t=new egret.Shape;return t},n.newTextInput=function(e,n){var o=new t.TextInput(e,n);return o},n.newLabel=function(){var e=new t.Label;return e},n.newImage=function(){var e=new t.Image;return e},n.newButton=function(e){var n=new t.Button(e);return n},n.newButtonMusic=function(e,n){var o=new t.ButtonMusic(e,n);return o},n.newRect=function(t,e,n){var o=new egret.Shape,r=o.graphics;return r.beginFill(n),r.drawRect(0,0,t,e),r.endFill(),o},n.newCircle=function(t,e){var n=new egret.Shape;return n.graphics.beginFill(e),n.graphics.drawCircle(0,0,t),n.graphics.endFill(),n},n.newRectRound=function(t,e,n,o,r){var i=new egret.Shape,a=i.graphics;return a.beginFill(n),a.drawRoundRect(0,0,t,e,o,r),a.endFill(),i},n.prototype.resReady=function(t){if(this.uiCreate(),t){var e=new t(this);e.$addLogic()}this.once(egret.Event.ADDED_TO_STAGE,this.resize,this)},n.prototype.resize=function(){stageW=stage.stageWidth,stageH=stage.stageHeight,stageHalfW=stageW>>1,stageHalfH=stageH>>1,this.uiLayout()},n.prototype.uiCreate=function(){},n.prototype.uiLayout=function(){},n}(egret.DisplayObjectContainer);t.View=e,__reflect(e.prototype,"ys.View")}(ys||(ys={}));var ys3d;!function(t){var e=0,n=function(){function n(){var n=this;this.parent=null,this.children=[],this.position=t.Vector3.create(),this.rotation=t.Euler.create(),this.quat=t.Quaternion.create(),this.scale=t.Vector3.create(1,1,1),this.type="Object3D",this.id=e++,this.visible=!1,this.matrix=t.Matrix4.create(),this.worldMatrix=t.Matrix4.create(),this.rotation.onChange=function(){n.quat.fromEuler(n.rotation)},this.rotation.set(0,0,0)}return n.prototype.updateMatrix=function(){var t=this.matrix,e=this.quat,n=this.position,o=this.scale;t.compose(e,n,o)},n.prototype.updateMatrixWorld=function(){this.updateMatrix(),this.parent?this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix):this.worldMatrix.copy(this.matrix),this.children.forEach(function(t){t.updateMatrixWorld()})},n.prototype.getChildIndex=function(t){return this.children.indexOf(t)},n.prototype.addChild=function(t){t.parent&&t.parent.removeChild(t);var e=this.getChildIndex(t);-1==e&&(t.parent=this,this.children.push(t))},n.prototype.removeChild=function(t){var e=this.getChildIndex(t);-1!=e&&(t.parent=null,this.children.splice(e,1))},n.prototype.traverse=function(t){t(this)||this.children.forEach(function(e){e.traverse(t)})},n}();t.Object3D=n,__reflect(n.prototype,"ys3d.Object3D")}(ys3d||(ys3d={}));var ys;!function(t){var e=function(){function e(){this.onCreate()}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.onCreate=function(){},e.prototype.sendNotice=function(e,n){t.MVC.GET.sendNotice(e,n)},e}();t.Proxy=e,__reflect(e.prototype,"ys.Proxy")}(ys||(ys={}));var ys;!function(t){var e=function(t){function e(e,n){var o=t.call(this)||this,r=new egret.DisplayObjectContainer;return o.setContent(r,e,n),o.index=0,o.lastY=0,o.itemsCon=r,o.pt=new egret.Point,r.addEventListener(egret.TouchEvent.TOUCH_TAP,o.tapItem,o),o.once(egret.Event.REMOVED_FROM_STAGE,function(){r.removeEventListener(egret.TouchEvent.TOUCH_TAP,o.tapItem,o)},o),o}return __extends(e,t),e.prototype.tapItem=function(t){var n=t.target;this.dispatchEventWith(e.ITEM_SELECTED,!1,n)},e.prototype.addItem=function(t){t.y=this.lastY,t.render(),this.itemsCon.addChild(t),t.visible=!1,t.touchEnabled=!0,this.lastY+=t.itemH,t.index=this.index,this.index++},e.prototype.getItem=function(t){for(var e,n=this.itemsCon,o=n.numChildren;o--&&(e=n.getChildAt(o),e.index!=t);)e=null;return e},e.prototype.onScroll=function(){for(var t=this.itemsCon,e=t.numChildren;e--;){var n=t.getChildAt(e),o=n.localToGlobal(0,0,this.pt);o=this.globalToLocal(o.x,o.y,this.pt),o.y<-n.itemH||o.y>this.scrollH?n.visible=!1:n.visible=!0}},e.ITEM_SELECTED="item_selected",e}(t.VScrollBar);t.List=e,__reflect(e.prototype,"ys.List");var n=function(t){function e(e){var n=t.call(this)||this;return n.data=e,n.onCreate(),n}return __extends(e,t),e.prototype.onCreate=function(){},Object.defineProperty(e.prototype,"itemH",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.render=function(){},e}(egret.DisplayObjectContainer);t.ListItem=n,__reflect(n.prototype,"ys.ListItem")}(ys||(ys={}));var ys3d;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.visible=!0,n.worldPosition=new t.Vector4,n}return __extends(n,e),Object.defineProperty(n.prototype,"display",{get:function(){return this.$display},enumerable:!0,configurable:!0}),n.prototype.draw=function(t,e){},n.prototype.mvp=function(t,e){e=this.worldMatrix.transformV4(e),e=t.viewMatrix.transformV4(e),e=t.projectionMatrix.transformV4(e)},n}(t.Object3D);t.RenderNode=e,__reflect(e.prototype,"ys3d.RenderNode")}(ys3d||(ys3d={}));var Application=function(t){function e(n,o){var r=this;return window.VConsole&&new window.VConsole,console.log("与时互动 "+e.VERSION+" by niko@bytesuns.com"),r=t.call(this,ApplicationMediator)||this,r.cfg=n,r.loading=o,r}return __extends(e,t),e.prototype.uiCreate=function(){},e.prototype.uiLayout=function(){},e.VERSION="2020-05-28",e}(ys.View);__reflect(Application.prototype,"Application");var ApplicationMediator=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.addLogic=function(){var t=this,e=this.getView();egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){},egret.lifecycle.onResume=function(){},e.once(egret.Event.ADDED_TO_STAGE,function(){var n=e.cfg;if(ys.Ajax.mock=n.mock,n.proxy&&n.proxy.forEach(function(e){t.registerProxy(e)}),n.command&&n.command.forEach(function(e){t.registerCommand(e)}),GG.setup(e,n)){RES.registerVersionController(new ys.VersionController(n.versionFun));var o=e.loading;o.onReady(),GG.Loader.setRespath(n.resourceRoot),GG.Loader.setup(function(){return __awaiter(t,void 0,void 0,function(){var t,r;return __generator(this,function(i){switch(i.label){case 0:if(t=0,r=e.cfg.groups.length,!r)return[3,4];i.label=1;case 1:return r>t?[4,GG.Loader.loadGroup(n.groups[t],o)]:[3,3];case 2:return i.sent(),t++,[3,1];case 3:return[3,5];case 4:o.onLoaded(""),i.label=5;case 5:return[2]}})})},t,n.resourceJSON),stage.addEventListener(egret.Event.RESIZE,function(){t.sendNotice("resize")},t)}},this)},e.prototype.listenNotice=function(){return[]},e.prototype.onNotice=function(t){var e=t.name;console.log(e);this.getView()},e}(ys.Mediator);__reflect(ApplicationMediator.prototype,"ApplicationMediator");var TestCMD=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.execute=function(t){},e}(ys.NoticeCMD);__reflect(TestCMD.prototype,"TestCMD");var Config=function(){function t(){this.fps=60}return t}();__reflect(Config.prototype,"Config");var ys;!function(t){var e=function(){function t(){}return t.prototype.onReady=function(){},t.prototype.onStart=function(t){},t.prototype.onProgress=function(t,e,n){},t.prototype.onLoaded=function(t){},t}();t.LoadingReporter=e,__reflect(e.prototype,"ys.LoadingReporter",["RES.PromiseTaskReporter"])}(ys||(ys={}));var ys3d;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type="Group",e.visible=!0,e}return __extends(e,t),e}(t.Object3D);t.Group=e,__reflect(e.prototype,"ys3d.Group")}(ys3d||(ys3d={}));var ys;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.verticalAlign=egret.VerticalAlign.MIDDLE,e}return __extends(e,t),Object.defineProperty(e.prototype,"text",{set:function(n){n=e.getLocale(n),t.prototype.$setText.call(this,n)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"html",{set:function(t){t=e.getLocale(t),this.textFlow=(new egret.HtmlTextParser).parser(t)},enumerable:!0,configurable:!0}),e.getLocale=function(t){return console.log("key:",t,"value:",t),t},e}(egret.TextField);t.Label=e,__reflect(e.prototype,"ys.Label")}(ys||(ys={}));var ys3d;!function(t){var e=function(){function t(){}return Object.defineProperty(t.prototype,"vertices",{get:function(){return this._vertices.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"indices",{get:function(){return this._indices},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uvs",{get:function(){return this._uvs},enumerable:!0,configurable:!0}),t}();t.Geometry=e,__reflect(e.prototype,"ys3d.Geometry")}(ys3d||(ys3d={}));var ys3d;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return Object.setPrototypeOf(t,n.prototype),t}return __extends(n,e),n.prototype.translate=function(t){n.translate(this,this,t)},n.prototype.rotate=function(t,e){n.rotate(this,this,t,e)},n.prototype.scale=function(t){n.scale(this,this,t)},n.prototype.identity=function(){n.identity(this)},n.prototype.inverse=function(){n.invert(this,this)},n.prototype.compose=function(t,e,o){n.composeRotationTranslationScale(this,t,e,o)},n.prototype.copy=function(t){n.copy(this,t)},n.prototype.fromPerspective=function(t,e,o,r){t*=Math.PI/180,n.perspective(this,t,e,o,r)},n.prototype.fromOrthogonal=function(t,e,o,r,i,a){n.ortho(this,t,e,o,r,i,a)},n.prototype.fromQuaternion=function(t){n.fromQuaternion(this,t)},n.prototype.multiply=function(t,e){e?n.multiply(this,t,e):n.multiply(this,this,t)},n.prototype.lookAt=function(t,e,o){n.lookAt(this,t,e,o)},n.prototype.transformV4=function(t){return n.transformVector4(t,t,this),t},n.prototype.transformV3=function(t){return n.transformVector3(t,t,this),t},n.prototype.getRotation=function(t){n.getRotation(t,this)},n.create=function(){var t=new n;return n.identity(t),t},n.copy=function(t,e){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]},n.set=function(t,e,n,o,r,i,a,s,c,u,l,p,h,d,f,y,v){t[0]=e,t[1]=n,t[2]=o,t[3]=r,t[4]=i,t[5]=a,t[6]=s,t[7]=c,t[8]=u,t[9]=l,t[10]=p,t[11]=h,t[12]=d,t[13]=f,t[14]=y,t[15]=v},n.identity=function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1},n.transpose=function(t,e){if(t===e){var n=e[1],o=e[2],r=e[3],i=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=o,t[9]=i,t[11]=e[14],t[12]=r,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]},n.invert=function(t,e){var n=e[0],o=e[1],r=e[2],i=e[3],a=e[4],s=e[5],c=e[6],u=e[7],l=e[8],p=e[9],h=e[10],d=e[11],f=e[12],y=e[13],v=e[14],g=e[15],m=n*s-o*a,x=n*c-r*a,_=n*u-i*a,w=o*c-r*s,b=o*u-i*s,C=r*u-i*c,M=l*y-p*f,T=l*v-h*f,E=l*g-d*f,O=p*v-h*y,L=p*g-d*y,S=h*g-d*v,P=m*S-x*L+_*O+w*E-b*T+C*M;P&&(P=1/P,t[0]=(s*S-c*L+u*O)*P,t[1]=(r*L-o*S-i*O)*P,t[2]=(y*C-v*b+g*w)*P,t[3]=(h*b-p*C-d*w)*P,t[4]=(c*E-a*S-u*T)*P,t[5]=(n*S-r*E+i*T)*P,t[6]=(v*_-f*C-g*x)*P,t[7]=(l*C-h*_+d*x)*P,t[8]=(a*L-s*E+u*M)*P,t[9]=(o*E-n*L-i*M)*P,t[10]=(f*b-y*_+g*m)*P,t[11]=(p*_-l*b-d*m)*P,t[12]=(s*T-a*O-c*M)*P,t[13]=(n*O-o*T+r*M)*P,t[14]=(y*x-f*w-v*m)*P,t[15]=(l*w-p*x+h*m)*P)},n.multiply=function(t,e,n){var o=e[0],r=e[1],i=e[2],a=e[3],s=e[4],c=e[5],u=e[6],l=e[7],p=e[8],h=e[9],d=e[10],f=e[11],y=e[12],v=e[13],g=e[14],m=e[15],x=n[0],_=n[1],w=n[2],b=n[3];t[0]=x*o+_*s+w*p+b*y,t[1]=x*r+_*c+w*h+b*v,t[2]=x*i+_*u+w*d+b*g,t[3]=x*a+_*l+w*f+b*m,x=n[4],_=n[5],w=n[6],b=n[7],t[4]=x*o+_*s+w*p+b*y,t[5]=x*r+_*c+w*h+b*v,t[6]=x*i+_*u+w*d+b*g,t[7]=x*a+_*l+w*f+b*m,x=n[8],_=n[9],w=n[10],b=n[11],t[8]=x*o+_*s+w*p+b*y,t[9]=x*r+_*c+w*h+b*v,t[10]=x*i+_*u+w*d+b*g,t[11]=x*a+_*l+w*f+b*m,x=n[12],_=n[13],w=n[14],b=n[15],t[12]=x*o+_*s+w*p+b*y,t[13]=x*r+_*c+w*h+b*v,t[14]=x*i+_*u+w*d+b*g,t[15]=x*a+_*l+w*f+b*m},n.translate=function(t,e,n){var o,r,i,a,s,c,u,l,p,h,d,f,y=n[0],v=n[1],g=n[2];e===t?(t[12]=e[0]*y+e[4]*v+e[8]*g+e[12],t[13]=e[1]*y+e[5]*v+e[9]*g+e[13],t[14]=e[2]*y+e[6]*v+e[10]*g+e[14],t[15]=e[3]*y+e[7]*v+e[11]*g+e[15]):(o=e[0],r=e[1],i=e[2],a=e[3],s=e[4],c=e[5],u=e[6],l=e[7],p=e[8],h=e[9],d=e[10],f=e[11],t[0]=o,t[1]=r,t[2]=i,t[3]=a,t[4]=s,t[5]=c,t[6]=u,t[7]=l,t[8]=p,t[9]=h,t[10]=d,t[11]=f,t[12]=o*y+s*v+p*g+e[12],t[13]=r*y+c*v+h*g+e[13],t[14]=i*y+u*v+d*g+e[14],t[15]=a*y+l*v+f*g+e[15])},n.scale=function(t,e,n){var o=n[0],r=n[1],i=n[2];t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]},n.rotate=function(e,n,o,r){var i,a,s,c,u,l,p,h,d,f,y,v,g,m,x,_,w,b,C,M,T,E,O,L,S=r[0],P=r[1],V=r[2],G=t.math.hypot(S,P,V);Math.abs(G)<t.EPSILON||(G=1/G,S*=G,P*=G,V*=G,i=Math.sin(o),a=Math.cos(o),s=1-a,c=n[0],u=n[1],l=n[2],p=n[3],h=n[4],d=n[5],f=n[6],y=n[7],v=n[8],g=n[9],m=n[10],x=n[11],_=S*S*s+a,w=P*S*s+V*i,b=V*S*s-P*i,C=S*P*s-V*i,M=P*P*s+a,T=V*P*s+S*i,E=S*V*s+P*i,O=P*V*s-S*i,L=V*V*s+a,e[0]=c*_+h*w+v*b,e[1]=u*_+d*w+g*b,e[2]=l*_+f*w+m*b,e[3]=p*_+y*w+x*b,e[4]=c*C+h*M+v*T,e[5]=u*C+d*M+g*T,e[6]=l*C+f*M+m*T,e[7]=p*C+y*M+x*T,e[8]=c*E+h*O+v*L,e[9]=u*E+d*O+g*L,e[10]=l*E+f*O+m*L,e[11]=p*E+y*O+x*L,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]))},n.composeRotationTranslationScale=function(t,e,n,o){var r=e[0],i=e[1],a=e[2],s=e[3],c=r+r,u=i+i,l=a+a,p=r*c,h=r*u,d=r*l,f=i*u,y=i*l,v=a*l,g=s*c,m=s*u,x=s*l,_=o[0],w=o[1],b=o[2];t[0]=(1-(f+v))*_,t[1]=(h+x)*_,t[2]=(d-m)*_,t[3]=0,t[4]=(h-x)*w,t[5]=(1-(p+v))*w,t[6]=(y+g)*w,t[7]=0,t[8]=(d+m)*b,t[9]=(y-g)*b,t[10]=(1-(p+f))*b,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1},n.getTranslation=function(t,e){t[0]=e[12],t[1]=e[13],t[2]=e[14]},n.getScaling=function(e,n){var o=n[0],r=n[1],i=n[2],a=n[4],s=n[5],c=n[6],u=n[8],l=n[9],p=n[10];e[0]=t.math.hypot(o,r,i),e[1]=t.math.hypot(a,s,c),e[2]=t.math.hypot(u,l,p)},n.getRotation=function(e,o){var r=t.Vector3.create();n.getScaling(r,o);var i=1/r[0],a=1/r[1],s=1/r[2],c=o[0]*i,u=o[1]*a,l=o[2]*s,p=o[4]*i,h=o[5]*a,d=o[6]*s,f=o[8]*i,y=o[9]*a,v=o[10]*s,g=c+h+v,m=0;g>0?(m=2*Math.sqrt(g+1),e[3]=.25*m,e[0]=(d-y)/m,e[1]=(f-l)/m,e[2]=(u-p)/m):c>h&&c>v?(m=2*Math.sqrt(1+c-h-v),e[3]=(d-y)/m,e[0]=.25*m,e[1]=(u+p)/m,e[2]=(f+l)/m):h>v?(m=2*Math.sqrt(1+h-c-v),e[3]=(f-l)/m,e[0]=(u+p)/m,e[1]=.25*m,e[2]=(d+y)/m):(m=2*Math.sqrt(1+v-c-h),e[3]=(u-p)/m,e[0]=(f+l)/m,e[1]=(d+y)/m,e[2]=.25*m)},n.fromQuaternion=function(t,e){var n=e[0],o=e[1],r=e[2],i=e[3],a=n+n,s=o+o,c=r+r,u=n*a,l=o*a,p=o*s,h=r*a,d=r*s,f=r*c,y=i*a,v=i*s,g=i*c;t[0]=1-p-f,t[1]=l+g,t[2]=h-v,t[3]=0,t[4]=l-g,t[5]=1-u-f,t[6]=d+y,t[7]=0,t[8]=h+v,t[9]=d-y,t[10]=1-u-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1},n.perspective=function(t,e,n,o,r){if(void 0===o&&(o=.1),void 0===r&&(r=2e3),o===r||0===n)throw"null frustum";if(0>=o)throw"near <= 0";if(0>=r)throw"far <= 0";var i=1/Math.tan(e/2),a=1/(o-r);t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+o)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*o*a,t[15]=0},n.ortho=function(t,e,n,o,r,i,a){void 0===i&&(i=.1),void 0===a&&(a=2e3);var s=1/(e-n),c=1/(o-r),u=1/(i-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(r+o)*c,t[14]=(a+i)*u,t[15]=1},n.lookAt=function(t,e,n,o){var r=e[0],i=e[1],a=e[2],s=o[0],c=o[1],u=o[2],l=r-n[0],p=i-n[1],h=a-n[2],d=l*l+p*p+h*h;0===d?h=1:(d=1/Math.sqrt(d),l*=d,p*=d,h*=d);var f=c*h-u*p,y=u*l-s*h,v=s*p-c*l;d=f*f+y*y+v*v,0===d&&(u?s+=1e-6:c?u+=1e-6:c+=1e-6,f=c*h-u*p,y=u*l-s*h,v=s*p-c*l,d=f*f+y*y+v*v),d=1/Math.sqrt(d),f*=d,y*=d,v*=d,t[0]=f,t[1]=y,t[2]=v,t[3]=0,t[4]=p*v-h*y,t[5]=h*f-l*v,t[6]=l*y-p*f,t[7]=0,t[8]=l,t[9]=p,t[10]=h,t[11]=0,t[12]=r,t[13]=i,t[14]=a,t[15]=1},n.transformVector4=function(t,e,n){var o=e[0],r=e[1],i=e[2];t[0]=n[0]*o+n[4]*r+n[8]*i+n[12],t[1]=n[1]*o+n[5]*r+n[9]*i+n[13],t[2]=n[2]*o+n[6]*r+n[10]*i+n[14];var a=n[3]*o+n[7]*r+n[11]*i+n[15];t[3]=a},n.transformVector3=function(t,e,n){var o=e[0],r=e[1],i=e[2],a=n[3]*o+n[7]*r+n[11]*i+n[15];a=a||1,t[0]=(n[0]*o+n[4]*r+n[8]*i+n[12])/a,t[1]=(n[1]*o+n[5]*r+n[9]*i+n[13])/a,t[2]=(n[2]*o+n[6]*r+n[10]*i+n[14])/a},n}(Array);t.Matrix4=e,__reflect(e.prototype,"ys3d.Matrix4")}(ys3d||(ys3d={}));var ys3d;!function(t){var e=function(t){function e(){var n=t.call(this)||this;return Object.setPrototypeOf(n,e.prototype),n[0]=0,n[1]=0,n[2]=0,n}return __extends(e,t),e.prototype.set=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this[0]=t,this[1]=e,this[2]=n},Object.defineProperty(e.prototype,"x",{get:function(){return this[0]},set:function(t){this[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this[1]},set:function(t){this[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this[2]},set:function(t){this[2]=t},enumerable:!0,configurable:!0}),e.prototype.add=function(t){e.add(this,this,t)},e.prototype.subtract=function(t){e.subtract(this,this,t)},e.prototype.scale=function(t){e.scale(this,this,t)},e.prototype.getLength=function(){return e.getLength(this)},e.prototype.dot=function(t){return e.dot(this,t)},e.prototype.cross=function(t){e.cross(this,this,t)},e.create=function(t,n,o){void 0===t&&(t=0),void 0===n&&(n=0),void 0===o&&(o=0);var r=new e;return r[0]=t,r[1]=n,r[2]=o,r},e.add=function(t,e,n){t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2]},e.subtract=function(t,e,n){t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2]},e.scale=function(t,e,n){t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n},e.distance=function(t,e){var n=e[0]-t[0],o=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+o*o+r*r)},e.getLength=function(t){var e=t[0],n=t[1],o=t[2];return Math.sqrt(e*e+n*n+o*o)},e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.normalize=function(t,e){var n=e[0],o=e[1],r=e[2],i=n*n+o*o+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},e.cross=function(t,e,n){var o=e[0],r=e[1],i=e[2],a=n[0],s=n[1],c=n[2];t[0]=r*c-i*s,t[1]=i*a-o*c,t[2]=o*s-r*a},e.lerp=function(t,e,n,o){var r=e[0],i=e[1],a=e[2];t[0]=r+o*(n[0]-r),t[1]=i+o*(n[1]-i),t[2]=a+o*(n[2]-a)},e}(Array);t.Vector3=e,__reflect(e.prototype,"ys3d.Vector3")}(ys3d||(ys3d={}));var ys3d;!function(t){var e=function(t){function e(){var n=t.call(this)||this;return Object.setPrototypeOf(n,e.prototype),n.set(0,0,0,1),n}return __extends(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this[0]},set:function(t){this[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this[1]},set:function(t){this[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this[2]},set:function(t){this[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this[3]},set:function(t){this[3]=t},enumerable:!0,configurable:!0}),e.prototype.getLength=function(){var t=this,e=t[0],n=t[1],o=t[2],r=t[3];return Math.sqrt(e*e+n*n+o*o+r*r)},e.prototype.copy=function(t){this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3]},e.prototype.set=function(t,e,n,o){this[0]=t,this[1]=e,this[2]=n,this[3]=o},e.create=function(t,n,o,r){void 0===t&&(t=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=1);var i=new e;return i[0]=t,i[1]=n,i[2]=o,i[3]=r,i},e}(Array);t.Vector4=e,__reflect(e.prototype,"ys3d.Vector4")}(ys3d||(ys3d={}));var ys;!function(t){var e=function(){function e(){var n=this;this.evt=new egret.EventDispatcher,this.proxy={},this.commands={},this.evt.addEventListener(e.MVC_NOTICE,function(e){var o=e.data.name,r=e.data.data,i=n.commands[o];if(i){console.log("[MVC]:执行通知指令->",o);var a=new i,s=new t.Notice;s.name=o,s.data=r,a.execute(s)}},this)}return Object.defineProperty(e,"GET",{get:function(){return e.instance||(e.instance=new e),e.instance},enumerable:!0,configurable:!0}),e.prototype.sendNotice=function(t,n){this.evt.dispatchEventWith(e.MVC_NOTICE,!1,{name:t,data:n})},e.prototype.registerProxy=function(t){var e=egret.getQualifiedClassName(t);this.proxy[e]||(this.proxy[e]=new t)},e.prototype.removeProxy=function(t){var e=egret.getQualifiedClassName(t);this.proxy[e]=null,delete this.proxy[e]},e.prototype.getProxy=function(t){var e=egret.getQualifiedClassName(t);return this.proxy[e]},e.prototype.registerCommand=function(t){var e=egret.getQualifiedClassName(t);this.commands[e]||(this.commands[e]=t)},e.prototype.removeCommand=function(t){this.commands[t]=null,delete this.commands[t]},e.MVC_NOTICE="on_mvc_notice",e}();t.MVC=e,__reflect(e.prototype,"ys.MVC")}(ys||(ys={}));var UItest=function(t){function e(){var e=t.call(this)||this,n=(GG.newRect(stageW,stageH,0,e),new ys.Label);n.text="常用组件示例",n.size=30,n.width=stageW,n.height=60,n.textAlign="center",n.textColor=0,n.background=!0,e.addChild(n),n.y=100;var o=new ys.TextInput(200,40);e.addChild(o),o.x=50,o.y=200,o.text="",o.placeholder="请输入姓名";var r=new ys.Label;r.html="<font color=0xffffff size=30 strokecolor=0xff0000 stroke=2>HTMl标签字</font>",e.addChild(r),r.x=300,r.y=200;var i=new ys.ProgressBar("progress-bg_png","progress-bar_png");e.addChild(i),i.x=50,i.y=300,i.progress=0,egret.Tween.get(i,{loop:!0}).to({progress:1},2e3);var a=new ys.ButtonMusic("music-on_png","music-off_png");e.addChild(a),a.enable(),a.x=50,a.y=400,a.autoPlayMusic("bg_mp3");var s=new ys.Button("btn-gray_png");s.x=200,s.y=400,s.touchEnabled=!0,s.setLabel("无点击效果无点击",25,16777215,100,0,-5),e.addChild(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GG.showModal("点击了按钮！")},e);var c=new ys.Button("btn-gray_png");c.x=500,c.y=400,c.touchEnabled=!0,c.effect=new TouchEffect,c.setLabel("有点击效果",25,16777215),e.addChild(c);var u=new ys.Label;u.width=300,u.height=700,u.text="测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试",u.lineSpacing=30,u.background=!0,u.backgroundColor=13421772;var l=new ys.VScrollBar;l.setContent(u,300,500),l.enableBar(16711680,6),e.addChild(l),l.x=50,l.y=550;for(var p=new ys.List(300,500),h=50;h--;){var d=new MyItem;p.addItem(d)}p.updateBar(),e.addChild(p),p.x=400,p.y=550,p.addEventListener(ys.List.ITEM_SELECTED,function(t){var e=t.data;console.log(e.index)},e);var f=new ys.Image;return f.src="resource/cha.png",e.addChild(f),f.x=50,f.y=1100,f.width=120,f.height=120,e}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(UItest.prototype,"UItest");var MyItem=function(t){function e(){return t.call(this,null)||this}return __extends(e,t),e.prototype.onCreate=function(){this.rec=GG.newRect(300,GG.randomInt(80,120),GG.randomInt(0,16777215),this)},Object.defineProperty(e.prototype,"itemH",{get:function(){return this.rec.height},enumerable:!0,configurable:!0}),e.prototype.render=function(){},e}(ys.ListItem);__reflect(MyItem.prototype,"MyItem");var TouchEffect=function(){function t(){}return t.prototype.onTouchBeginEffect=function(t){t.filters=[new egret.GlowFilter(16711680,1,5,5)]},t.prototype.onTouchEndEffect=function(t){t.filters=[]},t}();__reflect(TouchEffect.prototype,"TouchEffect",["ys.ButtonTouchEffect"]);var ys;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.setLabel=function(e,n,o,r,i,a){if(void 0===r&&(r=0),void 0===i&&(i=0),void 0===a&&(a=0),this.bg){this._label||(this._label=new t.Label,this.addChild(this._label));var s=this._label;s.text=e,s.textColor=o,s.size=n,s.width=s.textWidth,s.height=s.textHeight,s.textAlign="center",s.anchorOffsetX=.5*s.width,s.anchorOffsetY=.5*s.height;var c=1,u=this.bg.width-r;s.textWidth>u&&(c=u/s.textWidth),s.scaleX=s.scaleY=c,s.x=.5*this.bg.width+i,s.y=.5*this.bg.height+a,s.verticalAlign=egret.VerticalAlign.MIDDLE}this.cacheAsBitmap=!0},n}(egret.DisplayObjectContainer);__reflect(e.prototype,"ButtonBase");var n=function(t){function e(e){var n=t.call(this)||this,o=GG.newBitmap(e,n);return n.bg=o,n}return __extends(e,t),e.prototype.setSize=function(t,e){var n=this.bg;0!=t&&(n.width=t,e&&(n.scale9Grid=e))},Object.defineProperty(e.prototype,"effect",{set:function(t){t?this.enableEffect():this.removeEffect(),this._touchEffect=t},enumerable:!0,configurable:!0}),e.prototype.enableEffect=function(){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.checkEffect,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.checkEffect,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.checkEffect,this)},e.prototype.removeEffect=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.checkEffect,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.checkEffect,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.checkEffect,this)},e.prototype.checkEffect=function(t){var e=this._touchEffect;if(e){var n=t.type;switch(n){case egret.TouchEvent.TOUCH_BEGIN:e.onTouchBeginEffect(this);break;default:e.onTouchEndEffect(this)}}},e}(e);t.Button=n,__reflect(n.prototype,"ys.Button")}(ys||(ys={}));var ys;!function(t){var e=function(t){function e(e,n){var o=t.call(this)||this;return o.res=[e,n],o.on=!0,o}return __extends(e,t),e.prototype.enable=function(){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.checkSwitch,this)},e.prototype.disable=function(){this.touchEnabled=!1,this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.checkSwitch,this)},e.prototype.checkSwitch=function(){this.on=!this.on},Object.defineProperty(e.prototype,"on",{get:function(){return this._on},set:function(t){this._on=t,t?(this.texture=RES.getRes(this.res[0]),this.onSwitch(0)):(this.texture=RES.getRes(this.res[1]),this.onSwitch(1))},enumerable:!0,configurable:!0}),e.prototype.onSwitch=function(t){},e}(egret.Bitmap);__reflect(e.prototype,"ButtonSwitch");var n=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.mp3="",o.on=!1,o}return __extends(e,t),Object.defineProperty(e.prototype,"mute",{get:function(){return this._mute},set:function(t){this._mute=t,t?this.stopMusic():""!=this.mp3&&this.playMusic(this.mp3)},enumerable:!0,configurable:!0}),e.prototype.onSwitch=function(t){this.mute=t},e.prototype.stopMusic=function(){this.sc&&(this.sc.stop(),this.sc=null)},e.prototype.playMusic=function(t){if(this.stopMusic(),this.mp3=t,!this._mute){var e=RES.getRes(t);e&&(this.sc=e.play())}},e.prototype.autoPlayMusic=function(t){var e=this;window.WeixinJSBridge?window.WeixinJSBridge.invoke("getNetworkType",{},function(){e.playMusic(t)}):window.WeiboJSBridge?window.WeiboJSBridge.invoke("getNetworkType",{},function(){e.playMusic(t)}):window.AlipayJSBridge?window.AlipayJSBridge.call("getNetworkType",function(e){this.playMusic(t)}):window.mqq?document.addEventListener("DOMContentLoaded",function(){this.playMusic(t)},!1):this.playMusic(t)},e.prototype.playSFX=function(t){if(!this._mute){var e=RES.getRes(t);e&&e.play(0,1)}},e}(e);t.ButtonMusic=n,__reflect(n.prototype,"ys.ButtonMusic")}(ys||(ys={}));var ys;!function(t){var e=function(e){function o(t,o,r){void 0===r&&(r=!1);var i=e.call(this)||this;i.iconsCon=new egret.DisplayObjectContainer,i.addChild(i.iconsCon);for(var a=0,s=t.length;s>a;){var c=new n(t[a]);a>0&&(c.x=o*a),c.index=a,c.touchEnabled=!0,i.iconsCon.addChild(c),a++}return i.space=o,i.loop=r,i.updateScale(),i.index=0,i.checkSelect(),i.addEventListener(egret.Event.ADDED_TO_STAGE,function(){i.addEventListener(egret.TouchEvent.TOUCH_TAP,i.checkTap,i)},i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){i.removeEventListener(egret.TouchEvent.TOUCH_TAP,i.checkTap,i)
},i),i}return __extends(o,e),o.prototype.checkTap=function(e){var n=e.target,o=this.getMoveIndex(n);this._moveIndex=o,this.dispatchEventWith(t.IconSelect.CLICK_ONE,!1,{moveIndex:o})},Object.defineProperty(o.prototype,"selectIndex",{get:function(){for(var t=this.iconsCon.numChildren,e=0;t--;){var n=this.iconsCon.getChildAt(t),o=n.localToGlobal();if(o=this.globalToLocal(o.x,o.y),0==o.x){e=n.index;break}}return e},enumerable:!0,configurable:!0}),o.prototype.checkSelect=function(){for(var e=this.iconsCon.numChildren,n=0;e--;){var o=this.iconsCon.getChildAt(e),r=o.localToGlobal();if(r=this.globalToLocal(r.x,r.y),0==r.x){n=o.index;break}}this.dispatchEventWith(t.IconSelect.SELECT_ONE,!1,{index:n})},o.prototype.checkLoop=function(t){for(var e=this.iconsCon.numChildren,n=this.space*this.iconsCon.numChildren;e--;){var o=this.iconsCon.getChildAt(e),r=o.localToGlobal();r=this.globalToLocal(r.x,r.y),0>t?r.x<-this.space&&(o.x+=n):t>0&&r.x>=n-this.space&&(o.x-=n)}},o.prototype.getMoveIndex=function(t){var e=(this.iconsCon.numChildren,t.localToGlobal());return e=this.globalToLocal(e.x,e.y),Math.floor(e.x/this.space)},Object.defineProperty(o.prototype,"moveIndex",{get:function(){return this._moveIndex},enumerable:!0,configurable:!0}),o.prototype.move=function(e,n){var o=this;void 0===n&&(n=0);var r=this.index;r+=e,(this.loop||!(r<-this.iconsCon.numChildren+1||r>0))&&(this.isTween||(this.dispatchEventWith(t.IconSelect.MOVE_START),this.index=r,this.isTween=!0,egret.Tween.get(this.iconsCon,{onChange:function(){o.updateScale()}}).to({x:this.iconsCon.x+e*this.space},n).call(function(){o.isTween=!1,o.checkSelect(),o.loop&&o.checkLoop(e)})))},o.prototype.updateScale=function(){for(var t=this.iconsCon.numChildren;t--;){var e=this.iconsCon.getChildAt(t),n=e.localToGlobal();n=this.globalToLocal(n.x,n.y);var r=(1-Math.abs(n.x)/this.space)*(o.scale-1)+1;1>r&&(r=1),e.scaleX=e.scaleY=r}},o.scale=1.2,o.SELECT_ONE="select_one_icon",o.CLICK_ONE="click_one_icon",o.MOVE_START="icon_move_start",o}(egret.DisplayObjectContainer);t.IconSelect=e,__reflect(e.prototype,"ys.IconSelect");var n=function(t){function e(e){var n=t.call(this)||this,o=new egret.Bitmap(RES.getRes(e));return o.anchorOffsetX=.5*o.width,o.anchorOffsetY=.5*o.height,n.addChild(o),n.width=o.width,n.height=o.height,n}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(n.prototype,"Icon")}(ys||(ys={}));var ys;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._src="",e}return __extends(e,t),Object.defineProperty(e.prototype,"src",{get:function(){return this._src},set:function(t){var e=this;this._src=t,RES.getResByUrl(t,function(t){e.texture=t},this,RES.ResourceItem.TYPE_IMAGE)},enumerable:!0,configurable:!0}),e}(egret.Bitmap);t.Image=e,__reflect(e.prototype,"ys.Image")}(ys||(ys={}));var LoadingUI=function(t){function e(){var e=t.call(this)||this,n=GG.newRect(stageW,stageH,0);return e.addChild(n),e.label=GG.newLabel(16777215,30,e),e.label.textAlign="center",e.label.width=stageW,e.label.y=stageHalfH,e}return __extends(e,t),e.prototype.onLoaded=function(t){},e.prototype.onProgress=function(t,e){var n=100*t/e;this.label.text="Loading "+n.toFixed()+"%"},e}(egret.DisplayObjectContainer);__reflect(LoadingUI.prototype,"LoadingUI");var TestProxy=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(ys.Proxy);__reflect(TestProxy.prototype,"TestProxy");var ys;!function(t){var e=function(t){function e(e,n){var o=t.call(this)||this;return o.bg=GG.newBitmap(e,o),o.bar=GG.newBitmap(n,o),o.rec=new egret.Rectangle(0,0,o.bar.width,o.bar.height),o}return __extends(e,t),Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},set:function(t){this._progress=t,this.bar&&(this.rec.width=t*this.bar.width,this.bar.scrollRect=this.rec)},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);t.ProgressBar=e,__reflect(e.prototype,"ys.ProgressBar")}(ys||(ys={}));var ys;!function(t){var e=function(t){function e(e,n,o){void 0===o&&(o=0);var r=t.call(this)||this;return r.holder="",r.type=egret.TextFieldType.INPUT,r.verticalAlign=egret.VerticalAlign.MIDDLE,r.width=e,r.height=n,o?r.size=o:r.size=Math.floor(.6*n),r.background=!0,r.textColor=0,r}return __extends(e,t),Object.defineProperty(e.prototype,"placeholder",{set:function(t){this.holder=t,this.onFocusOut(),this.addEventListener(egret.Event.FOCUS_IN,this.onFocus,this),this.addEventListener(egret.Event.FOCUS_OUT,this.onFocusOut,this)},enumerable:!0,configurable:!0}),e.prototype.onFocusOut=function(){""==this.text&&(this.text=this.holder,this.textColor=13421772)},e.prototype.onFocus=function(){this.textColor=0,this.text==this.holder&&(this.text="")},e}(egret.TextField);t.TextInput=e,__reflect(e.prototype,"ys.TextInput")}(ys||(ys={}));var ys;!function(t){var e=function(){function e(){}return e.showToast=function(t,e,n,o,i){if(void 0===o&&(o=""),void 0===i&&(i=1500),t=t.trim().replace(/\n/gi,""),""!=t){var a=new r({msg:t,icon:o});return a.x=e,a.y=n,a.show(i),a}},e.showModal=function(e,n,o,r){void 0===n&&(n="确定"),void 0===o&&(o="取消"),void 0===r&&(r=40);var i=new t.Modal({msg:e,confirm:n,cancel:o,fontSize:r});return i},e.showLoading=function(t,o){void 0===t&&(t="加载中"),void 0===o&&(o=!0),e.loading||(e.loading=new n);var r=e.loading;return r.show(t,o),stage.addChild(r),r},e.hideLoading=function(){e.loading&&e.loading.hide()},e}();t.Tips=e,__reflect(e.prototype,"ys.Tips");var n=function(t){function e(){var e=t.call(this)||this,n=GG.newRectBlock(0,e);n.alpha=.5,n.cacheAsBitmap=!0,e.block=n;var o=GG.newContainer();e.addChild(o);var r=200,i=200,a=GG.newRectRound(r,i,0,40,o);a.alpha=.7;var s=GG.newShape();s.graphics.clear(),o.addChild(s);for(var c,u,l,p=10,h=22,d=35;p--;)l=p*Math.PI*2/10+Math.PI,s.graphics.lineStyle(7,16777215,.1+(10-p)/10),c=Math.sin(l)*h,u=Math.cos(l)*h,s.graphics.moveTo(c,u),c=Math.sin(l)*d,u=Math.cos(l)*d,s.graphics.lineTo(c,u);s.x=.5*r,s.y=.5*i-20,s.cacheAsBitmap=!0,e.flower=s;var f=GG.newLabel(16777215,25,o);return f.width=r,f.textAlign="center",f.y=i-55,e.label=f,e.ctn=o,e.show("加载中"),e}return __extends(e,t),e.prototype.show=function(t,e){void 0===e&&(e=!0);var n=this.ctn;GG.layoutCenter(n);var o=this.block;o.alpha=.5,this.resize(),this.label.text=t;var r=this.flower;r.rotation=0,r.r=0;var i=1e3;e||(i=2e3),egret.Tween.removeTweens(r),egret.Tween.get(r,{loop:!0,onChange:function(){var t=r.r;e?r.rotation=36*Math.floor(t/36):r.rotation=t}}).to({r:360},i),stage.addEventListener(egret.Event.RESIZE,this.resize,this)},e.prototype.resize=function(){var t=this.block;t.scaleX=stageW/t.width,t.scaleY=stageH/t.height},e.prototype.hide=function(){stage.removeEventListener(egret.Event.RESIZE,this.resize,this),egret.Tween.removeTweens(this.flower),GG.removeDisplayObject(this)},e}(egret.DisplayObjectContainer);t.Loading=n,__reflect(n.prototype,"ys.Loading");var o=function(e){function n(n){var o=n.msg,r=n.confirm,i=void 0===r?"":r,a=n.cancel,s=void 0===a?"":a,c=n.fontSize,u=void 0===c?50:c,l=n.txtWidth,p=void 0===l?500:l,h=e.call(this)||this,d=h,f=t.View.newLabel();f.size=u,f.text=o,f.lineSpacing=.5*u,f.textColor=0,f.width=p;var y=66,v=2*y+p,g=120,m=f.textHeight+2*y+g;f.x=f.y=y,h.content=f;var x=t.View.newRectRound(v,m,16777215,40,40);if(d.addChild(x),x.graphics.lineStyle(1,0,.6),x.graphics.moveTo(0,m-g),x.graphics.lineTo(v,m-g),""!=i&&""!=s&&(x.graphics.moveTo(.5*v,m-g),x.graphics.lineTo(.5*v,m)),x.cacheAsBitmap=!0,""!=s){var _=h.newBtnLabel(s,.5*v,g,u);_.addEventListener(egret.TouchEvent.TOUCH_TAP,h.onClick,h),_.y=m-g,d.addChild(_),h.cancel=_,""==i&&(_.width=v)}if(""!=i){var w=h.newBtnLabel(i,.5*v,g,u);w.addEventListener(egret.TouchEvent.TOUCH_TAP,h.onClick,h),w.y=m-g,w.x=.5*v,d.addChild(w),h.confirm=w,""==s&&(w.x=0,w.width=v)}return d.addChild(f),h}return __extends(n,e),Object.defineProperty(n.prototype,"selectLabel",{get:function(){return this._select},enumerable:!0,configurable:!0}),n.prototype.onClick=function(t){this._select=t.target.text,console.log(this._select),this.dispatchEventWith("select",!1),GG.removeDisplayObject(this)},n.prototype.newBtnLabel=function(e,n,o,r){var i=t.View.newLabel();return i.text=e,i.width=n,i.height=o,i.size=r,i.textAlign="center",i.textColor=0,i.verticalAlign="middle",i.touchEnabled=!0,i.cacheAsBitmap=!0,i},n}(egret.DisplayObjectContainer);t.Modal=o,__reflect(o.prototype,"ys.Modal");var r=function(t){function e(e){var n=e.msg,o=e.color,r=void 0===o?16777215:o,i=e.bgColor,a=void 0===i?0:i,s=e.icon,c=void 0===s?"":s,u=e.bgAlpha,l=void 0===u?.8:u,p=e.padding,h=void 0===p?30:p,d=t.call(this)||this,f=2*h,y=new egret.TextField;d.addChild(y),y.text=n,y.size=35,y.textColor=r,y.textWidth>stageW-h?y.width=stageW-h:y.width=y.textWidth,y.width<1&&(y.width=f),y.height=y.textHeight,y.textAlign="center",y.verticalAlign=egret.VerticalAlign.MIDDLE;var v=0;if(""!=c){var g=GG.newBitmap(c,d);GG.setAnchor(g,.5,0),g.width>y.width&&(y.width=g.width),g.x=.5*y.width+h,g.y=h,v=g.height+h}var m=GG.newRectRound(y.width+f,y.height+f+v,a,h);return m.alpha=l,d.addChildAt(m,0),d.anchorOffsetX=.5*d.width,y.x=h,y.y=h+v,d.cacheAsBitmap=!0,d}return __extends(e,t),e.prototype.show=function(t){var e=this;void 0===t&&(t=1500),this.alpha=0,egret.Tween.get(this).to({alpha:1},300).wait(t).to({alpha:0},300).call(function(){GG.removeDisplayObject(e)})},e}(egret.DisplayObjectContainer);t.Toast=r,__reflect(r.prototype,"ys.Toast")}(ys||(ys={}));var TestVO=function(){function t(){}return t}();__reflect(TestVO.prototype,"TestVO");var ys;!function(t){var e=function(){function t(){}return t.prototype.edit=function(t,e){var n=this;void 0===e&&(e=""),t.touchEnabled=!0;var o,r;stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){o=t.stageX,r=t.stageY},this),stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(n){var i=n.stageX-o,a=n.stageY-r;"x"==e&&(a=0),"y"==e&&(i=0),t.x+=i,t.y+=a,o=n.stageX,r=n.stageY},this),stage.addEventListener(egret.TouchEvent.TOUCH_END,function(){n.showLayout(t)},this);var i="\n			attribute vec2 aVertexPosition;\n			attribute vec2 aTextureCoord;\n			attribute vec2 aColor;\n			uniform vec2 projectionVector;\n			varying vec2 vTextureCoord;\n			const vec2 center = vec2(-1.0, 1.0);\n			void main(void) {\n				gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n				vTextureCoord = aTextureCoord;\n			}\n			",a="\n			precision lowp float;\n			varying vec2 vTextureCoord;\n			varying vec4 vColor;\n			uniform sampler2D uSampler;\n			void main(void) {\n				vec2 uvs = vTextureCoord.xy;\n				vec4 fg = texture2D(uSampler, vTextureCoord);\n				fg += vec4(1.0,0.0,0.0,0.5);\n				gl_FragColor = fg;\n			}\n			",s=new egret.CustomFilter(i,a,{});t.filters=[s]},t.prototype.showLayout=function(t){if(t){console.log("--- layout值 ---");var e=void 0;e=t.x-t.anchorOffsetX,console.log("left",e),e=stageW-t.width+t.anchorOffsetX-t.x,console.log("right",e),e=t.y-t.anchorOffsetY,console.log("top",e),console.log("top vh",e/stageH),e=stageH-t.height+t.anchorOffsetY-t.y,console.log("bottom",e),e=stageHalfW-.5*t.width+t.anchorOffsetX-t.x,e=-e,console.log("middleX",e),e=stageHalfH-.5*t.height+t.anchorOffsetY-t.y,e=-e,console.log("middleY",e)}},t.prototype.left=function(t,e){t.x=e+t.anchorOffsetX},t.prototype.right=function(t,e){t.x=stageW-t.width+t.anchorOffsetX-e},t.prototype.middleX=function(t,e){void 0===e&&(e=0),t.x=stageHalfW-.5*t.width+t.anchorOffsetX+e},t.prototype.middleY=function(t,e){void 0===e&&(e=0),t.y=stageHalfH-.5*t.height+t.anchorOffsetY+e},t.prototype.top=function(t,e){t.y=e+t.anchorOffsetY},t.prototype.bottom=function(t,e){t.y=stageH-t.height+t.anchorOffsetY-e},t.prototype.vh=function(t,e){t.y=stageH*e},t}();t.Layout=e,__reflect(e.prototype,"ys.Layout")}(ys||(ys={}));var ys;!function(t){var e=function(){function t(){}return t.popUp=function(e,n,o,r){void 0===n&&(n=.7),void 0===o&&(o=!0),void 0===r&&(r=300),t.popLayer||(t.popLayer=new egret.DisplayObjectContainer),t.popblock||(t.popblock=GG.newRectBlock(0),t.popblock.alpha=n,t.popblock.cacheAsBitmap=!0);var i=t.popblock;i.scaleX=stageW/i.width,i.scaleY=stageH/i.height;var a=t.popLayer;stage.addChild(a),a.addChild(i),a.addChild(e),i.alpha=n,0==n&&(o=!1),2==a.numChildren&&o&&(egret.Tween.removeTweens(i),i.alpha=0,egret.Tween.get(i).to({alpha:n},r)),e.once(egret.Event.REMOVED_FROM_STAGE,function(){2==a.numChildren?o?egret.Tween.get(i).to({alpha:0},r).call(function(){GG.removeDisplayObject(a)}):GG.removeDisplayObject(a):a.addChildAt(i,a.numChildren-3)},this)},t}();t.PopLayer=e,__reflect(e.prototype,"ys.PopLayer")}(ys||(ys={}));var cfg=new Config;cfg.groups=["preload"],cfg.resourceJSON="resource/default.res.json",cfg.resourceRoot="resource/",cfg.release=!1,cfg.scaleMode=egret.Capabilities.isMobile?egret.StageScaleMode.FIXED_WIDTH:egret.StageScaleMode.SHOW_ALL,cfg.orientation=egret.OrientationMode.PORTRAIT,cfg.width=750,cfg.height=1334,cfg.proxy=[],cfg.command=[TestCMD],cfg.mock=!1,cfg.versionFun=function(t){return console.log("加载",t),t},ys.Label.getLocale=function(t){var e=t;return e};var MyLoadingReporter=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onReady=function(){this.view=new LoadingUI,stage.addChild(this.view)},e.prototype.onStart=function(t){console.log(t,"start")},e.prototype.onProgress=function(t,e,n){this.view.onProgress(t,e)},e.prototype.onLoaded=function(t){this.view.onLoaded(t),"preload"==t&&(GG.removeDisplayObject(this.view),GG.showPage(app.TestView,null))},e}(ys.LoadingReporter);__reflect(MyLoadingReporter.prototype,"MyLoadingReporter");var Main=function(t){function e(){return t.call(this,cfg,new MyLoadingReporter)||this}return __extends(e,t),e}(Application);__reflect(Main.prototype,"Main");var ys;!function(t){var e=function(){function t(){}return t}();t.Notice=e,__reflect(e.prototype,"ys.Notice")}(ys||(ys={}));var app;!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.uiCreate=function(){this.con_game=GG.newContainer(),this.addChild(this.con_game),this.con_ui=GG.newContainer(),this.addChild(this.con_ui),this.cha=GG.newBitmap("cha_png"),this.addChild(this.cha)},e.prototype.uiLayout=function(){var t=this.cha;GG.layoutMiddleX(t),GG.layoutMiddleY(t)},e}(ys.View);__reflect(e.prototype,"$PlayView");var n=function(e){function n(){var n=e.call(this,t.PlayViewMediator)||this;return n.name="PlayView",console.log("创建页面",n.name),n}return __extends(n,e),n.prototype.uiCreate=function(){e.prototype.uiCreate.call(this)},n.prototype.uiLayout=function(){e.prototype.uiLayout.call(this)},n}(e);t.PlayView=n,__reflect(n.prototype,"app.PlayView")}(app||(app={}));var app;!function(t){var e=function(e){function n(t){var n=e.call(this,t)||this;return n.name="PlayViewMediator",n}return __extends(n,e),n.prototype.addLogic=function(){var e=this.getView();e.cha.touchEnabled=!0,e.cha.once(egret.TouchEvent.TOUCH_TAP,function(){GG.showPage(t.TestView)},this)},n.prototype.listenNotice=function(){return[]},n.prototype.onNotice=function(t){this.getView()},n}(ys.Mediator);t.PlayViewMediator=e,__reflect(e.prototype,"app.PlayViewMediator")}(app||(app={}));var app;!function(t){var e=function(e){function n(){var n=e.call(this,t.TestViewMediator)||this;return n.name="TestView",console.log("创建页面",n.name),n}return __extends(n,e),n.prototype.uiCreate=function(){e.prototype.uiCreate.call(this),GG.newRect(stageW,stageH,16777215,this);var t=new ys3d.Scene(stageW,stageH);this.addChild(t.display),this.scene=t;for(var n=new ys3d.Camera(55,stageW/stageH,1,1e4),o=(GG.newRect(200,200,16711680*Math.random()),6),r=[];o--;){var i=GG.newLabel(16711680,60);i.text="文字",i.verticalAlign=egret.VerticalAlign.MIDDLE,i.textAlign="center",i.width=200,i.height=200,i.background=!0;var a=(GG.newRect(200,200,16711680*Math.random()),GG.newBitmap("headimg_jpg"));a.width=200,a.height=200,r.push(a)}for(var s=0;s--;){var c=new ys3d.SpriteNode(RES.getRes("cha_jpg"));c.name="sprite";var u=Math.random()*Math.PI*2;c.position.z=-2e3,c.position.y=-100,t.addChild(c)}for(var l=function(e,n,o,r){if(void 0===r&&(r=!0),r)var i=new ys3d.PlaneNode(GG.newBitmap("tree2_png"));else var i=new ys3d.SpriteNode(RES.getRes("tree_png"),.5,1);return i.position.y=n,i.position.x=e,i.position.z=o,t.addChild(i),i},p=50;p--;){var u=Math.random()*Math.PI*2,h=GG.randomInt(100,1e3);l(Math.cos(u)*h,-346.5,-2e3-400*p,!1)}n.lookAt(0,0,-1);var d=new ys3d.Render;d.render(t,n);var f=GG.newCircle(10,16711680,this);f.x=stageHalfW,f.y=stageHalfH,this.addEventListener(egret.Event.ENTER_FRAME,function(){n.position.z-=30,t.children.forEach(function(t){t.position.z>n.position.z&&(t.position.z-=n.far)}),d.render(t,n)},this)},n.prototype.uiLayout=function(){e.prototype.uiLayout.call(this),this.scene.display.x=stageHalfW,this.scene.display.y=stageHalfH,console.log("resize?",stageW,stageH)},n}(ys.View);t.TestView=e,__reflect(e.prototype,"app.TestView")}(app||(app={}));var app;!function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return n.name="TestViewMediator",n}return __extends(e,t),e.prototype.addLogic=function(){this.getView()},e.prototype.listenNotice=function(){return[]},e.prototype.onNotice=function(t){this.getView()},e}(ys.Mediator);t.TestViewMediator=e,__reflect(e.prototype,"app.TestViewMediator")}(app||(app={}));var ys;!function(t){var e=function(){function t(){}return t.prototype.onChange=function(t,e,n){},t}();t.ViewChangeHandler=e,__reflect(e.prototype,"ys.ViewChangeHandler")}(ys||(ys={}));var ys;!function(t){var e=function(){function t(){}return t.prototype.xhr=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var t,e=["MSXML2.XmlHttp.6.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],n=0;n<e.length;n++)try{t=new window.ActiveXObject(e[n]);break}catch(o){}return t},t.prototype.send=function(t,e,n,o,r){void 0===r&&(r=!0);var i=this.xhr();i.open(n,t,r),i.onreadystatechange=function(){4==i.readyState&&e(i.status,i.responseText)},"POST"==n&&i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(o)},t.prototype.post=function(e,n,o,r){if(void 0===r&&(r=!0),t.mock)return void o(null);var i=[];for(var a in n)i.push(encodeURIComponent(a)+"="+encodeURIComponent(n[a]));this.send(e,o,"POST",i.join("&"),r)},t.prototype.get=function(e,n,o,r){if(void 0===r&&(r=!0),t.mock)return void o(null);var i=[];for(var a in n)i.push(encodeURIComponent(a)+"="+encodeURIComponent(n[a]));this.send(e+(i.length?"?"+i.join("&"):""),o,"GET",null,r)},t}();t.Ajax=e,__reflect(e.prototype,"ys.Ajax")}(ys||(ys={}));var ys;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.respath="",e}return __extends(e,t),e.prototype.setRespath=function(t){this.respath=t},e.prototype.setup=function(t,e,n){return void 0===n&&(n="default.res.json"),__awaiter(this,void 0,void 0,function(){return __generator(this,function(o){switch(o.label){case 0:return console.log("loader setup",n),[4,RES.loadConfig(n,this.respath)];case 1:return o.sent(),t.call(e),[2]}})})},e.prototype.loadGroup=function(t,e){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),RES.isGroupLoaded(t)?(e.onLoaded(t),[3,3]):[3,1];case 1:return e.onStart(t),[4,RES.loadGroup(t,9999,e)];case 2:o.sent(),e.onLoaded(t),o.label=3;case 3:return[3,5];case 4:return n=o.sent(),console.warn(n),[3,5];case 5:return[2]}})})},e.prototype.loadGroupByStep=function(t,e,n){return __awaiter(this,void 0,void 0,function(){var o,r;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),(o=RES.isGroupLoaded(t))?(e.call(n),[3,3]):[3,1];case 1:return[4,RES.loadGroup(t)];case 2:i.sent(),e.call(n),i.label=3;case 3:return[3,5];case 4:return r=i.sent(),e.call(n),[3,5];case 5:return[2]}})})},e}(egret.EventDispatcher);t.Loader=e,__reflect(e.prototype,"ys.Loader")}(ys||(ys={}));var ys;!function(t){var e=function(){function t(t){this.fun=t}return t.prototype.init=function(){return Promise.resolve()},t.prototype.getVirtualUrl=function(t){var e=t+"";return this.fun&&(e=this.fun(e)),e},t}();t.VersionController=e,__reflect(e.prototype,"ys.VersionController",["RES.IVersionController"])}(ys||(ys={}));var ys3d;!function(t){var e=t.Vector3.create(),n=function(n){function o(e,o,r,i){void 0===r&&(r=.1),void 0===i&&(i=2e3);var a=n.call(this)||this;return a.type="Camera",a._fov=e,a._aspect=o,a._near=r,a._far=i,a.name="camera",a._projectionMatrix=t.Matrix4.create(),a._updateProjectMatrix(),a._viewMatrix=t.Matrix4.create(),a.up=t.Vector3.create(0,1,0),a.lookAt(0,0,-1),a}return __extends(o,n),Object.defineProperty(o.prototype,"fov",{get:function(){return this._fov},set:function(t){this._fov=t,this._updateProjectMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"far",{get:function(){return this._far},enumerable:!0,configurable:!0}),o.prototype.updateMatrixWorld=function(){n.prototype.updateMatrixWorld.call(this),this._viewMatrix.copy(this.worldMatrix),this._viewMatrix.inverse()},o.prototype._updateProjectMatrix=function(){this._projectionMatrix.fromPerspective(this._fov,this._aspect,this._near,this._far)},Object.defineProperty(o.prototype,"projectionMatrix",{get:function(){return this._projectionMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"viewMatrix",{get:function(){return this._viewMatrix},enumerable:!0,configurable:!0}),o.prototype.lookAt=function(e,n,o){var r=this.position,i=this.up;this.viewMatrix.lookAt(r,t.Vector3.create(e,n,o),i),this.viewMatrix.getRotation(this.quat),this.rotation.fromQuaternion(this.quat)},o.prototype.project=function(t){return e=this._viewMatrix.transformV3(t),e=this._projectionMatrix.transformV3(e)},o.prototype.unproject=function(n,o){var r=t.Matrix4.create();return r.copy(this._projectionMatrix),r.inverse(),e.set(n,o,0),e=r.transformV3(e),e=this.worldMatrix.transformV3(e)},o}(t.Object3D);t.Camera=n,__reflect(n.prototype,"ys3d.Camera")}(ys3d||(ys3d={}));var Road=function(t){function e(){var e=t.call(this)||this;GG.newBitmap("road_jpg");return e}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(Road.prototype,"Road");var ScrollTile=function(t){function e(e,n,o){void 0===n&&(n=3),void 0===o&&(o="height");var r=t.call(this)||this;r.texture=e;var i,a,s=stageW/stageH;"height"==o?(a=1/n,i=1/n/s,r._maxSize=stageH):(a=1/n*s,i=1/n,r._maxSize=stageW);var c="\n		attribute vec2 aVertexPosition; //适配屏幕后的xy坐标,不用这个\n		attribute vec2 aTextureCoord;\n		attribute vec4 aColor;\n		uniform vec2 projectionVector;\n		varying vec2 vTextureCoord;\n		varying vec4 vColor;\n		const vec2 center = vec2(-1.0, 1.0);\n		void main(void) {\n			vTextureCoord = aTextureCoord;\n			vColor = aColor;\n			gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n		}\n		",u="\n		precision lowp float;\n		varying vec2 vTextureCoord;\n		uniform sampler2D uSampler;\n\n		uniform float dx;\n		uniform float dy;\n\n		void main(void) {\n			float uvx = vTextureCoord.x + dx;\n			float uvy = vTextureCoord.y + dy;\n\n			uvx = fract(uvx/"+i+");\n			uvy = fract(uvy/"+a+");\n\n			if(uvx > 1.0)\n			{\n				uvx -= 1.0;\n			}else if(uvx < 0.0)\n			{\n				uvx += 1.0;\n			}\n\n			if(uvy > 1.0)\n			{\n				uvy -= 1.0;\n			}else if(uvx < 0.0)\n			{\n				uvy += 1.0;\n			}\n\n			vec2 vCoord = vec2(uvx,uvy);\n\n			vec4 fg = texture2D(uSampler, vCoord);\n			gl_FragColor = fg;\n		}\n		",l=new egret.CustomFilter(c,u,{dx:0,dy:0});return r._shader=l,r.filters=[l],r.dx=0,r.dy=0,r}return __extends(e,t),e.prototype.scroll=function(t,e){this.dx+=t,this.dx%=this._maxSize,this.dy+=e,this.dy%=this._maxSize,this._shader.uniforms.dx=this.dx/this.width,this._shader.uniforms.dy=this.dy/this.height},e}(egret.Bitmap);__reflect(ScrollTile.prototype,"ScrollTile");var ys3d;!function(t){var e=function(t){function e(e,n){var o=t.call(this)||this;o.type="Scene",o.$display=new egret.DisplayObjectContainer;var r=o.$display;return r.x=.5*e,r.y=.5*n,o.visible=!0,o.name="scene",o}return __extends(e,t),Object.defineProperty(e.prototype,"display",{get:function(){return this.$display},enumerable:!0,configurable:!0}),e}(t.Object3D);t.Scene=e,__reflect(e.prototype,"ys3d.Scene")}(ys3d||(ys3d={}));var ys3d;!function(t){var e=function(e){function n(n,o,r){function i(e,n,o,r,i,a,s,c,u,y,v){var g,m,x=a/u,_=s/y,w=a/2,b=s/2,C=c/2,M=u+1,T=y+1,E=0,O=0,L=t.Vector3.create();for(m=0;T>m;m++){var S=m*_-b;for(g=0;M>g;g++){var P=g*x-w;L[e]=P*r,L[n]=S*i,L[o]=C,p.push(L.x,L.y,L.z),L[e]=0,L[n]=0,L[o]=c>0?1:-1,h.push(g/u),h.push(1-m/y),E+=1}}for(m=0;y>m;m++)for(g=0;u>g;g++){var V=d+g+M*m,G=d+g+M*(m+1),R=d+(g+1)+M*(m+1),j=d+(g+1)+M*m;l.push(V,G,j),l.push(G,R,j),O+=6}f+=O,d+=E}var a=e.call(this)||this;n=n||1,o=o||1,r=r||1;var s=1,c=1,u=1,l=[],p=[],h=[],d=0,f=0;return i("z","y","x",-1,-1,r,o,n,u,c,0),i("z","y","x",1,-1,r,o,-n,u,c,1),i("x","z","y",1,1,n,r,o,s,u,2),i("x","z","y",1,-1,n,r,-o,s,u,3),i("x","y","z",1,-1,n,o,r,s,c,4),i("x","y","z",-1,-1,n,o,-r,s,c,5),a._indices=l,a._vertices=p,a._uvs=h,a}return __extends(n,e),n}(t.Geometry);t.Box=e,__reflect(e.prototype,"ys3d.Box")}(ys3d||(ys3d={}));var WaterShader=function(t){function e(){var e=this,n="\n		attribute vec2 aVertexPosition;\n		attribute vec2 aTextureCoord;\n		attribute vec2 aColor;\n		uniform vec2 projectionVector;\n		varying vec2 vTextureCoord;\n		const vec2 center = vec2(-1.0, 1.0);\n		void main(void) {\n			gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n			vTextureCoord = aTextureCoord;\n		}\n		",o="\n		precision mediump float;\n		uniform sampler2D uSampler;\n		varying vec2 vTextureCoord;\n		uniform vec3 uTime;\n\n		vec3 mod289(vec3 x) {   \n			return x - floor(x * (1.0 / 289.0)) * 289.0;\n		}\n		\n		vec4 mod289(vec4 x) {   \n			return x - floor(x * (1.0 / 289.0)) * 289.0;\n		}\n		\n		vec4 permute(vec4 x) {   \n			return mod289(((x*34.0)+1.0)*x);\n		}\n		\n		vec4 taylorInvSqrt(vec4 r) {   \n			return 1.79284291400159 - 0.85373472095314 * r;\n		}\n		\n		float snoise(vec3 v) {   \n			const vec2  C = vec2(1.0/6.0, 1.0/3.0);\n			const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n			vec3 i  = floor(v + dot(v, C.yyy) );\n			vec3 x0 =   v - i + dot(i, C.xxx);\n			vec3 g = step(x0.yzx, x0.xyz);\n			vec3 l = 1.0 - g;\n			vec3 i1 = min( g.xyz, l.zxy );\n			vec3 i2 = max( g.xyz, l.zxy );\n			vec3 x1 = x0 - i1 + C.xxx;\n			vec3 x2 = x0 - i2 + C.yyy;\n			vec3 x3 = x0 - D.yyy;\n			i = mod289(i);\n			vec4 p = permute( permute( permute(   i.z + vec4(0.0, i1.z, i2.z, 1.0 ))   + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n			float n_ = 0.142857142857;\n			vec3  ns = n_ * D.wyz - D.xzx;\n			vec4 j = p - 49.0 * floor(p * ns.z * ns.z);\n			vec4 x_ = floor(j * ns.z);\n			vec4 y_ = floor(j - 7.0 * x_ );\n			vec4 x = x_ *ns.x + ns.yyyy;\n			vec4 y = y_ *ns.x + ns.yyyy;\n			vec4 h = 1.0 - abs(x) - abs(y);\n			vec4 b0 = vec4( x.xy, y.xy );\n			vec4 b1 = vec4( x.zw, y.zw );\n			vec4 s0 = floor(b0)*2.0 + 1.0;\n			vec4 s1 = floor(b1)*2.0 + 1.0;\n			vec4 sh = -step(h, vec4(0.0));\n			vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n			vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n			vec3 p0 = vec3(a0.xy,h.x);\n			vec3 p1 = vec3(a0.zw,h.y);\n			vec3 p2 = vec3(a1.xy,h.z);\n			vec3 p3 = vec3(a1.zw,h.w);\n			vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n			p0 *= norm.x;\n			p1 *= norm.y;\n			p2 *= norm.z;\n			p3 *= norm.w;\n			vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n			m = m * m;\n			return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );\n		}\n		\n		vec3 hsv2rgb(vec3 c){   \n			vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n			vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n			return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n		}\n		void main(){  \n			vec3 hsv = vec3(0.0, 0.5, 0.5);\n			vec2 uv = vTextureCoord;\n			vec3 v3 = vec3(uv.x,uv.y,2.0 * (fract(uTime.z/50.0) - 0.5) );\n			float noise = snoise(vec3(v3 * 6.0 + uTime.z * 1.0));\n			vec3 custom_color = hsv2rgb(vec3(hsv.x - noise / 2.0, hsv.y, hsv.z - noise / 2.0));\n			// vec4 color = texture2D(uSampler,  uTime.z * 0.05 + 1.0 * (uv * 0.9 + 0.1 * custom_color.rb));\n\n			vec4 color = texture2D(uSampler,  uv*0.999 + 0.01*vec2(noise*uv.x,noise*noise));\n\n			vec4 color2 = texture2D(uSampler, uTime.z * 0.05 + uv * 0.1 * custom_color.bg);\n			// color.rgb += color2.rgb*0.5;//color.rgb * 1.1 * color2.rbg * 1.1;\n\n			// color += color2*0.1;\n			\n			// color.rgb += custom_color*.1;\n			gl_FragColor = color;\n		}\n		";return e=t.call(this,n,o,{uTime:{x:0,y:.3,z:.4}})||this}return __extends(e,t),e}(egret.CustomFilter);__reflect(WaterShader.prototype,"WaterShader");var ys3d;!function(t){var e=function(t){function e(e,n,o,r){void 0===e&&(e=100),void 0===n&&(n=100),void 0===o&&(o=1),void 0===r&&(r=1);var i=t.call(this)||this;e=e||1,n=n||1;var a,s,c=e/2,u=n/2,l=Math.floor(o)||1,p=Math.floor(r)||1,h=l+1,d=p+1,f=e/l,y=n/p,v=[],g=[],m=[];for(s=0;d>s;s++){var x=s*y-u;for(a=0;h>a;a++){var _=a*f-c;g.push(_,-x,0),m.push(a/l),m.push(1-s/p)}}for(s=0;p>s;s++)for(a=0;l>a;a++){var w=a+h*s,b=a+h*(s+1),C=a+1+h*(s+1),M=a+1+h*s;v.push(w,b,M),v.push(b,C,M)}return i._vertices=g,i._indices=v,i._uvs=m,i}return __extends(e,t),e}(t.Geometry);t.Plane=e,__reflect(e.prototype,"ys3d.Plane")}(ys3d||(ys3d={}));var ys3d;!function(t){t.EPSILON=1e-6;var e=function(){function t(){}return t.hypot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0,o=arguments.length;o--;)n+=arguments[o]*arguments[o];return Math.sqrt(n)},t}();t.math=e,__reflect(e.prototype,"ys3d.math")}(ys3d||(ys3d={}));var ys3d;!function(t){var e=t.Matrix4.create(),n=function(n){function o(){var t=n.call(this)||this;return t.onChange=function(){},Object.setPrototypeOf(t,o.prototype),t[0]=0,t[1]=0,t[2]=0,t}return __extends(o,n),Object.defineProperty(o.prototype,"x",{get:function(){return this[0]},set:function(t){this[0]=t,this.onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"y",{get:function(){return this[1]},set:function(t){this[1]=t,this.onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"z",{get:function(){return this[2]},set:function(t){this[2]=t,this.onChange()},enumerable:!0,configurable:!0}),o.prototype.set=function(t,e,n){this[0]=t,this[1]=t,this[2]=t,this.onChange()},o.prototype.fromQuaternion=function(n){t.Matrix4.fromQuaternion(e,n),o.fromRotationMatrix(this,e),this.onChange()},o.create=function(){var t=new o;return t},o.fromRotationMatrix=function(t,e,n){return void 0===n&&(n="YXZ"),"XYZ"===n?(t[1]=Math.asin(Math.min(Math.max(e[8],-1),1)),Math.abs(e[8])<.99999?(t[0]=Math.atan2(-e[9],e[10]),t[2]=Math.atan2(-e[4],e[0])):(t[0]=Math.atan2(e[6],e[5]),t[2]=0)):"YXZ"===n?(t[0]=Math.asin(-Math.min(Math.max(e[9],-1),1)),Math.abs(e[9])<.99999?(t[1]=Math.atan2(e[8],e[10]),t[2]=Math.atan2(e[1],e[5])):(t[1]=Math.atan2(-e[2],e[0]),t[2]=0)):"ZXY"===n?(t[0]=Math.asin(Math.min(Math.max(e[6],-1),1)),Math.abs(e[6])<.99999?(t[1]=Math.atan2(-e[2],e[10]),t[2]=Math.atan2(-e[4],e[5])):(t[1]=0,t[2]=Math.atan2(e[1],e[0]))):"ZYX"===n?(t[1]=Math.asin(-Math.min(Math.max(e[2],-1),1)),Math.abs(e[2])<.99999?(t[0]=Math.atan2(e[6],e[10]),t[2]=Math.atan2(e[1],e[0])):(t[0]=0,t[2]=Math.atan2(-e[4],e[5]))):"YZX"===n?(t[2]=Math.asin(Math.min(Math.max(e[1],-1),1)),Math.abs(e[1])<.99999?(t[0]=Math.atan2(-e[9],e[5]),t[1]=Math.atan2(-e[2],e[0])):(t[0]=0,t[1]=Math.atan2(e[8],e[10]))):"XZY"===n&&(t[2]=Math.asin(-Math.min(Math.max(e[4],-1),1)),Math.abs(e[4])<.99999?(t[0]=Math.atan2(e[6],e[5]),t[1]=Math.atan2(e[8],e[0])):(t[0]=Math.atan2(-e[9],e[10]),t[1]=0)),t},o}(Array);t.Euler=n,__reflect(n.prototype,"ys3d.Euler")}(ys3d||(ys3d={}));var Hero=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(Hero.prototype,"Hero");var ys3d;!function(t){var e=function(t){function e(){var n=t.call(this)||this;return n.onChange=function(){},Object.setPrototypeOf(n,e.prototype),n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}return __extends(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this[0]
},set:function(t){this[0]=t,this.onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this[1]},set:function(t){this[1]=t,this.onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this[2]},set:function(t){this[2]=t,this.onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this[3]},set:function(t){this[3]=t,this.onChange()},enumerable:!0,configurable:!0}),e.prototype.fromEuler=function(t){e.fromEuler(this,t)},e.create=function(){var t=new e;return t},e.identity=function(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1},e.setAxisAngle=function(t,e,n){n=.5*n;var o=Math.sin(n);t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=Math.cos(n)},e.slerp=function(t,e,n,o){var r,i,a,s,c,u=e[0],l=e[1],p=e[2],h=e[3],d=n[0],f=n[1],y=n[2],v=n[3];i=u*d+l*f+p*y+h*v,0>i&&(i=-i,d=-d,f=-f,y=-y,v=-v),1-i>1e-6?(r=Math.acos(i),a=Math.sin(r),s=Math.sin((1-o)*r)/a,c=Math.sin(o*r)/a):(s=1-o,c=o),t[0]=s*u+c*d,t[1]=s*l+c*f,t[2]=s*p+c*y,t[3]=s*h+c*v},e.fromMat4=function(t,e){var n,o=e[0]+e[4]+e[8];if(o>0)n=Math.sqrt(o+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var i=(r+1)%3,a=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*i+i]-e[3*a+a]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*i+a]-e[3*a+i])*n,t[i]=(e[3*i+r]+e[3*r+i])*n,t[a]=(e[3*a+r]+e[3*r+a])*n}},e.fromEuler=function(t,e,n){void 0===n&&(n="YXZ");var o=Math.sin(.5*e[0]),r=Math.cos(.5*e[0]),i=Math.sin(.5*e[1]),a=Math.cos(.5*e[1]),s=Math.sin(.5*e[2]),c=Math.cos(.5*e[2]);"XYZ"===n?(t[0]=o*a*c+r*i*s,t[1]=r*i*c-o*a*s,t[2]=r*a*s+o*i*c,t[3]=r*a*c-o*i*s):"YXZ"===n?(t[0]=o*a*c+r*i*s,t[1]=r*i*c-o*a*s,t[2]=r*a*s-o*i*c,t[3]=r*a*c+o*i*s):"ZXY"===n?(t[0]=o*a*c-r*i*s,t[1]=r*i*c+o*a*s,t[2]=r*a*s+o*i*c,t[3]=r*a*c-o*i*s):"ZYX"===n?(t[0]=o*a*c-r*i*s,t[1]=r*i*c+o*a*s,t[2]=r*a*s-o*i*c,t[3]=r*a*c+o*i*s):"YZX"===n?(t[0]=o*a*c+r*i*s,t[1]=r*i*c+o*a*s,t[2]=r*a*s-o*i*c,t[3]=r*a*c-o*i*s):"XZY"===n&&(t[0]=o*a*c-r*i*s,t[1]=r*i*c-o*a*s,t[2]=r*a*s+o*i*c,t[3]=r*a*c+o*i*s)},e}(Array);t.Quaternion=e,__reflect(e.prototype,"ys3d.Quaternion")}(ys3d||(ys3d={}));var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var Bitmap3D=function(t){function e(){var e=t.call(this)||this,n="\n		attribute vec2 aVertexPosition;\n		attribute vec2 aTextureCoord;\n		attribute vec4 aColor;\n		uniform vec2 projectionVector;\n\n		varying vec2 vTextureCoord;\n		varying vec4 vColor;\n\n		const vec2 center = vec2(-1.0, 1.0);\n\n		uniform vec4 uVertexPosition1;//plane的顶点\n		uniform vec4 uVertexPosition2;//plane的顶点\n		uniform vec4 uVertexPosition3;//plane的顶点\n		uniform vec4 uVertexPosition4;//plane的顶点\n\n		uniform mat4 uMatrix;\n\n		void main(void) {\n\n			vTextureCoord = aTextureCoord;\n\n			vec4 positon;\n\n			if(aTextureCoord.x > 0.5)\n			{\n				if(aTextureCoord.y < 0.5)\n				{\n					positon = uVertexPosition2;\n				}else\n				{\n					positon = uVertexPosition3;\n				}\n			}else\n			{\n				if(aTextureCoord.y < 0.5)\n				{\n					positon = uVertexPosition1;\n				}else\n				{\n					positon = uVertexPosition4;\n				}\n			}\n			vColor = aColor;\n			gl_Position = positon;\n			// gl_Position = vec4( (positon.xy / projectionVector) + center , 0.0, 1.0);\n			\n		}\n		",o="\n		precision lowp float;\n		varying vec2 vTextureCoord;\n		uniform sampler2D uSampler;\n\n		void main(void) {\n			vec4 fg = texture2D(uSampler, vTextureCoord);\n			gl_FragColor = fg;\n		}\n		",r=new egret.CustomFilter(n,o,{uVertexPosition1:{x:-.5,y:0,z:.3,w:1.3},uVertexPosition2:{x:.5,y:0,z:.3,w:1.3},uVertexPosition3:{x:.2,y:.2,z:0,w:1},uVertexPosition4:{x:-.2,y:.2,z:0,w:1}});return e.filters=[r],e.shader=r,e}return __extends(e,t),e}(egret.Bitmap);__reflect(Bitmap3D.prototype,"Bitmap3D");var ys3d;!function(t){var e=function(){function t(){}return t.prototype.render=function(t,e){t.display.removeChildren(),t.updateMatrixWorld(),e.updateMatrixWorld();var n=[];t.traverse(function(t){return t.visible?void(t.draw&&n.push(t)):!0}),n.forEach(function(t){var n=t.worldPosition;n.x=0,n.y=0,n.z=0,n.w=1,n=t.worldMatrix.transformV4(n),n=e.viewMatrix.transformV4(n),t.worldPosition=n}),n.sort(function(t,e){var n=t.worldPosition.z,o=e.worldPosition.z,r=t.worldPosition.getLength(),i=e.worldPosition.getLength(),a=r-i;return Math.abs(a)<1e-4?n==o?t.id-e.id:void 0:-a}),n.forEach(function(n,o){n.worldPosition;n.draw(t,e)})},t}();t.Render=e,__reflect(e.prototype,"ys3d.Render")}(ys3d||(ys3d={}));var ys3d;!function(t){var e=function(e){function n(n){var o=e.call(this)||this;if(o._size=0,o.faces=[],n.length){for(var r=n[0],i=r.width,a=0,s=6;s>a;){var c=n[a];if(c){var u=new t.PlaneNode(c);o.addChild(u),o.faces.push(u)}else o.faces.push(null);a++}o.size=i}return o}return __extends(n,e),Object.defineProperty(n.prototype,"size",{get:function(){return this._size},set:function(t){var e=this;this._size=t,this.faces.forEach(function(n,o){n&&e.updateFace(n,.5*t,o)})},enumerable:!0,configurable:!0}),n.prototype.updateFace=function(t,e,n){switch(n){case 0:t.position.set(0,0,e),t.name="前";break;case 1:t.position.set(0,0,-e),t.rotation.y=180,t.name="后";break;case 2:t.position.set(-e,0,0),t.rotation.y=-90,t.name="左";break;case 3:t.position.set(e,0,0),t.rotation.y=90,t.name="右";break;case 4:t.position.set(0,e,0),t.rotation.x=90,t.name="上";break;case 5:t.position.set(0,-e,0),t.rotation.x=-90,t.name="下"}return t},n}(t.Group);t.BoxNode=e,__reflect(e.prototype,"ys3d.BoxNode")}(ys3d||(ys3d={}));var ys3d;!function(t){var e=(t.Vector4.create(),function(e){function n(n){var o=e.call(this)||this;o.$display=n;var r=o.$display;return o._shader=new t.PlaneShader,r.filters?r.filters.push(o._shader.shader):r.filters=[o._shader.shader],o.$geometry=new t.Plane(n.width,n.height),o}return __extends(n,e),n.prototype.draw=function(e,n){e.display.addChild(this.$display);for(var o,r,i,a,s=(n.viewMatrix,n.projectionMatrix,this.$geometry.vertices),c=(devicePixelRatio*innerWidth/stageW,0),u=s.length,l=[];u>c;)o=s[c],r=s[c+1],i=s[c+2],a=t.Vector4.create(o,r,i,1),this.mvp(n,a),l.push(a),c+=3;this._shader.updateArr(l)},n}(t.RenderNode));t.PlaneNode=e,__reflect(e.prototype,"ys3d.PlaneNode")}(ys3d||(ys3d={}));var ys3d;!function(t){var e=function(e){function n(t,n,o){void 0===n&&(n=.5),void 0===o&&(o=.5);var r=e.call(this)||this;r.type="Sprite",r.$display=new egret.Bitmap(t);var i=r.$display;return i.anchorOffsetX=i.width*n,i.anchorOffsetY=i.height*o,r}return __extends(n,e),n.prototype.projectTo2D=function(e,n,o,r){var i=r/(r+o),a=r+o;return 0==a?(e=1e5,n=0,i=1):(e*=i,n*=i),t.Vector3.create(e,-n,i)},n.prototype.draw=function(e,n){var o=this.$display;e.display.addChild(o);var r=t.Vector4.create(0,0,0,1);this.mvp(n,r);var i=((r.w-1)/r.z,r.w);r.x/=i,r.y/=i,r.x=r.x*stageHalfW,r.y=-r.y*stageHalfH,o.x=r.x,o.y=r.y;var a=stageH/r.w;o.scaleX=a*this.scale.x,o.scaleY=a*this.scale.y},n}(t.RenderNode);t.SpriteNode=e,__reflect(e.prototype,"ys3d.SpriteNode")}(ys3d||(ys3d={}));var GG;!function(t){function e(e,n){main=e,stage=main.stage,egret.ImageLoader.crossOrigin="anonymous",egret.Capabilities.isMobile||(stage.orientation="auto"),stage.orientation=n.orientation,stage.scaleMode=n.scaleMode,stage.setContentSize(n.width,n.height),egret.Capabilities.isMobile||(document.documentElement.style.overflow="hidden"),RES.setMaxLoadingThread(4),RES.setMaxRetryTimes(1),stageW=stage.stageWidth,stageH=stage.stageHeight,stageHalfW=stageW>>1,stageHalfH=stageH>>1,stage.frameRate=n.fps;var o=document.querySelector(".egret-player");if(o&&(egretCanvas=o.getElementsByTagName("canvas")[0]),"Android"==egret.Capabilities.os){var r=document.documentElement.clientWidth,i=document.documentElement.clientHeight;document.body.style.width=r+"px",document.body.style.height=i+"px"}"Android"==egret.Capabilities.os?(window.addEventListener("resize",function(){if("INPUT"==document.activeElement.tagName||"TEXTAREA"==document.activeElement.tagName){if("Android"==egret.Capabilities.os){var t=document.documentElement.clientWidth,e=document.documentElement.clientHeight;document.body.style.width=t+"px",document.body.style.height=e+"px"}window.setTimeout(function(){document.activeElement.scrollIntoViewIfNeeded(!0)},0)}}),document.body.addEventListener("blur",function(){window.scrollTo(0,0)},!0)):"iOS"==egret.Capabilities.os&&(document.body.addEventListener("focus",function(){document.activeElement;document.body.scrollTop=innerHeight/4},!0),document.body.addEventListener("blur",function(){document.body.scrollTop=0,window.scrollTo(0,0)},!0)),t.Loader=new ys.Loader,t.layout=new ys.Layout;var a=["t","s","i","l","e","t","i","s"];a.reverse();var s=window[a.join("")]||[];s.push("loNXN1bi5jb20=","cxOTIuMTY4","kxMjcuMC4wLjE=");var c=!1,u=location.href;return s&&s.forEach(function(t){var e="AA"+t,n=egret.Base64Util.decode(e),o=new egret.ByteArray(n),r=o.readUTF();-1!=u.indexOf(r)&&(c=!0)}),c=!0}function n(e,n,o){function r(){j&&console.log("删除页面",j.name),t.removeDisplayObject(j),j=a,console.log("显示页面",j.name)}void 0===n&&(n=!1),null==R&&(R={});var i=egret.getQualifiedClassName(e),a=R[i];a||(a=new e,n&&(R[i]=a)),main.addChild(a),o&&j?o.onChange(a,j,r):r()}function o(e,n){t.layout.left(e,n)}function r(e,n){t.layout.right(e,n)}function i(e,n){t.layout.top(e,n)}function a(e,n){t.layout.bottom(e,n)}function s(e,n){void 0===n&&(n=0),t.layout.middleX(e,n)}function c(e,n){void 0===n&&(n=0),t.layout.middleY(e,n)}function u(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),s(t,e),c(t,n)}function l(e){t.layout.edit(e)}function p(t,e,n){void 0===n&&(n=null);var o=ys.View.newCircle(t,e);return n&&n.addChild(o),o}function h(t,e){void 0===t&&(t=""),void 0===e&&(e=null);var n=ys.View.newBitmap(t);return n.name=t,e&&e.addChild(n),n}function d(t){void 0===t&&(t=null);var e=ys.View.newContainer();return t&&t.addChild(e),e}function f(t){void 0===t&&(t=null);var e=ys.View.newShape();return t&&t.addChild(e),e}function y(t,e,n,o){void 0===o&&(o=null);var r=ys.View.newRect(t,e,n);return o&&o.addChild(r),r}function v(t,e,n,o,r){void 0===r&&(r=null);var i=ys.View.newRectRound(t,e,n,o,o);return r&&r.addChild(i),i}function g(t,e){void 0===e&&(e=null);var n=y(stageW,stageH,t,e);return n.touchEnabled=!0,e&&e.addChild(n),n}function m(t,e,n){void 0===t&&(t=0),void 0===e&&(e=10),void 0===n&&(n=null);var o=ys.View.newLabel();return o.textColor=t,o.size=e,n&&n.addChild(o),o}function x(t,e){var n=ys.View.newButton(t);return e&&e.addChild(n),n}function _(t,e,n){var o=ys.View.newButtonMusic(t,e);return n&&n.addChild(o),o}function w(t){var e=ys.View.newImage();return t&&t.addChild(e),e}function b(t,e,n){var o=ys.View.newTextInput(t,e);return n&&n.addChild(o),o}function C(t,e,n,o){if(void 0===e&&(e=.5),void 0===n&&(n=.5),void 0===o&&(o=!1),t&&t.width&&t.height){var r=t.anchorOffsetX,i=t.anchorOffsetY;t.anchorOffsetX=t.width*e,t.anchorOffsetY=t.height*n,t.parent&&o&&(t.x+=t.anchorOffsetX-r,t.y+=t.anchorOffsetY-i)}}function M(t){t&&t.parent&&t.parent.removeChild(t)}function T(t,e){if(t>e){var n=e;e=t,t=n}return t+Math.random()*(e-t)}function E(t,e){var n=T(t,e);return parseInt(n+"")}function O(t){return t[Math.random()*t.length|0]}function L(e,n,o,r){void 0===n&&(n=.6*stageH),void 0===o&&(o=""),void 0===r&&(r=!1);var i=ys.Tips.showToast(e,stageHalfW,n,o);r?t.popUp(i):stage.addChild(i)}function S(e,n,o,r){void 0===n&&(n="确定"),void 0===o&&(o="取消"),void 0===r&&(r=40);var i=ys.Tips.showModal(e,n,o,r);return t.layoutCenter(i),t.popUp(i),i}function P(t,e){return void 0===t&&(t="加载中"),void 0===e&&(e=!0),ys.Tips.showLoading(t,e)}function V(){ys.Tips.hideLoading()}function G(t,e){void 0===e&&(e=.7),ys.PopLayer.popUp(t,e)}t.setup=e;var R,j;t.showPage=n,t.layoutLeft=o,t.layoutRight=r,t.layoutTop=i,t.layoutBottom=a,t.layoutMiddleX=s,t.layoutMiddleY=c,t.layoutCenter=u,t.layoutEdit=l,t.newCircle=p,t.newBitmap=h,t.newContainer=d,t.newShape=f,t.newRect=y,t.newRectRound=v,t.newRectBlock=g,t.newLabel=m,t.newButton=x,t.newButtonMusic=_,t.newImage=w,t.newTextInput=b,t.setAnchor=C,t.removeDisplayObject=M,t.randomNumber=T,t.randomInt=E,t.randomArr=O,t.showToast=L,t.showModal=S,t.showLoading=P,t.hideLoading=V,t.popUp=G}(GG||(GG={}));var stage,stageW,stageH,stageHalfW,stageHalfH,main,egretCanvas,ys3d;!function(t){var e=function(){function t(){var t="\n		attribute vec2 aVertexPosition;\n		attribute vec2 aTextureCoord;\n		attribute vec4 aColor;\n		varying vec2 vTextureCoord;\n		varying vec4 vColor;\n		uniform vec4 p1;\n		uniform vec4 p2;\n		uniform vec4 p3;\n		uniform vec4 p4;\n		void main(void) {\n			vec2 pos = aVertexPosition;\n			vTextureCoord = aTextureCoord;\n			vColor = aColor;\n			vec4 position;\n			if(vTextureCoord.x < 0.5)\n			vTextureCoord.y < 0.5 ? (position = p1):(position = p3);\n			else\n			vTextureCoord.y < 0.5 ?(position = p2):(position = p4);\n			gl_Position = position;\n		}\n		",e="\n		precision lowp float;\n		varying vec2 vTextureCoord;\n		uniform sampler2D uSampler;\n		uniform vec3 color; \n		varying vec4 vColor;\n\n		void main(void) {\n			vec4 fg = texture2D(uSampler, vTextureCoord);\n			gl_FragColor =fg;\n		}\n		",n=new egret.CustomFilter(t,e,{p1:{x:-.5,y:.5,z:0,w:1},p2:{x:.5,y:.5,z:0,w:1},p3:{x:-.5,y:-.5,z:0,w:1},p4:{x:.5,y:-.5,z:0,w:1}});this._shader=n}return Object.defineProperty(t.prototype,"shader",{get:function(){return this._shader},enumerable:!0,configurable:!0}),t.prototype.updateArr=function(t){var e=t[0],n=t[1],o=t[2],r=t[3];this.shader.uniforms.p1={x:e.x,y:e.y,z:e.z,w:e.w},this.shader.uniforms.p2={x:n.x,y:n.y,z:n.z,w:n.w},this.shader.uniforms.p3={x:o.x,y:o.y,z:o.z,w:o.w},this.shader.uniforms.p4={x:r.x,y:r.y,z:r.z,w:r.w}},t}();t.PlaneShader=e,__reflect(e.prototype,"ys3d.PlaneShader")}(ys3d||(ys3d={}));var ys3d;!function(t){var e=function(){function t(){var t="\n		attribute vec2 aVertexPosition;\n		attribute vec2 aTextureCoord;\n		attribute vec4 aColor;\n		varying vec2 vTextureCoord;\n		varying vec4 vColor;\n		uniform vec2 projectionVector;\n		const vec2 center = vec2(-1.0, 1.0);\n		uniform vec4 v4;\n	\n		void main(void) {\n			vec2 pos = aVertexPosition;\n			vTextureCoord = aTextureCoord;\n			vColor = aColor;\n			vec4 position = vec4( (aVertexPosition / projectionVector) + center , 0.0, v4.w);\n			position.x += v4.x;\n			position.y += v4.y;\n			gl_Position = position;\n		}\n		",e="\n		precision lowp float;\n		varying vec2 vTextureCoord;\n		uniform sampler2D uSampler;\n		uniform vec3 color; \n		varying vec4 vColor;\n\n		void main(void) {\n			vec4 fg = texture2D(uSampler, vTextureCoord);\n			gl_FragColor =fg;\n		}\n		",n=new egret.CustomFilter(t,e,{w:1});this._shader=n}return Object.defineProperty(t.prototype,"shader",{get:function(){return this._shader},enumerable:!0,configurable:!0}),t.prototype.update=function(t){this.shader.uniforms.v4={x:t.x,y:t.y,z:t.z,w:t.w}},t}();t.SpriteShader=e,__reflect(e.prototype,"ys3d.SpriteShader")}(ys3d||(ys3d={}));var ysui;!function(t){var e=function(t){function e(e,n){return t.call(this)||this}return __extends(e,t),e}(egret.Bitmap);t.ShaderRec=e,__reflect(e.prototype,"ysui.ShaderRec")}(ysui||(ysui={}));var WEB;!function(t){function e(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(e);return null!=n?decodeURI(n[2]):null}function n(t){if(-1!=t.indexOf(".")){var e=t.split("."),n=window[e[0]];return n?n[e[1]]:""}return window[t]}function o(t,e){void 0===e&&(e=!1),e?window.location.replace(t):window.location.href=t}function r(t){var e=navigator.userAgent.toLocaleLowerCase(),n=new RegExp(t,"i");return e.match(n)?!0:!1}function i(t,e){void 0===e&&(e=null);var n=document.createElement("script");n.async=!1,n.src=t,n.addEventListener("load",function(){e&&e()},!1),document.body.appendChild(n)}function a(t){void 0===t&&(t=null);var e=location.href;t&&(e=t),console.info(e),console.info("%c ","opacity:.6;display:block;padding:50px;background:url('http://tool.oschina.net/action/qrcode/generate?data="+encodeURIComponent(e)+"&output=image%2Fgif&error=L&type=0&margin=4&size=4') no-repeat;background-size:contain;")}function s(t){var e=new egret.ByteArray;return e.writeUTF(t),egret.Base64Util.encode(e.buffer)}function c(t){var e=egret.Base64Util.decode(t),n=new egret.ByteArray(e);return n.readUTF()}function u(){return location.protocol+"//"+location.host+location.pathname}t.getURLParams=e,t.getVar=n,t.navigateToURL=o,t.UA_WEIXIN="micromessenger",t.UA_WEIBO="weibo",t.UA_SUNING="snebuy-app",t.UA_JD="jdapp",t.UA_VIVO_BROWSER="vivobrowser",t.UA_ALIPAY="aplipay",t.checkUserAgent=r,t.addJStoIndex=i,t.showQrCode=a,t.encodeB64=s,t.decodeB64=c,t.Url=u}(WEB||(WEB={}));var WX=function(t){function e(){var e=t.call(this)||this;return e.key="my_openid",e}return __extends(e,t),Object.defineProperty(e,"GET",{get:function(){return e._instance?e._instance:e._instance=new e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openid",{get:function(){return egret.localStorage.getItem(this.key)},enumerable:!0,configurable:!0}),e.prototype.checkOauth=function(t,e,n){if(!WEB.getURLParams("error")){var o=egret.localStorage.getItem(this.key);if(o)e.call(n,o);else{var r=WEB.getURLParams(t);r?(egret.localStorage.setItem(this.key,r),window.location.replace("https://"+window.location.hostname+"/"+window.location.pathname)):e.call(n,null)}}},e.prototype.goOauth=function(t){var e="b";"snsapi_userinfo"==t&&(e="i");var n=window.location.pathname.split("/")[1];window.location.replace("https://a.h5sun.com/t/"+e+"/"+n)},e.prototype.getUser=function(t,e,n,o){var r=new ys.Ajax;r.post(t,{openid:e},n)},Object.defineProperty(e.prototype,"appMessageTitle",{set:function(t){this._appMessageTitle=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appMessageDesc",{set:function(t){this._appMessageDesc=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appMessageLink",{set:function(t){this._appMessageLink=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appMessageImgUrl",{set:function(t){this._appMessageImgUrl=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timelineTitle",{set:function(t){this._timelineTitle=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timelineLink",{set:function(t){this._timelineLink=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timelineImgUrl",{set:function(t){this._timelineImgUrl=t},enumerable:!0,configurable:!0}),e.prototype.setup=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=["updateAppMessageShareData","updateTimelineShareData","onMenuShareTimeline","onMenuShareAppMessage"]);var o=this,r=window.location.href,i=new ys.Ajax;i.post(t,{url:r},function(t,r){var i=JSON.parse(r);if(200==t&&0==i.code){var a=window.wx;if(a){a.ready(function(){o.wxReady=!0,o.updateSetting()});var s=i.data;a.config({debug:e,appId:s.appId,timestamp:s.timestamp,nonceStr:s.nonceStr,signature:s.signature,jsApiList:n})}}else console.log("签名接口失败",i)})},e.prototype.updateSetting=function(){if(this.wxReady){var t=window.wx;""==this._appMessageTitle&&(this._appMessageTitle=" "),""==this._timelineTitle&&(this._timelineTitle=" "),t.updateAppMessageShareData&&(t.updateAppMessageShareData({title:this._appMessageTitle,desc:this._appMessageDesc,link:this._appMessageLink,imgUrl:this._appMessageImgUrl,success:function(){}}),t.updateTimelineShareData({title:this._timelineTitle,link:this._timelineLink,imgUrl:this._timelineImgUrl,success:function(){}})),t.onMenuShareTimeline&&(t.onMenuShareTimeline({title:this._timelineTitle,link:this._timelineLink,imgUrl:this._timelineImgUrl,success:function(){console.log("朋友圈2")},cancel:function(){}}),t.onMenuShareAppMessage({title:this._appMessageTitle,desc:this._appMessageDesc,link:this._appMessageLink,imgUrl:this._appMessageImgUrl,type:"link",dataUrl:"",success:function(){console.log("朋友2")},cancel:function(){}}))}},e}(egret.EventDispatcher);__reflect(WX.prototype,"WX");